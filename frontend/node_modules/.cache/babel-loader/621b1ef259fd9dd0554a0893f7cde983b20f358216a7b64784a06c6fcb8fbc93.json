{"ast":null,"code":"var _s = $RefreshSig$();\n// src/pages/ProfileModal.js\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { api as axiosClient, mediaSrc as resolveUrl } from \"../lib/api\";\nimport \"./ProfileModal.css\";\nconst UPLOAD_ENDPOINT = \"/uploads/avatar\";\n\n/* === helper: แปลงกลับเป็น path สำหรับเก็บลง DB ถ้าเป็น absolute === */\nfunction toDbUrl(u) {\n  if (!u) return null;\n  const s = String(u);\n  try {\n    const url = new URL(s, window.location.origin);\n    if (url.origin === window.location.origin && url.pathname) {\n      return url.pathname;\n    }\n  } catch (e) {}\n  return s;\n}\nexport default function ProfileModal({\n  initialTab = \"profile\",\n  onClose\n}) {\n  _s();\n  const [tab, setTab] = useState(initialTab);\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [loadErr, setLoadErr] = useState(\"\");\n  const [toast, setToast] = useState({\n    show: false,\n    type: \"success\",\n    message: \"\"\n  });\n  const pushToast = (message, type = \"success\") => {\n    setToast({\n      show: true,\n      type,\n      message\n    });\n    window.clearTimeout(pushToast._t);\n    pushToast._t = window.setTimeout(() => setToast(t => ({\n      ...t,\n      show: false\n    })), 2500);\n  };\n  const [profile, setProfile] = useState({\n    id: \"\",\n    fullname: \"\",\n    email: \"\",\n    phone: \"\",\n    avatar_url: \"\"\n  });\n  const [prefs, setPrefs] = useState({\n    order_updates: true,\n    marketing_email: false\n  });\n  const [orders, setOrders] = useState([]);\n  const [ordersLoading, setOrdersLoading] = useState(false);\n  const [addrLoading, setAddrLoading] = useState(false);\n  const [addresses, setAddresses] = useState([]);\n  const [editing, setEditing] = useState(null);\n  const avatarFallback = useMemo(() => process.env.PUBLIC_URL + \"/profile.jpg\", []);\n  const closeModal = () => typeof onClose === \"function\" && onClose();\n\n  /* ------------ helpers address mapping ------------ */\n  const normAddress = (a = {}) => {\n    var _ref, _a$id, _ref2, _ref3, _ref4, _a$recipient_name, _ref5, _a$phone, _ref6, _ref7, _a$line, _ref8, _ref9, _a$line2, _ref0, _a$subdistrict, _ref1, _ref10, _a$district, _a$province, _ref11, _ref12, _a$postcode, _ref13, _a$is_default;\n    return {\n      id: (_ref = (_a$id = a.id) !== null && _a$id !== void 0 ? _a$id : a.address_id) !== null && _ref !== void 0 ? _ref : null,\n      fullname: (_ref2 = (_ref3 = (_ref4 = (_a$recipient_name = a.recipient_name) !== null && _a$recipient_name !== void 0 ? _a$recipient_name : a.fullname) !== null && _ref4 !== void 0 ? _ref4 : a.name) !== null && _ref3 !== void 0 ? _ref3 : profile.fullname) !== null && _ref2 !== void 0 ? _ref2 : \"\",\n      phone: (_ref5 = (_a$phone = a.phone) !== null && _a$phone !== void 0 ? _a$phone : a.phone_number) !== null && _ref5 !== void 0 ? _ref5 : \"\",\n      line1: (_ref6 = (_ref7 = (_a$line = a.line1) !== null && _a$line !== void 0 ? _a$line : a.address) !== null && _ref7 !== void 0 ? _ref7 : a.address_line1) !== null && _ref6 !== void 0 ? _ref6 : \"\",\n      line2: (_ref8 = (_ref9 = (_a$line2 = a.line2) !== null && _a$line2 !== void 0 ? _a$line2 : a.address2) !== null && _ref9 !== void 0 ? _ref9 : a.address_line2) !== null && _ref8 !== void 0 ? _ref8 : \"\",\n      subdistrict: (_ref0 = (_a$subdistrict = a.subdistrict) !== null && _a$subdistrict !== void 0 ? _a$subdistrict : a.tambon) !== null && _ref0 !== void 0 ? _ref0 : \"\",\n      district: (_ref1 = (_ref10 = (_a$district = a.district) !== null && _a$district !== void 0 ? _a$district : a.amphoe) !== null && _ref10 !== void 0 ? _ref10 : a.city) !== null && _ref1 !== void 0 ? _ref1 : \"\",\n      province: (_a$province = a.province) !== null && _a$province !== void 0 ? _a$province : \"\",\n      postcode: (_ref11 = (_ref12 = (_a$postcode = a.postcode) !== null && _a$postcode !== void 0 ? _a$postcode : a.postal_code) !== null && _ref12 !== void 0 ? _ref12 : a.zip) !== null && _ref11 !== void 0 ? _ref11 : \"\",\n      is_default: !!((_ref13 = (_a$is_default = a.is_default) !== null && _a$is_default !== void 0 ? _a$is_default : a.default) !== null && _ref13 !== void 0 ? _ref13 : false)\n    };\n  };\n  const denormAddress = (a = {}) => {\n    var _a$fullname, _a$phone2, _a$line3, _a$line4, _a$subdistrict2, _a$district2, _a$province2, _ref14, _a$postcode2;\n    return {\n      recipient_name: (_a$fullname = a.fullname) !== null && _a$fullname !== void 0 ? _a$fullname : \"\",\n      phone: (_a$phone2 = a.phone) !== null && _a$phone2 !== void 0 ? _a$phone2 : \"\",\n      line1: (_a$line3 = a.line1) !== null && _a$line3 !== void 0 ? _a$line3 : \"\",\n      line2: (_a$line4 = a.line2) !== null && _a$line4 !== void 0 ? _a$line4 : \"\",\n      subdistrict: (_a$subdistrict2 = a.subdistrict) !== null && _a$subdistrict2 !== void 0 ? _a$subdistrict2 : \"\",\n      district: (_a$district2 = a.district) !== null && _a$district2 !== void 0 ? _a$district2 : \"\",\n      province: (_a$province2 = a.province) !== null && _a$province2 !== void 0 ? _a$province2 : \"\",\n      postal_code: (_ref14 = (_a$postcode2 = a.postcode) !== null && _a$postcode2 !== void 0 ? _a$postcode2 : a.postal_code) !== null && _ref14 !== void 0 ? _ref14 : \"\",\n      is_default: !!a.is_default\n    };\n  };\n\n  /* ------------ โหลดโปรไฟล์ ------------ */\n  useEffect(() => {\n    let ignore = false;\n    (async () => {\n      try {\n        var _u$settings$order_upd, _u$settings, _u$settings$marketing, _u$settings2;\n        setLoading(true);\n        setLoadErr(\"\");\n        const r = await axiosClient.get(\"/api/me\"); // ✅ เปลี่ยนจาก /me\n        if (ignore) return;\n        const u = r.data || {};\n        const next = {\n          id: u.id || \"\",\n          fullname: u.fullname || \"\",\n          email: u.email || \"\",\n          phone: u.phone || \"\",\n          avatar_url: resolveUrl(u.avatar_url) || \"\"\n        };\n        setProfile({\n          ...next,\n          avatar_url: next.avatar_url || avatarFallback\n        });\n        setPrefs({\n          order_updates: (_u$settings$order_upd = u === null || u === void 0 ? void 0 : (_u$settings = u.settings) === null || _u$settings === void 0 ? void 0 : _u$settings.order_updates) !== null && _u$settings$order_upd !== void 0 ? _u$settings$order_upd : true,\n          marketing_email: (_u$settings$marketing = u === null || u === void 0 ? void 0 : (_u$settings2 = u.settings) === null || _u$settings2 === void 0 ? void 0 : _u$settings2.marketing_email) !== null && _u$settings$marketing !== void 0 ? _u$settings$marketing : false\n        });\n        if (next.fullname) localStorage.setItem(\"fullname\", next.fullname);\n        if (next.email) localStorage.setItem(\"email\", next.email);\n        if (next.phone) localStorage.setItem(\"phone\", next.phone);\n        if (u.avatar_url) localStorage.setItem(\"avatar_url\", resolveUrl(u.avatar_url));\n        window.dispatchEvent(new Event(\"profile:changed\"));\n      } catch (e) {\n        var _e$response, _e$response$data;\n        console.error(\"GET /api/me failed:\", e);\n        setLoadErr((e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.message) || (e === null || e === void 0 ? void 0 : e.message) || \"โหลดข้อมูลผู้ใช้ล้มเหลว\");\n      } finally {\n        setLoading(false);\n      }\n    })();\n    return () => {\n      ignore = true;\n    };\n  }, [axiosClient, avatarFallback]);\n\n  /* ------------ คำสั่งซื้อ ------------ */\n  useEffect(() => {\n    if (tab !== \"orders\") return;\n    let ignore = false;\n    (async () => {\n      try {\n        var _r$data;\n        setOrdersLoading(true);\n        const r = await axiosClient.get(\"/api/orders/my\", {\n          params: {\n            limit: 5\n          }\n        }); // ✅\n        if (!ignore) setOrders(Array.isArray(r.data) ? r.data : ((_r$data = r.data) === null || _r$data === void 0 ? void 0 : _r$data.items) || []);\n      } catch (e) {\n        console.error(\"GET /api/orders/my failed:\", e);\n      } finally {\n        setOrdersLoading(false);\n      }\n    })();\n    return () => {\n      ignore = true;\n    };\n  }, [tab, axiosClient]);\n\n  /* ------------ โหลดที่อยู่ ------------ */\n  useEffect(() => {\n    if (tab !== \"addresses\") return;\n    let off = false;\n    (async () => {\n      try {\n        var _r$data2;\n        setAddrLoading(true);\n        const r = await axiosClient.get(\"/api/user-addresses\"); // ✅ เปลี่ยนจาก /addresses\n        const list = Array.isArray(r.data) ? r.data : ((_r$data2 = r.data) === null || _r$data2 === void 0 ? void 0 : _r$data2.items) || [];\n        if (!off) setAddresses(list.map(normAddress));\n      } catch (e) {\n        console.error(\"GET /api/user-addresses failed:\", e);\n        if (!off) setAddresses([]);\n      } finally {\n        if (!off) setAddrLoading(false);\n      }\n    })();\n    return () => {\n      off = true;\n    };\n  }, [tab]);\n  const onChangeProfile = (k, v) => setProfile(s => ({\n    ...s,\n    [k]: v\n  }));\n  const onChangePref = (k, v) => setPrefs(s => ({\n    ...s,\n    [k]: v\n  }));\n\n  /* ------------ บันทึกโปรไฟล์ ------------ */\n  const saveProfile = async () => {\n    try {\n      var _profile$fullname, _profile$phone;\n      setSaving(true);\n      const payload = {\n        fullname: (_profile$fullname = profile.fullname) !== null && _profile$fullname !== void 0 ? _profile$fullname : \"\",\n        phone: (_profile$phone = profile.phone) !== null && _profile$phone !== void 0 ? _profile$phone : \"\",\n        avatar_url: profile.avatar_url && profile.avatar_url !== avatarFallback ? toDbUrl(profile.avatar_url) : null\n      };\n      const r = await axiosClient.put(\"/api/me\", payload); // ✅\n      const u = r.data || {};\n      const next = {\n        fullname: u.fullname || profile.fullname,\n        email: u.email || profile.email,\n        phone: u.phone || profile.phone,\n        avatar_url: resolveUrl(u.avatar_url) || profile.avatar_url\n      };\n      setProfile(s => ({\n        ...s,\n        ...next,\n        avatar_url: next.avatar_url || avatarFallback\n      }));\n      pushToast(\"บันทึกโปรไฟล์เรียบร้อย ✅\", \"success\");\n    } catch (e) {\n      var _e$response2, _e$response2$data;\n      console.error(\"PUT /api/me failed:\", e);\n      pushToast((e === null || e === void 0 ? void 0 : (_e$response2 = e.response) === null || _e$response2 === void 0 ? void 0 : (_e$response2$data = _e$response2.data) === null || _e$response2$data === void 0 ? void 0 : _e$response2$data.message) || e.message || \"บันทึกโปรไฟล์ล้มเหลว\", \"error\");\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  /* ------------ CRUD ที่อยู่ ------------ */\n  async function reloadAddresses() {\n    var _r$data3;\n    const r = await axiosClient.get(\"/api/user-addresses\"); // ✅\n    const list = Array.isArray(r.data) ? r.data : ((_r$data3 = r.data) === null || _r$data3 === void 0 ? void 0 : _r$data3.items) || [];\n    setAddresses(list.map(normAddress));\n  }\n  async function saveAddress() {\n    try {\n      setSaving(true);\n      const payload = denormAddress(editing);\n      if (editing.id) await axiosClient.put(`/api/addresses/${editing.id}`, payload);else await axiosClient.post(`/api/addresses`, payload);\n      await reloadAddresses();\n      setEditing(null);\n      pushToast(\"บันทึกที่อยู่เรียบร้อย ✅\", \"success\");\n    } catch (e) {\n      var _e$response3, _e$response3$data;\n      console.error(\"save address failed:\", e);\n      pushToast((e === null || e === void 0 ? void 0 : (_e$response3 = e.response) === null || _e$response3 === void 0 ? void 0 : (_e$response3$data = _e$response3.data) === null || _e$response3$data === void 0 ? void 0 : _e$response3$data.message) || e.message || \"บันทึกที่อยู่ล้มเหลว\", \"error\");\n    } finally {\n      setSaving(false);\n    }\n  }\n  async function removeAddress(id) {\n    try {\n      setSaving(true);\n      await axiosClient.delete(`/api/addresses/${id}`); // ✅\n    } catch (e) {\n      var _e$response4, _e$response4$data;\n      console.error(\"delete address failed:\", e);\n      pushToast((e === null || e === void 0 ? void 0 : (_e$response4 = e.response) === null || _e$response4 === void 0 ? void 0 : (_e$response4$data = _e$response4.data) === null || _e$response4$data === void 0 ? void 0 : _e$response4$data.message) || e.message || \"ลบไม่สำเร็จ\", \"error\");\n    } finally {\n      await reloadAddresses();\n      setSaving(false);\n      pushToast(\"ลบที่อยู่แล้ว ✅\", \"success\");\n    }\n  }\n  async function makeDefault(id) {\n    try {\n      setSaving(true);\n      await axiosClient.patch(`/api/addresses/${id}/default`); // ✅\n      await reloadAddresses();\n      pushToast(\"ตั้งค่าเริ่มต้นแล้ว ✅\", \"success\");\n    } catch (e) {\n      var _e$response5, _e$response5$data;\n      console.error(\"default address failed:\", e);\n      pushToast((e === null || e === void 0 ? void 0 : (_e$response5 = e.response) === null || _e$response5 === void 0 ? void 0 : (_e$response5$data = _e$response5.data) === null || _e$response5$data === void 0 ? void 0 : _e$response5$data.message) || e.message || \"ตั้งค่าเริ่มต้นไม่สำเร็จ\", \"error\");\n    } finally {\n      setSaving(false);\n    }\n  }\n\n  /* ------------ ออกจากระบบ ------------ */\n  const logout = () => {\n    localStorage.clear();\n    delete axiosClient.defaults.headers.common[\"Authorization\"];\n    closeModal();\n    window.location.href = \"/login\";\n  };\n\n  // ... (UI เดิมทั้งหมดไม่เปลี่ยน)\n}\n_s(ProfileModal, \"bdEnkxw6WB8Y9VlNM/ETBzSyVII=\");\n_c = ProfileModal;\nvar _c;\n$RefreshReg$(_c, \"ProfileModal\");","map":{"version":3,"names":["React","useEffect","useMemo","useState","Link","api","axiosClient","mediaSrc","resolveUrl","UPLOAD_ENDPOINT","toDbUrl","u","s","String","url","URL","window","location","origin","pathname","e","ProfileModal","initialTab","onClose","_s","tab","setTab","loading","setLoading","saving","setSaving","loadErr","setLoadErr","toast","setToast","show","type","message","pushToast","clearTimeout","_t","setTimeout","t","profile","setProfile","id","fullname","email","phone","avatar_url","prefs","setPrefs","order_updates","marketing_email","orders","setOrders","ordersLoading","setOrdersLoading","addrLoading","setAddrLoading","addresses","setAddresses","editing","setEditing","avatarFallback","process","env","PUBLIC_URL","closeModal","normAddress","a","_ref","_a$id","_ref2","_ref3","_ref4","_a$recipient_name","_ref5","_a$phone","_ref6","_ref7","_a$line","_ref8","_ref9","_a$line2","_ref0","_a$subdistrict","_ref1","_ref10","_a$district","_a$province","_ref11","_ref12","_a$postcode","_ref13","_a$is_default","address_id","recipient_name","name","phone_number","line1","address","address_line1","line2","address2","address_line2","subdistrict","tambon","district","amphoe","city","province","postcode","postal_code","zip","is_default","default","denormAddress","_a$fullname","_a$phone2","_a$line3","_a$line4","_a$subdistrict2","_a$district2","_a$province2","_ref14","_a$postcode2","ignore","_u$settings$order_upd","_u$settings","_u$settings$marketing","_u$settings2","r","get","data","next","settings","localStorage","setItem","dispatchEvent","Event","_e$response","_e$response$data","console","error","response","_r$data","params","limit","Array","isArray","items","off","_r$data2","list","map","onChangeProfile","k","v","onChangePref","saveProfile","_profile$fullname","_profile$phone","payload","put","_e$response2","_e$response2$data","reloadAddresses","_r$data3","saveAddress","post","_e$response3","_e$response3$data","removeAddress","delete","_e$response4","_e$response4$data","makeDefault","patch","_e$response5","_e$response5$data","logout","clear","defaults","headers","common","href","_c","$RefreshReg$"],"sources":["D:/project19/frontend/src/pages/ProfileModal.js"],"sourcesContent":["// src/pages/ProfileModal.js\r\nimport React, { useEffect, useMemo, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { api as axiosClient, mediaSrc as resolveUrl } from \"../lib/api\";\r\nimport \"./ProfileModal.css\";\r\n\r\nconst UPLOAD_ENDPOINT = \"/uploads/avatar\";\r\n\r\n/* === helper: แปลงกลับเป็น path สำหรับเก็บลง DB ถ้าเป็น absolute === */\r\nfunction toDbUrl(u) {\r\n  if (!u) return null;\r\n  const s = String(u);\r\n  try {\r\n    const url = new URL(s, window.location.origin);\r\n    if (url.origin === window.location.origin && url.pathname) {\r\n      return url.pathname;\r\n    }\r\n  } catch (e) {}\r\n  return s;\r\n}\r\n\r\nexport default function ProfileModal({ initialTab = \"profile\", onClose }) {\r\n  const [tab, setTab] = useState(initialTab);\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  const [loadErr, setLoadErr] = useState(\"\");\r\n  const [toast, setToast] = useState({ show: false, type: \"success\", message: \"\" });\r\n\r\n  const pushToast = (message, type = \"success\") => {\r\n    setToast({ show: true, type, message });\r\n    window.clearTimeout(pushToast._t);\r\n    pushToast._t = window.setTimeout(() => setToast((t) => ({ ...t, show: false })), 2500);\r\n  };\r\n\r\n  const [profile, setProfile] = useState({\r\n    id: \"\",\r\n    fullname: \"\",\r\n    email: \"\",\r\n    phone: \"\",\r\n    avatar_url: \"\",\r\n  });\r\n  const [prefs, setPrefs] = useState({ order_updates: true, marketing_email: false });\r\n  const [orders, setOrders] = useState([]);\r\n  const [ordersLoading, setOrdersLoading] = useState(false);\r\n  const [addrLoading, setAddrLoading] = useState(false);\r\n  const [addresses, setAddresses] = useState([]);\r\n  const [editing, setEditing] = useState(null);\r\n\r\n  const avatarFallback = useMemo(() => process.env.PUBLIC_URL + \"/profile.jpg\", []);\r\n  const closeModal = () => typeof onClose === \"function\" && onClose();\r\n\r\n  /* ------------ helpers address mapping ------------ */\r\n  const normAddress = (a = {}) => ({\r\n    id: a.id ?? a.address_id ?? null,\r\n    fullname: a.recipient_name ?? a.fullname ?? a.name ?? profile.fullname ?? \"\",\r\n    phone: a.phone ?? a.phone_number ?? \"\",\r\n    line1: a.line1 ?? a.address ?? a.address_line1 ?? \"\",\r\n    line2: a.line2 ?? a.address2 ?? a.address_line2 ?? \"\",\r\n    subdistrict: a.subdistrict ?? a.tambon ?? \"\",\r\n    district: a.district ?? a.amphoe ?? a.city ?? \"\",\r\n    province: a.province ?? \"\",\r\n    postcode: a.postcode ?? a.postal_code ?? a.zip ?? \"\",\r\n    is_default: !!(a.is_default ?? a.default ?? false),\r\n  });\r\n  const denormAddress = (a = {}) => ({\r\n    recipient_name: a.fullname ?? \"\",\r\n    phone: a.phone ?? \"\",\r\n    line1: a.line1 ?? \"\",\r\n    line2: a.line2 ?? \"\",\r\n    subdistrict: a.subdistrict ?? \"\",\r\n    district: a.district ?? \"\",\r\n    province: a.province ?? \"\",\r\n    postal_code: a.postcode ?? a.postal_code ?? \"\",\r\n    is_default: !!a.is_default,\r\n  });\r\n\r\n  /* ------------ โหลดโปรไฟล์ ------------ */\r\n  useEffect(() => {\r\n    let ignore = false;\r\n    (async () => {\r\n      try {\r\n        setLoading(true);\r\n        setLoadErr(\"\");\r\n        const r = await axiosClient.get(\"/api/me\"); // ✅ เปลี่ยนจาก /me\r\n        if (ignore) return;\r\n        const u = r.data || {};\r\n        const next = {\r\n          id: u.id || \"\",\r\n          fullname: u.fullname || \"\",\r\n          email: u.email || \"\",\r\n          phone: u.phone || \"\",\r\n          avatar_url: resolveUrl(u.avatar_url) || \"\",\r\n        };\r\n        setProfile({ ...next, avatar_url: next.avatar_url || avatarFallback });\r\n        setPrefs({\r\n          order_updates: u?.settings?.order_updates ?? true,\r\n          marketing_email: u?.settings?.marketing_email ?? false,\r\n        });\r\n        if (next.fullname) localStorage.setItem(\"fullname\", next.fullname);\r\n        if (next.email) localStorage.setItem(\"email\", next.email);\r\n        if (next.phone) localStorage.setItem(\"phone\", next.phone);\r\n        if (u.avatar_url) localStorage.setItem(\"avatar_url\", resolveUrl(u.avatar_url));\r\n        window.dispatchEvent(new Event(\"profile:changed\"));\r\n      } catch (e) {\r\n        console.error(\"GET /api/me failed:\", e);\r\n        setLoadErr(e?.response?.data?.message || e?.message || \"โหลดข้อมูลผู้ใช้ล้มเหลว\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    })();\r\n    return () => { ignore = true; };\r\n  }, [axiosClient, avatarFallback]);\r\n\r\n  /* ------------ คำสั่งซื้อ ------------ */\r\n  useEffect(() => {\r\n    if (tab !== \"orders\") return;\r\n    let ignore = false;\r\n    (async () => {\r\n      try {\r\n        setOrdersLoading(true);\r\n        const r = await axiosClient.get(\"/api/orders/my\", { params: { limit: 5 } }); // ✅\r\n        if (!ignore) setOrders(Array.isArray(r.data) ? r.data : r.data?.items || []);\r\n      } catch (e) {\r\n        console.error(\"GET /api/orders/my failed:\", e);\r\n      } finally {\r\n        setOrdersLoading(false);\r\n      }\r\n    })();\r\n    return () => { ignore = true; };\r\n  }, [tab, axiosClient]);\r\n\r\n  /* ------------ โหลดที่อยู่ ------------ */\r\n  useEffect(() => {\r\n    if (tab !== \"addresses\") return;\r\n    let off = false;\r\n    (async () => {\r\n      try {\r\n        setAddrLoading(true);\r\n        const r = await axiosClient.get(\"/api/user-addresses\"); // ✅ เปลี่ยนจาก /addresses\r\n        const list = Array.isArray(r.data) ? r.data : (r.data?.items || []);\r\n        if (!off) setAddresses(list.map(normAddress));\r\n      } catch (e) {\r\n        console.error(\"GET /api/user-addresses failed:\", e);\r\n        if (!off) setAddresses([]);\r\n      } finally {\r\n        if (!off) setAddrLoading(false);\r\n      }\r\n    })();\r\n    return () => { off = true; };\r\n  }, [tab]);\r\n\r\n  const onChangeProfile = (k, v) => setProfile((s) => ({ ...s, [k]: v }));\r\n  const onChangePref = (k, v) => setPrefs((s) => ({ ...s, [k]: v }));\r\n\r\n  /* ------------ บันทึกโปรไฟล์ ------------ */\r\n  const saveProfile = async () => {\r\n    try {\r\n      setSaving(true);\r\n      const payload = {\r\n        fullname: profile.fullname ?? \"\",\r\n        phone: profile.phone ?? \"\",\r\n        avatar_url:\r\n          profile.avatar_url && profile.avatar_url !== avatarFallback\r\n            ? toDbUrl(profile.avatar_url)\r\n            : null,\r\n      };\r\n      const r = await axiosClient.put(\"/api/me\", payload); // ✅\r\n      const u = r.data || {};\r\n      const next = {\r\n        fullname: u.fullname || profile.fullname,\r\n        email: u.email || profile.email,\r\n        phone: u.phone || profile.phone,\r\n        avatar_url: resolveUrl(u.avatar_url) || profile.avatar_url,\r\n      };\r\n      setProfile((s) => ({ ...s, ...next, avatar_url: next.avatar_url || avatarFallback }));\r\n      pushToast(\"บันทึกโปรไฟล์เรียบร้อย ✅\", \"success\");\r\n    } catch (e) {\r\n      console.error(\"PUT /api/me failed:\", e);\r\n      pushToast(e?.response?.data?.message || e.message || \"บันทึกโปรไฟล์ล้มเหลว\", \"error\");\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  /* ------------ CRUD ที่อยู่ ------------ */\r\n  async function reloadAddresses() {\r\n    const r = await axiosClient.get(\"/api/user-addresses\"); // ✅\r\n    const list = Array.isArray(r.data) ? r.data : (r.data?.items || []);\r\n    setAddresses(list.map(normAddress));\r\n  }\r\n  async function saveAddress() {\r\n    try {\r\n      setSaving(true);\r\n      const payload = denormAddress(editing);\r\n      if (editing.id) await axiosClient.put(`/api/addresses/${editing.id}`, payload);\r\n      else await axiosClient.post(`/api/addresses`, payload);\r\n      await reloadAddresses();\r\n      setEditing(null);\r\n      pushToast(\"บันทึกที่อยู่เรียบร้อย ✅\", \"success\");\r\n    } catch (e) {\r\n      console.error(\"save address failed:\", e);\r\n      pushToast(e?.response?.data?.message || e.message || \"บันทึกที่อยู่ล้มเหลว\", \"error\");\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  }\r\n  async function removeAddress(id) {\r\n    try {\r\n      setSaving(true);\r\n      await axiosClient.delete(`/api/addresses/${id}`); // ✅\r\n    } catch (e) {\r\n      console.error(\"delete address failed:\", e);\r\n      pushToast(e?.response?.data?.message || e.message || \"ลบไม่สำเร็จ\", \"error\");\r\n    } finally {\r\n      await reloadAddresses();\r\n      setSaving(false);\r\n      pushToast(\"ลบที่อยู่แล้ว ✅\", \"success\");\r\n    }\r\n  }\r\n  async function makeDefault(id) {\r\n    try {\r\n      setSaving(true);\r\n      await axiosClient.patch(`/api/addresses/${id}/default`); // ✅\r\n      await reloadAddresses();\r\n      pushToast(\"ตั้งค่าเริ่มต้นแล้ว ✅\", \"success\");\r\n    } catch (e) {\r\n      console.error(\"default address failed:\", e);\r\n      pushToast(e?.response?.data?.message || e.message || \"ตั้งค่าเริ่มต้นไม่สำเร็จ\", \"error\");\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  }\r\n\r\n  /* ------------ ออกจากระบบ ------------ */\r\n  const logout = () => {\r\n    localStorage.clear();\r\n    delete axiosClient.defaults.headers.common[\"Authorization\"];\r\n    closeModal();\r\n    window.location.href = \"/login\";\r\n  };\r\n\r\n  // ... (UI เดิมทั้งหมดไม่เปลี่ยน)\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}