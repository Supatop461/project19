{"ast":null,"code":"var _jsxFileName = \"D:\\\\project19\\\\frontend\\\\src\\\\auth\\\\Login.js\",\n  _s = $RefreshSig$();\n// src/auth/Login.js\n// หน้าที่: ฟอร์มล็อกอิน → POST /api/auth/login → เก็บ token + ตั้ง Authorization header → ไป /admin/orders\n\nimport React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Login() {\n  _s();\n  const nav = useNavigate();\n\n  // ใช้ URL เต็มกันพลาด (ถ้า index.js ยังไม่ได้ตั้ง baseURL ตอน dev)\n  const API = process.env.REACT_APP_API_BASE_URL || 'http://localhost:3001';\n\n  // -------------------- state ฟอร์มและสถานะ --------------------\n  // ค่าตัวอย่างเพื่อเทสเร็ว (โปรดลบ/เปลี่ยนในโปรดักชัน)\n  const [identifier, setIdentifier] = useState('suppachai1601@gmail.com'); // อีเมลหรือชื่อผู้ใช้\n  const [password, setPassword] = useState('password123');\n  const [loading, setLoading] = useState(false);\n  const [err, setErr] = useState('');\n\n  // -------------------- ส่งฟอร์มล็อกอิน --------------------\n  async function submit(e) {\n    e.preventDefault();\n    if (loading) return; // กันกดซ้ำ\n\n    setErr('');\n    setLoading(true);\n\n    // ตัดช่องว่างหัวท้าย\n    const id = identifier.trim();\n    const pw = password.trim();\n\n    // ถ้ามี @ ให้ถือว่าเป็นอีเมล ไม่งั้นเป็น username\n    const payload = id.includes('@') ? {\n      email: id,\n      password: pw\n    } : {\n      username: id,\n      password: pw\n    };\n    try {\n      // ยิงไป backend\n      const {\n        data\n      } = await axios.post(`${API}/api/auth/login`, payload);\n\n      // เก็บ token + ตั้ง header ให้ axios\n      localStorage.setItem('token', data.token);\n      axios.defaults.headers.common['Authorization'] = `Bearer ${data.token}`;\n\n      // (ถ้าส่ง user มาด้วยอยากจะเซฟก็ได้)\n      // localStorage.setItem('user', JSON.stringify(data.user));\n\n      // ไปหน้าคำสั่งซื้อ\n      nav('/admin/orders', {\n        replace: true\n      });\n    } catch (e) {\n      var _e$response, _e$config, _e$response2, _e$response2$data;\n      // แสดง error ที่ช่วยดีบักได้\n      const status = (_e$response = e.response) === null || _e$response === void 0 ? void 0 : _e$response.status;\n      const url = (_e$config = e.config) === null || _e$config === void 0 ? void 0 : _e$config.url;\n      const msg = status === 401 ? 'อีเมล/ชื่อผู้ใช้ หรือรหัสผ่านไม่ถูกต้อง' : e.code === 'ERR_NETWORK' ? 'เชื่อมต่อเซิร์ฟเวอร์ไม่ได้ (ตรวจสอบ backend ที่พอร์ต 3001)' : ((_e$response2 = e.response) === null || _e$response2 === void 0 ? void 0 : (_e$response2$data = _e$response2.data) === null || _e$response2$data === void 0 ? void 0 : _e$response2$data.error) || 'เกิดข้อผิดพลาดในการเข้าสู่ระบบ';\n      setErr(`${msg}${status ? ` [${status}]` : ''}${url ? ` @ ${url}` : ''}`);\n    } finally {\n      setLoading(false);\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      maxWidth: 360,\n      margin: '64px auto',\n      border: '1px solid #eee',\n      padding: 16,\n      borderRadius: 8\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\u0E40\\u0E02\\u0E49\\u0E32\\u0E2A\\u0E39\\u0E48\\u0E23\\u0E30\\u0E1A\\u0E1A\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: submit,\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"\\u0E2D\\u0E35\\u0E40\\u0E21\\u0E25\\u0E2B\\u0E23\\u0E37\\u0E2D\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E1C\\u0E39\\u0E49\\u0E43\\u0E0A\\u0E49\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        value: identifier,\n        onChange: e => setIdentifier(e.target.value),\n        required: true,\n        autoFocus: true,\n        autoComplete: \"username email\",\n        placeholder: \"\\u0E2D\\u0E35\\u0E40\\u0E21\\u0E25 \\u0E2B\\u0E23\\u0E37\\u0E2D\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E1C\\u0E39\\u0E49\\u0E43\\u0E0A\\u0E49\",\n        style: {\n          width: '100%',\n          padding: 8,\n          margin: '6px 0 12px'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"\\u0E23\\u0E2B\\u0E31\\u0E2A\\u0E1C\\u0E48\\u0E32\\u0E19\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"password\",\n        value: password,\n        onChange: e => setPassword(e.target.value),\n        required: true,\n        autoComplete: \"current-password\",\n        style: {\n          width: '100%',\n          padding: 8,\n          margin: '6px 0 12px'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this), err && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          color: 'crimson',\n          marginBottom: 12\n        },\n        children: err\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        disabled: loading,\n        style: {\n          width: '100%',\n          padding: 10\n        },\n        children: loading ? 'กำลังเข้าสู่ระบบ…' : 'เข้าสู่ระบบ'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 5\n  }, this);\n}\n_s(Login, \"Q0VLTzn19QHhNrc0HPe94Ji9oyk=\", false, function () {\n  return [useNavigate];\n});\n_c = Login;\nvar _c;\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"names":["React","useState","useNavigate","axios","jsxDEV","_jsxDEV","Login","_s","nav","API","process","env","REACT_APP_API_BASE_URL","identifier","setIdentifier","password","setPassword","loading","setLoading","err","setErr","submit","e","preventDefault","id","trim","pw","payload","includes","email","username","data","post","localStorage","setItem","token","defaults","headers","common","replace","_e$response","_e$config","_e$response2","_e$response2$data","status","response","url","config","msg","code","error","style","maxWidth","margin","border","padding","borderRadius","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","type","value","onChange","target","required","autoFocus","autoComplete","placeholder","width","color","marginBottom","disabled","_c","$RefreshReg$"],"sources":["D:/project19/frontend/src/auth/Login.js"],"sourcesContent":["// src/auth/Login.js\r\n// หน้าที่: ฟอร์มล็อกอิน → POST /api/auth/login → เก็บ token + ตั้ง Authorization header → ไป /admin/orders\r\n\r\nimport React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\n\r\nexport default function Login() {\r\n  const nav = useNavigate();\r\n\r\n  // ใช้ URL เต็มกันพลาด (ถ้า index.js ยังไม่ได้ตั้ง baseURL ตอน dev)\r\n  const API = process.env.REACT_APP_API_BASE_URL || 'http://localhost:3001';\r\n\r\n  // -------------------- state ฟอร์มและสถานะ --------------------\r\n  // ค่าตัวอย่างเพื่อเทสเร็ว (โปรดลบ/เปลี่ยนในโปรดักชัน)\r\n  const [identifier, setIdentifier] = useState('suppachai1601@gmail.com'); // อีเมลหรือชื่อผู้ใช้\r\n  const [password, setPassword] = useState('password123');\r\n  const [loading, setLoading] = useState(false);\r\n  const [err, setErr] = useState('');\r\n\r\n  // -------------------- ส่งฟอร์มล็อกอิน --------------------\r\n  async function submit(e) {\r\n    e.preventDefault();\r\n    if (loading) return;      // กันกดซ้ำ\r\n\r\n    setErr('');\r\n    setLoading(true);\r\n\r\n    // ตัดช่องว่างหัวท้าย\r\n    const id = identifier.trim();\r\n    const pw = password.trim();\r\n\r\n    // ถ้ามี @ ให้ถือว่าเป็นอีเมล ไม่งั้นเป็น username\r\n    const payload =\r\n      id.includes('@') ? { email: id, password: pw } : { username: id, password: pw };\r\n\r\n    try {\r\n      // ยิงไป backend\r\n      const { data } = await axios.post(`${API}/api/auth/login`, payload);\r\n\r\n      // เก็บ token + ตั้ง header ให้ axios\r\n      localStorage.setItem('token', data.token);\r\n      axios.defaults.headers.common['Authorization'] = `Bearer ${data.token}`;\r\n\r\n      // (ถ้าส่ง user มาด้วยอยากจะเซฟก็ได้)\r\n      // localStorage.setItem('user', JSON.stringify(data.user));\r\n\r\n      // ไปหน้าคำสั่งซื้อ\r\n      nav('/admin/orders', { replace: true });\r\n    } catch (e) {\r\n      // แสดง error ที่ช่วยดีบักได้\r\n      const status = e.response?.status;\r\n      const url = e.config?.url;\r\n      const msg =\r\n        status === 401\r\n          ? 'อีเมล/ชื่อผู้ใช้ หรือรหัสผ่านไม่ถูกต้อง'\r\n          : e.code === 'ERR_NETWORK'\r\n          ? 'เชื่อมต่อเซิร์ฟเวอร์ไม่ได้ (ตรวจสอบ backend ที่พอร์ต 3001)'\r\n          : e.response?.data?.error || 'เกิดข้อผิดพลาดในการเข้าสู่ระบบ';\r\n      setErr(`${msg}${status ? ` [${status}]` : ''}${url ? ` @ ${url}` : ''}`);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div style={{ maxWidth: 360, margin: '64px auto', border: '1px solid #eee', padding: 16, borderRadius: 8 }}>\r\n      <h2>เข้าสู่ระบบ</h2>\r\n\r\n      <form onSubmit={submit}>\r\n        <label>อีเมลหรือชื่อผู้ใช้</label>\r\n        <input\r\n          type=\"text\"\r\n          value={identifier}\r\n          onChange={e => setIdentifier(e.target.value)}\r\n          required\r\n          autoFocus\r\n          autoComplete=\"username email\"\r\n          placeholder=\"อีเมล หรือชื่อผู้ใช้\"\r\n          style={{ width: '100%', padding: 8, margin: '6px 0 12px' }}\r\n        />\r\n\r\n        <label>รหัสผ่าน</label>\r\n        <input\r\n          type=\"password\"\r\n          value={password}\r\n          onChange={e => setPassword(e.target.value)}\r\n          required\r\n          autoComplete=\"current-password\"\r\n          style={{ width: '100%', padding: 8, margin: '6px 0 12px' }}\r\n        />\r\n\r\n        {err && <div style={{ color: 'crimson', marginBottom: 12 }}>{err}</div>}\r\n\r\n        <button type=\"submit\" disabled={loading} style={{ width: '100%', padding: 10 }}>\r\n          {loading ? 'กำลังเข้าสู่ระบบ…' : 'เข้าสู่ระบบ'}\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}