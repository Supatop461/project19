{"ast":null,"code":"var _jsxFileName = \"D:\\\\project19\\\\frontend\\\\src\\\\admin\\\\AdminCategories.js\",\n  _api$defaults,\n  _s = $RefreshSig$();\n// [FRONTEND] src/admin/AdminCategories.js\n// ✅ จัดการ \"ประเภท\" แยกหน้า\n// - ลิสต์/เพิ่ม/แก้ไข/ลบ ประเภท\n// - อัปโหลด/ล้างรูปประเภท\n// - แสดง/ซ่อน (publish toggle) สำหรับประเภท\n// - ตัวกรอง (ทั้งหมด/เฉพาะที่แสดง/เฉพาะที่ซ่อน)\n// - ปุ่มกลับไปหน้าสินค้า\n\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport './ProductManagement.css'; // ใช้สไตล์เดิม\nimport { api, path } from '../lib/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst asStr = v => v === null || v === undefined ? '' : String(v);\n\n// สร้าง URL รูป (ถ้า backend ส่งเป็น /uploads/... ให้ต่อ BASE ให้เป็น absolute)\nconst API_BASE = (api === null || api === void 0 ? void 0 : (_api$defaults = api.defaults) === null || _api$defaults === void 0 ? void 0 : _api$defaults.baseURL) || process.env.REACT_APP_API_BASE || 'http://localhost:3001';\nconst ABS_BASE = String(API_BASE).replace(/\\/+$/, '');\nconst resolveUrl = u => {\n  if (!u) return '';\n  const s = String(u);\n  if (/^(https?:|blob:)/i.test(s)) return s;\n  if (s.startsWith('/uploads/')) return `${ABS_BASE}${s}`;\n  return s;\n};\nexport default function AdminCategories() {\n  _s();\n  const [categories, setCategories] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [catFilter, setCatFilter] = useState('all'); // all | published | hidden\n  const [newCat, setNewCat] = useState({\n    category_id: '',\n    category_name: ''\n  });\n  const handleApiError = (err, fallback = 'เกิดข้อผิดพลาด') => {\n    var _err$response, _err$response2, _err$response2$data;\n    console.error(fallback, (err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data) || (err === null || err === void 0 ? void 0 : err.message) || err);\n    alert((err === null || err === void 0 ? void 0 : (_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.error) || (err === null || err === void 0 ? void 0 : err.message) || fallback);\n  };\n\n  // โหลดประเภท\n  const fetchCategories = async () => {\n    try {\n      const {\n        data\n      } = await api.get(path('/categories'));\n      setCategories(Array.isArray(data) ? data : (data === null || data === void 0 ? void 0 : data.items) || []);\n    } catch (err) {\n      handleApiError(err, '❌ โหลดประเภทไม่สำเร็จ');\n    }\n  };\n\n  // อัปโหลดรูปประเภท\n  async function uploadCategoryImage(file) {\n    if (!file) return null;\n    // เส้นทางหลัก\n    try {\n      var _res$data, _res$data2;\n      const fd = new FormData();\n      fd.append('file', file);\n      const res = await api.post(path('/uploads/category-image'), fd, {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      });\n      return (res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.url) || (res === null || res === void 0 ? void 0 : (_res$data2 = res.data) === null || _res$data2 === void 0 ? void 0 : _res$data2.imageUrl) || null;\n    } catch (e1) {\n      // fallback: /upload\n      try {\n        var _res$data3, _res$data4, _res$data5;\n        const fd = new FormData();\n        fd.append('file', file);\n        const res = await api.post(path('/upload'), fd, {\n          headers: {\n            'Content-Type': 'multipart/form-data'\n          }\n        });\n        return (res === null || res === void 0 ? void 0 : (_res$data3 = res.data) === null || _res$data3 === void 0 ? void 0 : _res$data3.url) || (res === null || res === void 0 ? void 0 : (_res$data4 = res.data) === null || _res$data4 === void 0 ? void 0 : _res$data4.imageUrl) || (res === null || res === void 0 ? void 0 : (_res$data5 = res.data) === null || _res$data5 === void 0 ? void 0 : _res$data5.path) || null;\n      } catch (e2) {\n        throw e2;\n      }\n    }\n  }\n\n  // แสดง/ซ่อน (publish)\n  async function togglePublish(categoryId, current) {\n    try {\n      await api.patch(path(`/admin/categories/${categoryId}/publish`), {\n        is_published: !current\n      });\n      await fetchCategories();\n    } catch (err) {\n      handleApiError(err, '❌ อัปเดตการแสดงผลไม่สำเร็จ');\n    }\n  }\n\n  // เพิ่มประเภท\n  async function createCategory() {\n    if (!newCat.category_name.trim()) return alert('ใส่ category_name ก่อน');\n    try {\n      var _newCat$category_id;\n      await api.post(path('/categories'), {\n        category_id: ((_newCat$category_id = newCat.category_id) === null || _newCat$category_id === void 0 ? void 0 : _newCat$category_id.trim()) || undefined,\n        category_name: newCat.category_name.trim()\n      });\n      await fetchCategories();\n      setNewCat({\n        category_id: '',\n        category_name: ''\n      });\n    } catch (err) {\n      handleApiError(err, '❌ เพิ่มประเภทไม่สำเร็จ');\n    }\n  }\n\n  // แก้ไขชื่อประเภท\n  async function editCategory(c) {\n    const name = window.prompt('ชื่อประเภทใหม่', c.category_name);\n    if (name === null) return;\n    const trimmed = name.trim();\n    if (!trimmed || trimmed === c.category_name) return;\n    try {\n      await api.put(path(`/categories/${c.category_id}`), {\n        category_name: trimmed\n      });\n      await fetchCategories();\n    } catch (err) {\n      handleApiError(err, '❌ แก้ไขประเภทไม่สำเร็จ');\n    }\n  }\n\n  // ลบประเภท\n  async function deleteCategory(c) {\n    if (!window.confirm(`ลบประเภท \"${c.category_name}\" ?`)) return;\n    try {\n      await api.delete(path(`/categories/${c.category_id}`));\n      await fetchCategories();\n    } catch (err) {\n      handleApiError(err, '❌ ลบประเภทไม่สำเร็จ');\n    }\n  }\n\n  // อัปโหลด/ล้างรูปภาพของประเภท\n  async function chooseImage(c, file) {\n    if (!file) return;\n    try {\n      const url = await uploadCategoryImage(file);\n      if (!url) return alert('อัปโหลดไม่สำเร็จ');\n      await api.put(path(`/categories/${c.category_id}`), {\n        image_url: url\n      });\n      await fetchCategories();\n    } catch (err) {\n      handleApiError(err, '❌ อัปโหลด/บันทึกรูปประเภทไม่สำเร็จ');\n    }\n  }\n  async function clearImage(c) {\n    if (!window.confirm(`ล้างภาพของ \"${c.category_name}\" ใช่ไหม?`)) return;\n    try {\n      await api.put(path(`/categories/${c.category_id}`), {\n        image_url: null\n      });\n      await fetchCategories();\n    } catch (err) {\n      handleApiError(err, '❌ ล้างภาพไม่สำเร็จ');\n    }\n  }\n  useEffect(() => {\n    (async () => {\n      setLoading(true);\n      await fetchCategories();\n      setLoading(false);\n    })();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  const filteredCats = useMemo(() => {\n    if (!Array.isArray(categories)) return [];\n    return categories.filter(c => {\n      const published = typeof c.is_published === 'boolean' ? c.is_published : true;\n      if (catFilter === 'published') return published;\n      if (catFilter === 'hidden') return !published;\n      return true;\n    });\n  }, [categories, catFilter]);\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: 12\n    },\n    children: \"\\u0E01\\u0E33\\u0E25\\u0E31\\u0E07\\u0E42\\u0E2B\\u0E25\\u0E14\\u0E02\\u0E49\\u0E2D\\u0E21\\u0E39\\u0E25\\u2026\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 165,\n    columnNumber: 23\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"pm-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        gap: 8,\n        margin: '12px 0 20px',\n        flexWrap: 'wrap'\n      },\n      children: /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/admin/products\",\n        className: \"btn btn-ghost\",\n        children: \"\\u2190 \\u0E01\\u0E25\\u0E31\\u0E1A\\u0E44\\u0E1B\\u0E08\\u0E31\\u0E14\\u0E01\\u0E32\\u0E23\\u0E2A\\u0E34\\u0E19\\u0E04\\u0E49\\u0E32\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\u0E08\\u0E31\\u0E14\\u0E01\\u0E32\\u0E23\\u0E1B\\u0E23\\u0E30\\u0E40\\u0E20\\u0E17\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"pm-actions mt-8\",\n      style: {\n        flexWrap: 'wrap'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        placeholder: \"category_id (\\u0E40\\u0E27\\u0E49\\u0E19\\u0E44\\u0E14\\u0E49\\u0E43\\u0E2B\\u0E49\\u0E23\\u0E30\\u0E1A\\u0E1A gen)\",\n        value: newCat.category_id,\n        onChange: e => setNewCat({\n          ...newCat,\n          category_id: e.target.value\n        }),\n        style: {\n          maxWidth: 220\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        placeholder: \"category_name\",\n        value: newCat.category_name,\n        onChange: e => setNewCat({\n          ...newCat,\n          category_name: e.target.value\n        }),\n        style: {\n          minWidth: 220\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        className: \"btn btn-primary\",\n        onClick: createCategory,\n        children: \"\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E1B\\u0E23\\u0E30\\u0E40\\u0E20\\u0E17\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"pm-toolbar\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"seg\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: `seg-btn ${catFilter === 'all' ? 'active' : ''}`,\n          onClick: () => setCatFilter('all'),\n          title: \"\\u0E14\\u0E39\\u0E17\\u0E31\\u0E49\\u0E07\\u0E2B\\u0E21\\u0E14\",\n          children: \"\\u0E17\\u0E31\\u0E49\\u0E07\\u0E2B\\u0E21\\u0E14\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: `seg-btn ${catFilter === 'published' ? 'active' : ''}`,\n          onClick: () => setCatFilter('published'),\n          title: \"\\u0E40\\u0E09\\u0E1E\\u0E32\\u0E30\\u0E17\\u0E35\\u0E48\\u0E41\\u0E2A\\u0E14\\u0E07\",\n          children: \"\\u0E40\\u0E09\\u0E1E\\u0E32\\u0E30\\u0E17\\u0E35\\u0E48\\u0E41\\u0E2A\\u0E14\\u0E07\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: `seg-btn ${catFilter === 'hidden' ? 'active' : ''}`,\n          onClick: () => setCatFilter('hidden'),\n          title: \"\\u0E40\\u0E09\\u0E1E\\u0E32\\u0E30\\u0E17\\u0E35\\u0E48\\u0E0B\\u0E48\\u0E2D\\u0E19\",\n          children: \"\\u0E40\\u0E09\\u0E1E\\u0E32\\u0E30\\u0E17\\u0E35\\u0E48\\u0E0B\\u0E48\\u0E2D\\u0E19\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"pm-table-wrap mt-8\",\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"pm-table pm-fixed\",\n        children: [/*#__PURE__*/_jsxDEV(\"colgroup\", {\n          children: [/*#__PURE__*/_jsxDEV(\"col\", {\n            className: \"col-id\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"col\", {\n            className: \"col-name\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"col\", {\n            className: \"col-imgact\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"col\", {\n            className: \"col-thumb\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"col\", {\n            style: {\n              width: 140\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u0E23\\u0E2B\\u0E31\\u0E2A\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 231,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E1B\\u0E23\\u0E30\\u0E40\\u0E20\\u0E17\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              style: {\n                textAlign: 'center'\n              },\n              children: \"\\u0E08\\u0E31\\u0E14\\u0E01\\u0E32\\u0E23\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              style: {\n                textAlign: 'center'\n              },\n              children: \"\\u0E23\\u0E39\\u0E1B\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 234,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              style: {\n                textAlign: 'center'\n              },\n              children: \"\\u0E41\\u0E2A\\u0E14\\u0E07\\u0E1C\\u0E25\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 235,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: [(filteredCats || []).map(c => {\n            const published = typeof c.is_published === 'boolean' ? c.is_published : true;\n            return /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: c.category_id\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 243,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: `pill ${published ? 'on' : 'off'}`,\n                  children: published ? 'กำลังแสดง' : 'ถูกซ่อน'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 245,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"name-with-badges\",\n                  children: c.category_name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 248,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 244,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"action-stack\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn btn-ghost\",\n                  onClick: () => editCategory(c),\n                  children: \"\\u0E41\\u0E01\\u0E49\\u0E44\\u0E02\\u0E0A\\u0E37\\u0E48\\u0E2D\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 253,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"btn btn-ghost\",\n                  style: {\n                    cursor: 'pointer',\n                    textAlign: 'center'\n                  },\n                  children: [\"\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\\u0E23\\u0E39\\u0E1B\", /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"file\",\n                    accept: \"image/*\",\n                    hidden: true,\n                    onChange: async e => {\n                      var _e$target$files;\n                      const f = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n                      e.target.value = '';\n                      if (!f) return;\n                      await chooseImage(c, f);\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 259,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 257,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn btn-warn\",\n                  disabled: !c.image_url,\n                  onClick: () => clearImage(c),\n                  children: \"\\u0E25\\u0E49\\u0E32\\u0E07\\u0E20\\u0E32\\u0E1E\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 272,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn btn-danger\",\n                  onClick: () => deleteCategory(c),\n                  children: \"\\u0E25\\u0E1A\\u0E1B\\u0E23\\u0E30\\u0E40\\u0E20\\u0E17\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 276,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 252,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"thumb-cell\",\n                children: c.image_url ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: resolveUrl(c.image_url),\n                  alt: c.category_name,\n                  className: \"thumb-img\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 284,\n                  columnNumber: 23\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"thumb-placeholder\",\n                  children: \"\\u0E44\\u0E21\\u0E48\\u0E21\\u0E35\\u0E23\\u0E39\\u0E1B\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 286,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 282,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"cell-actions\",\n                style: {\n                  textAlign: 'center'\n                },\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: `btn ${published ? 'btn-warn' : 'btn-primary'}`,\n                  onClick: () => togglePublish(c.category_id, published),\n                  title: published ? 'ซ่อน' : 'แสดง',\n                  children: published ? 'ไม่แสดง' : 'แสดง'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 292,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 291,\n                columnNumber: 19\n              }, this)]\n            }, c.category_id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 242,\n              columnNumber: 17\n            }, this);\n          }), (!filteredCats || filteredCats.length === 0) && /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: /*#__PURE__*/_jsxDEV(\"td\", {\n              colSpan: 5,\n              style: {\n                color: '#777'\n              },\n              children: \"\\u2014 \\u0E44\\u0E21\\u0E48\\u0E21\\u0E35\\u0E1B\\u0E23\\u0E30\\u0E40\\u0E20\\u0E17 \\u2014\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 304,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 304,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 168,\n    columnNumber: 5\n  }, this);\n}\n_s(AdminCategories, \"zRISOEOfw/77l+GJNR3eg7Q5zbg=\");\n_c = AdminCategories;\nvar _c;\n$RefreshReg$(_c, \"AdminCategories\");","map":{"version":3,"names":["React","useEffect","useMemo","useState","Link","api","path","jsxDEV","_jsxDEV","asStr","v","undefined","String","API_BASE","_api$defaults","defaults","baseURL","process","env","REACT_APP_API_BASE","ABS_BASE","replace","resolveUrl","u","s","test","startsWith","AdminCategories","_s","categories","setCategories","loading","setLoading","catFilter","setCatFilter","newCat","setNewCat","category_id","category_name","handleApiError","err","fallback","_err$response","_err$response2","_err$response2$data","console","error","response","data","message","alert","fetchCategories","get","Array","isArray","items","uploadCategoryImage","file","_res$data","_res$data2","fd","FormData","append","res","post","headers","url","imageUrl","e1","_res$data3","_res$data4","_res$data5","e2","togglePublish","categoryId","current","patch","is_published","createCategory","trim","_newCat$category_id","editCategory","c","name","window","prompt","trimmed","put","deleteCategory","confirm","delete","chooseImage","image_url","clearImage","filteredCats","filter","published","style","padding","children","fileName","_jsxFileName","lineNumber","columnNumber","className","display","gap","margin","flexWrap","to","placeholder","value","onChange","e","target","maxWidth","minWidth","type","onClick","title","width","textAlign","map","cursor","accept","hidden","_e$target$files","f","files","disabled","src","alt","length","colSpan","color","_c","$RefreshReg$"],"sources":["D:/project19/frontend/src/admin/AdminCategories.js"],"sourcesContent":["// [FRONTEND] src/admin/AdminCategories.js\r\n// ✅ จัดการ \"ประเภท\" แยกหน้า\r\n// - ลิสต์/เพิ่ม/แก้ไข/ลบ ประเภท\r\n// - อัปโหลด/ล้างรูปประเภท\r\n// - แสดง/ซ่อน (publish toggle) สำหรับประเภท\r\n// - ตัวกรอง (ทั้งหมด/เฉพาะที่แสดง/เฉพาะที่ซ่อน)\r\n// - ปุ่มกลับไปหน้าสินค้า\r\n\r\nimport React, { useEffect, useMemo, useState } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport './ProductManagement.css'; // ใช้สไตล์เดิม\r\nimport { api, path } from '../lib/api';\r\n\r\nconst asStr = (v) => (v === null || v === undefined) ? '' : String(v);\r\n\r\n// สร้าง URL รูป (ถ้า backend ส่งเป็น /uploads/... ให้ต่อ BASE ให้เป็น absolute)\r\nconst API_BASE = (api?.defaults?.baseURL) || process.env.REACT_APP_API_BASE || 'http://localhost:3001';\r\nconst ABS_BASE = String(API_BASE).replace(/\\/+$/,'');\r\nconst resolveUrl = (u) => {\r\n  if (!u) return '';\r\n  const s = String(u);\r\n  if (/^(https?:|blob:)/i.test(s)) return s;\r\n  if (s.startsWith('/uploads/')) return `${ABS_BASE}${s}`;\r\n  return s;\r\n};\r\n\r\nexport default function AdminCategories() {\r\n  const [categories, setCategories]   = useState([]);\r\n  const [loading, setLoading]         = useState(false);\r\n  const [catFilter, setCatFilter]     = useState('all'); // all | published | hidden\r\n  const [newCat, setNewCat]           = useState({ category_id: '', category_name: '' });\r\n\r\n  const handleApiError = (err, fallback = 'เกิดข้อผิดพลาด') => {\r\n    console.error(fallback, err?.response?.data || err?.message || err);\r\n    alert(err?.response?.data?.error || err?.message || fallback);\r\n  };\r\n\r\n  // โหลดประเภท\r\n  const fetchCategories = async () => {\r\n    try {\r\n      const { data } = await api.get(path('/categories'));\r\n      setCategories(Array.isArray(data) ? data : (data?.items || []));\r\n    } catch (err) {\r\n      handleApiError(err, '❌ โหลดประเภทไม่สำเร็จ');\r\n    }\r\n  };\r\n\r\n  // อัปโหลดรูปประเภท\r\n  async function uploadCategoryImage(file) {\r\n    if (!file) return null;\r\n    // เส้นทางหลัก\r\n    try {\r\n      const fd = new FormData();\r\n      fd.append('file', file);\r\n      const res = await api.post(path('/uploads/category-image'), fd, {\r\n        headers: { 'Content-Type': 'multipart/form-data' },\r\n      });\r\n      return res?.data?.url || res?.data?.imageUrl || null;\r\n    } catch (e1) {\r\n      // fallback: /upload\r\n      try {\r\n        const fd = new FormData();\r\n        fd.append('file', file);\r\n        const res = await api.post(path('/upload'), fd, {\r\n          headers: { 'Content-Type': 'multipart/form-data' },\r\n        });\r\n        return res?.data?.url || res?.data?.imageUrl || res?.data?.path || null;\r\n      } catch (e2) {\r\n        throw e2;\r\n      }\r\n    }\r\n  }\r\n\r\n  // แสดง/ซ่อน (publish)\r\n  async function togglePublish(categoryId, current) {\r\n    try {\r\n      await api.patch(path(`/admin/categories/${categoryId}/publish`), { is_published: !current });\r\n      await fetchCategories();\r\n    } catch (err) {\r\n      handleApiError(err, '❌ อัปเดตการแสดงผลไม่สำเร็จ');\r\n    }\r\n  }\r\n\r\n  // เพิ่มประเภท\r\n  async function createCategory() {\r\n    if (!newCat.category_name.trim()) return alert('ใส่ category_name ก่อน');\r\n    try {\r\n      await api.post(path('/categories'), {\r\n        category_id:  newCat.category_id?.trim() || undefined,\r\n        category_name: newCat.category_name.trim()\r\n      });\r\n      await fetchCategories();\r\n      setNewCat({ category_id:'', category_name:'' });\r\n    } catch (err) {\r\n      handleApiError(err, '❌ เพิ่มประเภทไม่สำเร็จ');\r\n    }\r\n  }\r\n\r\n  // แก้ไขชื่อประเภท\r\n  async function editCategory(c) {\r\n    const name = window.prompt('ชื่อประเภทใหม่', c.category_name);\r\n    if (name === null) return;\r\n    const trimmed = name.trim();\r\n    if (!trimmed || trimmed === c.category_name) return;\r\n    try {\r\n      await api.put(path(`/categories/${c.category_id}`), { category_name: trimmed });\r\n      await fetchCategories();\r\n    } catch (err) {\r\n      handleApiError(err, '❌ แก้ไขประเภทไม่สำเร็จ');\r\n    }\r\n  }\r\n\r\n  // ลบประเภท\r\n  async function deleteCategory(c) {\r\n    if (!window.confirm(`ลบประเภท \"${c.category_name}\" ?`)) return;\r\n    try {\r\n      await api.delete(path(`/categories/${c.category_id}`));\r\n      await fetchCategories();\r\n    } catch (err) {\r\n      handleApiError(err, '❌ ลบประเภทไม่สำเร็จ');\r\n    }\r\n  }\r\n\r\n  // อัปโหลด/ล้างรูปภาพของประเภท\r\n  async function chooseImage(c, file) {\r\n    if (!file) return;\r\n    try {\r\n      const url = await uploadCategoryImage(file);\r\n      if (!url) return alert('อัปโหลดไม่สำเร็จ');\r\n      await api.put(path(`/categories/${c.category_id}`), { image_url: url });\r\n      await fetchCategories();\r\n    } catch (err) {\r\n      handleApiError(err, '❌ อัปโหลด/บันทึกรูปประเภทไม่สำเร็จ');\r\n    }\r\n  }\r\n  async function clearImage(c) {\r\n    if (!window.confirm(`ล้างภาพของ \"${c.category_name}\" ใช่ไหม?`)) return;\r\n    try {\r\n      await api.put(path(`/categories/${c.category_id}`), { image_url: null });\r\n      await fetchCategories();\r\n    } catch (err) {\r\n      handleApiError(err, '❌ ล้างภาพไม่สำเร็จ');\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      setLoading(true);\r\n      await fetchCategories();\r\n      setLoading(false);\r\n    })();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const filteredCats = useMemo(() => {\r\n    if (!Array.isArray(categories)) return [];\r\n    return categories.filter(c => {\r\n      const published = (typeof c.is_published === 'boolean') ? c.is_published : true;\r\n      if (catFilter === 'published') return published;\r\n      if (catFilter === 'hidden')    return !published;\r\n      return true;\r\n    });\r\n  }, [categories, catFilter]);\r\n\r\n  if (loading) return <div style={{ padding: 12 }}>กำลังโหลดข้อมูล…</div>;\r\n\r\n  return (\r\n    <div className=\"pm-page\">\r\n      {/* ปุ่มกลับหน้า \"สินค้า\" */}\r\n      <div style={{display:'flex', gap:8, margin:'12px 0 20px', flexWrap:'wrap'}}>\r\n        <Link to=\"/admin/products\" className=\"btn btn-ghost\">← กลับไปจัดการสินค้า</Link>\r\n      </div>\r\n\r\n      <h2>จัดการประเภท</h2>\r\n\r\n      {/* ฟอร์มเพิ่มประเภท */}\r\n      <div className=\"pm-actions mt-8\" style={{ flexWrap:'wrap' }}>\r\n        <input\r\n          placeholder=\"category_id (เว้นได้ให้ระบบ gen)\"\r\n          value={newCat.category_id}\r\n          onChange={(e)=>setNewCat({ ...newCat, category_id: e.target.value })}\r\n          style={{ maxWidth:220 }}\r\n        />\r\n        <input\r\n          placeholder=\"category_name\"\r\n          value={newCat.category_name}\r\n          onChange={(e)=>setNewCat({ ...newCat, category_name: e.target.value })}\r\n          style={{ minWidth:220 }}\r\n        />\r\n        <button type=\"button\" className=\"btn btn-primary\" onClick={createCategory}>\r\n          เพิ่มประเภท\r\n        </button>\r\n      </div>\r\n\r\n      {/* Toolbar: ฟิลเตอร์ */}\r\n      <div className=\"pm-toolbar\">\r\n        <div className=\"seg\">\r\n          <button\r\n            type=\"button\"\r\n            className={`seg-btn ${catFilter==='all' ? 'active': ''}`}\r\n            onClick={()=>setCatFilter('all')}\r\n            title=\"ดูทั้งหมด\"\r\n          >ทั้งหมด</button>\r\n          <button\r\n            type=\"button\"\r\n            className={`seg-btn ${catFilter==='published' ? 'active': ''}`}\r\n            onClick={()=>setCatFilter('published')}\r\n            title=\"เฉพาะที่แสดง\"\r\n          >เฉพาะที่แสดง</button>\r\n          <button\r\n            type=\"button\"\r\n            className={`seg-btn ${catFilter==='hidden' ? 'active': ''}`}\r\n            onClick={()=>setCatFilter('hidden')}\r\n            title=\"เฉพาะที่ซ่อน\"\r\n          >เฉพาะที่ซ่อน</button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* ตารางประเภท */}\r\n      <div className=\"pm-table-wrap mt-8\">\r\n        <table className=\"pm-table pm-fixed\">\r\n          <colgroup>\r\n            <col className=\"col-id\" />\r\n            <col className=\"col-name\" />\r\n            <col className=\"col-imgact\" />\r\n            <col className=\"col-thumb\" />\r\n            <col style={{ width: 140 }} />\r\n          </colgroup>\r\n          <thead>\r\n            <tr>\r\n              <th>รหัส</th>\r\n              <th>ชื่อประเภท</th>\r\n              <th style={{textAlign:'center'}}>จัดการ</th>\r\n              <th style={{textAlign:'center'}}>รูป</th>\r\n              <th style={{textAlign:'center'}}>แสดงผล</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {(filteredCats || []).map(c => {\r\n              const published = (typeof c.is_published === 'boolean') ? c.is_published : true;\r\n              return (\r\n                <tr key={c.category_id}>\r\n                  <td>{c.category_id}</td>\r\n                  <td>\r\n                    <span className={`pill ${published ? 'on' : 'off'}`}>\r\n                      {published ? 'กำลังแสดง' : 'ถูกซ่อน'}\r\n                    </span>\r\n                    <span className=\"name-with-badges\">{c.category_name}</span>\r\n                  </td>\r\n\r\n                  {/* จัดการ (แก้ไข/ลบ + อัปโหลด/ล้างภาพ) */}\r\n                  <td className=\"action-stack\">\r\n                    <button className=\"btn btn-ghost\" onClick={()=>editCategory(c)}>\r\n                      แก้ไขชื่อ\r\n                    </button>\r\n\r\n                    <label className=\"btn btn-ghost\" style={{ cursor:'pointer', textAlign:'center' }}>\r\n                      เลือกรูป\r\n                      <input\r\n                        type=\"file\"\r\n                        accept=\"image/*\"\r\n                        hidden\r\n                        onChange={async (e)=>{\r\n                          const f = e.target.files?.[0];\r\n                          e.target.value = '';\r\n                          if (!f) return;\r\n                          await chooseImage(c, f);\r\n                        }}\r\n                      />\r\n                    </label>\r\n\r\n                    <button className=\"btn btn-warn\" disabled={!c.image_url} onClick={()=>clearImage(c)}>\r\n                      ล้างภาพ\r\n                    </button>\r\n\r\n                    <button className=\"btn btn-danger\" onClick={()=>deleteCategory(c)}>\r\n                      ลบประเภท\r\n                    </button>\r\n                  </td>\r\n\r\n                  {/* รูป */}\r\n                  <td className=\"thumb-cell\">\r\n                    {c.image_url ? (\r\n                      <img src={resolveUrl(c.image_url)} alt={c.category_name} className=\"thumb-img\" />\r\n                    ) : (\r\n                      <div className=\"thumb-placeholder\">ไม่มีรูป</div>\r\n                    )}\r\n                  </td>\r\n\r\n                  {/* แสดงผล */}\r\n                  <td className=\"cell-actions\" style={{ textAlign:'center' }}>\r\n                    <button\r\n                      className={`btn ${published ? 'btn-warn' : 'btn-primary'}`}\r\n                      onClick={() => togglePublish(c.category_id, published)}\r\n                      title={published ? 'ซ่อน' : 'แสดง'}\r\n                    >\r\n                      {published ? 'ไม่แสดง' : 'แสดง'}\r\n                    </button>\r\n                  </td>\r\n                </tr>\r\n              );\r\n            })}\r\n            {(!filteredCats || filteredCats.length === 0) && (\r\n              <tr><td colSpan={5} style={{ color:'#777' }}>— ไม่มีประเภท —</td></tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}