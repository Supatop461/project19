{"ast":null,"code":"var _jsxFileName = \"D:\\\\project19\\\\frontend\\\\src\\\\admin\\\\VariantsManager.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// src/admin/VariantsManager.js\n// ======================================================================\n// VariantsManager — โหลด SKU เดิมขึ้นมาแก้ไขได้ + สร้างคอมโบใหม่ได้ (ให้เหมือน panel ใน ProductManagement)\n// - หัวกระดาน: รหัสสินค้า + ชื่อสินค้า (โชว์สั้น ๆ)\n// - โหลดรายการ variants เดิม (รูป/ราคา/SKU/ตัวเลือก 1-3) ของสินค้านั้น \"ทั้งหมด\"\n// - อนุญาตแก้ไขทีละแถว แล้ว \"บันทึกทั้งหมด\" (batch) — พยายามหลาย endpoint ให้เข้ากับหลังบ้าน\n// - ถ้ายังไม่มี variants → ผู้ใช้ใส่ค่า chips เพื่อ generate ชุดคอมโบใหม่\n// - ปุ่มกลับไปที่ /admin/products\n// - รองรับ backend หลายแบบ (PUT /variants, POST /variants/save, POST /variants/generate, /api/variants/upsert-batch)\n// ======================================================================\n\nimport React, { useEffect, useMemo, useState, useCallback } from \"react\";\nimport { useParams, Link, useLocation } from \"react-router-dom\";\nimport { api, path, mediaSrc } from \"../lib/api\";\nimport \"./VariantsManager.css\";\n\n/* ---------- Helpers ---------- */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst authHeader = () => {\n  const t = localStorage.getItem(\"token\");\n  return t ? {\n    Authorization: `Bearer ${t}`\n  } : {};\n};\nconst pickStr = (...xs) => {\n  var _xs$find;\n  return ((_xs$find = xs.find(v => typeof v === \"string\" && v.trim())) === null || _xs$find === void 0 ? void 0 : _xs$find.trim()) || \"\";\n};\nconst rand2 = () => String(Math.floor(Math.random() * 99) + 1).padStart(2, \"0\");\n\n// ดึง productId จาก params หรือ path (กันเคส /admin/products/null/variants)\nconst useSafeProductId = () => {\n  _s();\n  var _ref, _params$id, _m$;\n  const params = useParams();\n  const location = useLocation();\n\n  // 1) จาก params (เช่น { id } หรือ { productId })\n  const idFromParams = (_ref = (_params$id = params === null || params === void 0 ? void 0 : params.id) !== null && _params$id !== void 0 ? _params$id : params === null || params === void 0 ? void 0 : params.productId) !== null && _ref !== void 0 ? _ref : null;\n\n  // 2) จาก path regex: เอาเลขหลังคำว่า products/\n  //    เช่น /admin/products/42/variants → 42\n  const m = String((location === null || location === void 0 ? void 0 : location.pathname) || \"\").match(/products\\/(\\d+)/i);\n  const idFromPath = (_m$ = m === null || m === void 0 ? void 0 : m[1]) !== null && _m$ !== void 0 ? _m$ : null;\n\n  // 3) เลือกตัวที่เป็นตัวเลขจริง\n  const n = Number(idFromParams !== null && idFromParams !== void 0 ? idFromParams : idFromPath);\n  return Number.isFinite(n) && n > 0 ? n : null;\n};\n\n/* ---------- Upload ---------- */\n_s(useSafeProductId, \"XvbjsyaVL/Av168fKJzMTyJJJf4=\", false, function () {\n  return [useParams, useLocation];\n});\nconst extractUrl = data => {\n  var _data$file, _data$file2, _data$data, _data$data2, _data$data3;\n  if (!data) return null;\n  if (typeof data === \"string\") return data;\n  const direct = data.url || data.path || data.imageUrl || data.Location || data.location || ((_data$file = data.file) === null || _data$file === void 0 ? void 0 : _data$file.url) || ((_data$file2 = data.file) === null || _data$file2 === void 0 ? void 0 : _data$file2.path) || ((_data$data = data.data) === null || _data$data === void 0 ? void 0 : _data$data.url) || ((_data$data2 = data.data) === null || _data$data2 === void 0 ? void 0 : _data$data2.path) || ((_data$data3 = data.data) === null || _data$data3 === void 0 ? void 0 : _data$data3.imageUrl);\n  if (direct) return direct;\n  try {\n    const flat = JSON.stringify(data);\n    const m = flat.match(/\"([^\"]+\\.(?:png|jpe?g|webp|gif))\"/i);\n    return m ? m[1] : null;\n  } catch {\n    return null;\n  }\n};\nconst tryUpload = async file => {\n  const fd = new FormData();\n  fd.append(\"file\", file);\n  const res = await api.post(path(\"/upload\"), fd, {\n    headers: {\n      ...authHeader(),\n      \"Content-Type\": \"multipart/form-data\"\n    }\n  });\n  const url = extractUrl(res === null || res === void 0 ? void 0 : res.data);\n  if (!url) throw new Error(\"UPLOAD_OK_BUT_NO_URL\");\n  return url;\n};\n\n/* ---------- Normalize product ---------- */\nconst normalizeProduct = raw => {\n  if (!raw) return null;\n  const d = raw.data || raw.item || raw.product || raw.result || raw;\n  return d || null;\n};\n\n/* ---------- Variant helpers ---------- */\nfunction normalizeVariant(v) {\n  var _ref2, _ref3, _v$variant_id, _ref4, _ref5, _v$price, _ref6, _ref7, _v$image_url;\n  if (!v) return null;\n  // รองรับหลาย schema ของฟิลด์\n  const out = {\n    variant_id: (_ref2 = (_ref3 = (_v$variant_id = v.variant_id) !== null && _v$variant_id !== void 0 ? _v$variant_id : v.id) !== null && _ref3 !== void 0 ? _ref3 : v.product_variant_id) !== null && _ref2 !== void 0 ? _ref2 : null,\n    sku: pickStr(v.sku, v.SKU, v.code),\n    price: (_ref4 = (_ref5 = (_v$price = v.price) !== null && _v$price !== void 0 ? _v$price : v.unit_price) !== null && _ref5 !== void 0 ? _ref5 : v.sale_price) !== null && _ref4 !== void 0 ? _ref4 : \"\",\n    image: (_ref6 = (_ref7 = (_v$image_url = v.image_url) !== null && _v$image_url !== void 0 ? _v$image_url : v.image) !== null && _ref7 !== void 0 ? _ref7 : v.imageUrl) !== null && _ref6 !== void 0 ? _ref6 : null,\n    // value ของตัวเลือก\n    opt1: pickStr(v.option1_value, v.opt1, v.color, v.value1),\n    opt2: pickStr(v.option2_value, v.opt2, v.size, v.value2),\n    opt3: pickStr(v.option3_value, v.opt3, v.material, v.value3),\n    // ชื่อของตัวเลือก\n    opt1_name: pickStr(v.opt1_name, v.option1_name, v.name1, v.option1, \"ตัวเลือก 1\"),\n    opt2_name: pickStr(v.opt2_name, v.option2_name, v.name2, v.option2, \"ตัวเลือก 2\"),\n    opt3_name: pickStr(v.opt3_name, v.option3_name, v.name3, v.option3, \"\"),\n    // กรณีมี images เป็น array\n    images: Array.isArray(v.images) ? v.images : []\n  };\n  // number → string เพื่อรองรับ <input type=number>\n  if (typeof out.price === \"number\") out.price = String(out.price);\n  // ถ้ามี images ให้ใช้รูปแรกเป็น image\n  if (!out.image && out.images.length) {\n    const im = out.images[0];\n    out.image = (im === null || im === void 0 ? void 0 : im.url) || (im === null || im === void 0 ? void 0 : im.image_url) || (im === null || im === void 0 ? void 0 : im.path) || null;\n  }\n  return out;\n}\nfunction toRowFromVariant(v) {\n  var _n$price;\n  const n = normalizeVariant(v);\n  if (!n) return null;\n  return {\n    __existing: true,\n    variant_id: n.variant_id,\n    opt1: n.opt1 || \"\",\n    opt2: n.opt2 || \"\",\n    opt3: n.opt3 || \"\",\n    price: (_n$price = n.price) !== null && _n$price !== void 0 ? _n$price : \"\",\n    sku: n.sku || \"\",\n    image: n.image || null,\n    opt1_name: n.opt1_name,\n    opt2_name: n.opt2_name,\n    opt3_name: n.opt3_name\n  };\n}\n\n/* ====================================================================== */\nexport default function VariantsManager() {\n  _s2();\n  const productId = useSafeProductId();\n\n  // product for header + SKU\n  const [product, setProduct] = useState(null);\n\n  // option names\n  const [opt1Name, setOpt1Name] = useState(\"สี\");\n  const [opt2Name, setOpt2Name] = useState(\"ขนาด\");\n  const [opt3Name, setOpt3Name] = useState(\"\");\n\n  // option values (สำหรับโหมด generate ใหม่)\n  const [opt1Values, setOpt1Values] = useState([]);\n  const [opt2Values, setOpt2Values] = useState([]);\n  const [opt3Values, setOpt3Values] = useState([]);\n\n  // rows = รายการคอมโบที่กำลังแก้ไข (อาจเป็นของเดิม หรือที่ generate)\n  const [rows, setRows] = useState([]);\n  const [saving, setSaving] = useState(false);\n  const [msg, setMsg] = useState(\"\");\n\n  /* ---------- Load product (ชื่อ/โค้ด) ---------- */\n  const loadProduct = useCallback(async () => {\n    if (!productId) return;\n    let p = null;\n    try {\n      const r = await api.get(path(`/admin/products/${productId}`));\n      p = normalizeProduct(r === null || r === void 0 ? void 0 : r.data);\n    } catch {}\n    if (!p) {\n      try {\n        const r = await api.get(path(`/products/${productId}`));\n        p = normalizeProduct(r === null || r === void 0 ? void 0 : r.data);\n      } catch {}\n    }\n    if (!p) {\n      try {\n        var _r$data;\n        const r = await api.get(path(`/admin/products`), {\n          params: {\n            include_archived: 1\n          }\n        });\n        const arr = Array.isArray(r === null || r === void 0 ? void 0 : (_r$data = r.data) === null || _r$data === void 0 ? void 0 : _r$data.items) ? r.data.items : Array.isArray(r === null || r === void 0 ? void 0 : r.data) ? r.data : [];\n        p = (arr || []).find(x => Number(x.product_id) === Number(productId)) || null;\n      } catch {}\n    }\n    setProduct(p || null);\n  }, [productId]);\n\n  /* ---------- Load variants เดิม (ทั้งหมดของสินค้านั้น) ---------- */\n  const loadVariants = useCallback(async () => {\n    var _arr;\n    if (!productId) return;\n    let arr = [];\n\n    // 🔎 ลองหลาย endpoint (ให้เหมือนใน ProductManagement)\n    const tryEndpoints = [path(`/admin/products/${productId}/variants`), path(`/products/${productId}/variants`), path(`/api/variants/by-product/${productId}`), path(`/api/variants?product_id=${productId}`)];\n    for (const url of tryEndpoints) {\n      try {\n        var _r$data2, _r$data3;\n        const r = await api.get(url, {\n          headers: authHeader()\n        });\n        const rows = (r === null || r === void 0 ? void 0 : (_r$data2 = r.data) === null || _r$data2 === void 0 ? void 0 : _r$data2.items) || (r === null || r === void 0 ? void 0 : (_r$data3 = r.data) === null || _r$data3 === void 0 ? void 0 : _r$data3.rows) || (r === null || r === void 0 ? void 0 : r.data) || [];\n        if (Array.isArray(rows) && rows.length) {\n          arr = rows;\n          break;\n        }\n      } catch {/* ignore and try next */}\n    }\n    if ((_arr = arr) !== null && _arr !== void 0 && _arr.length) {\n      const mapped = arr.map(toRowFromVariant).filter(Boolean);\n      setRows(mapped);\n\n      // เดาชื่อ option จากแถวแรก ถ้ามี\n      const first = mapped[0];\n      if (first) {\n        if (first.opt1_name) setOpt1Name(first.opt1_name);\n        if (first.opt2_name) setOpt2Name(first.opt2_name);\n        if (first.opt3_name) setOpt3Name(first.opt3_name);\n      }\n    } else {\n      // ถ้าไม่มี variant เดิม → เคลียร์ rows และรอให้ผู้ใช้สร้างคอมโบใหม่\n      setRows([]);\n    }\n  }, [productId]);\n  useEffect(() => {\n    loadProduct();\n    loadVariants();\n  }, [loadProduct, loadVariants]);\n  const productName = useMemo(() => pickStr(product === null || product === void 0 ? void 0 : product.product_name, product === null || product === void 0 ? void 0 : product.name, product === null || product === void 0 ? void 0 : product.title), [product]);\n  const productCode = useMemo(() => pickStr(product === null || product === void 0 ? void 0 : product.product_code, product === null || product === void 0 ? void 0 : product.code, product ? `P${(product === null || product === void 0 ? void 0 : product.product_id) || \"\"}` : productId ? `P${productId}` : \"\"), [product, productId]);\n\n  /* ---------- Rebuild combos when values change (เฉพาะโหมดสร้างใหม่) ---------- */\n  useEffect(() => {\n    // เฉพาะตอน \"ยังไม่มีแถวเดิม\" เท่านั้นถึงจะ build จาก chips\n    if (rows.length) return;\n    const v1 = opt1Values.length ? opt1Values : [null];\n    const v2 = opt2Values.length ? opt2Values : [null];\n    const v3 = opt3Values.length ? opt3Values : [null];\n    const combos = [];\n    for (const a of v1) for (const b of v2) for (const c of v3) {\n      combos.push({\n        opt1: a,\n        opt2: b,\n        opt3: c,\n        price: \"\",\n        sku: \"\",\n        image: null\n      });\n    }\n    setRows(combos);\n  }, [opt1Values, opt2Values, opt3Values]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  /* ---------- chip helpers ---------- */\n  const addTag = (list, setList, txt) => {\n    const v = String(txt || \"\").trim();\n    if (!v) return;\n    if (!list.some(x => x === v)) setList([...list, v]);\n  };\n  const removeTag = (list, setList, idx) => setList(list.filter((_, i) => i !== idx));\n\n  /* ---------- per-row upload ---------- */\n  const onUploadRowImage = async (file, idx) => {\n    if (!file) return;\n    const tempUrl = URL.createObjectURL(file);\n    setRows(prev => {\n      const a = [...prev];\n      a[idx] = {\n        ...a[idx],\n        image: tempUrl,\n        __temp: true\n      };\n      return a;\n    });\n    try {\n      const serverUrl = await tryUpload(file);\n      setRows(prev => {\n        const a = [...prev];\n        a[idx] = {\n          ...a[idx],\n          image: serverUrl,\n          __temp: false\n        };\n        return a;\n      });\n    } catch (e) {\n      setRows(prev => {\n        const a = [...prev];\n        a[idx] = {\n          ...a[idx],\n          image: null,\n          __temp: false\n        };\n        return a;\n      });\n      alert((e === null || e === void 0 ? void 0 : e.message) || \"Upload failed\");\n    } finally {\n      setTimeout(() => URL.revokeObjectURL(tempUrl), 2500);\n    }\n  };\n\n  /* ---------- Auto SKU (ไม่แปลงภาษา) ---------- */\n  const autoSku = () => {\n    const base = productCode || (productId ? `P${productId}` : \"P\");\n    setRows(prev => prev.map(r => {\n      const parts = [base, r.opt1, r.opt2, r.opt3].filter(Boolean);\n      return {\n        ...r,\n        sku: parts.join(\"-\") + \"-\" + rand2()\n      };\n    }));\n  };\n\n  /* ---------- Save batch (พยายามหลาย endpoint เพื่อให้เข้ากับหลังบ้าน) ---------- */\n  const saveAll = async () => {\n    setSaving(true);\n    try {\n      // กรองเฉพาะแถวที่มีรายละเอียดอย่างน้อย 1 ช่อง หรือเป็นแถวเดิม\n      const effective = rows.filter(r => r.opt1 || r.opt2 || r.opt3 || r.__existing);\n      const payloadRows = effective.map(r => ({\n        variant_id: r.variant_id || null,\n        details: [r.opt1 ? {\n          name: opt1Name,\n          value: r.opt1\n        } : null, r.opt2 ? {\n          name: opt2Name,\n          value: r.opt2\n        } : null, r.opt3 && (opt3Name || r.opt3) ? {\n          name: opt3Name || \"ตัวเลือก 3\",\n          value: r.opt3\n        } : null].filter(Boolean),\n        sku: r.sku || null,\n        price: r.price !== \"\" ? Number(r.price) : null,\n        image_url: r.image || null\n      }));\n      if (!payloadRows.length) {\n        alert(\"ยังไม่มีแถวที่มีรายละเอียดสำหรับบันทึก\");\n        setSaving(false);\n        return;\n      }\n\n      // 0) /api/variants/upsert-batch\n      let done = false;\n      try {\n        await api.post(path(`/api/variants/upsert-batch`), {\n          product_id: productId,\n          rows: payloadRows\n        }, {\n          headers: authHeader()\n        });\n        done = true;\n      } catch {}\n      if (!done) {\n        // 1) PUT /variants (อัปเดตแบบ batch)\n        try {\n          await api.put(path(`/admin/products/${productId}/variants`), {\n            rows: payloadRows\n          }, {\n            headers: authHeader()\n          });\n          done = true;\n        } catch {}\n      }\n      if (!done) {\n        // 2) POST /variants/save (upsert)\n        try {\n          await api.post(path(`/admin/products/${productId}/variants/save`), {\n            rows: payloadRows\n          }, {\n            headers: authHeader()\n          });\n          done = true;\n        } catch {}\n      }\n      if (!done) {\n        // 3) POST /variants/generate (สร้างใหม่ทั้งหมด)\n        await api.post(path(`/admin/products/${productId}/variants/generate`), {\n          rows: payloadRows\n        }, {\n          headers: authHeader()\n        });\n      }\n      setMsg(\"✅ Saved\");\n      setTimeout(() => setMsg(\"\"), 1800);\n      // reload เพื่อให้แน่ใจว่า state ตรงกับ DB\n      await loadVariants();\n    } catch (e) {\n      var _e$response, _e$response$data;\n      console.error(e);\n      alert((e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.message) || \"❌ Save failed\");\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  // ถ้ายังหา productId ไม่ได้ (เช่น path เป็น null) แจ้งให้ผู้ใช้กดกลับ\n  if (!productId) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vm-page\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"vm-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"vm-title\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"vm-product-name\",\n            children: \"\\u0E44\\u0E21\\u0E48\\u0E17\\u0E23\\u0E32\\u0E1A\\u0E23\\u0E2B\\u0E31\\u0E2A\\u0E2A\\u0E34\\u0E19\\u0E04\\u0E49\\u0E32\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"vm-product-code\",\n            children: \"\\u2014\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 372,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/admin/products\",\n          className: \"vm-back\",\n          children: \"\\u2190 \\u0E01\\u0E25\\u0E31\\u0E1A\\u0E44\\u0E1B\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E2A\\u0E34\\u0E19\\u0E04\\u0E49\\u0E32\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 374,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 369,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"vm-hint\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"URL \\u0E19\\u0E35\\u0E49\\u0E44\\u0E21\\u0E48\\u0E21\\u0E35\\u0E23\\u0E2B\\u0E31\\u0E2A\\u0E2A\\u0E34\\u0E19\\u0E04\\u0E49\\u0E32 (productId) \\u0E01\\u0E23\\u0E38\\u0E13\\u0E32\\u0E01\\u0E25\\u0E31\\u0E1A\\u0E44\\u0E1B\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\\u0E2A\\u0E34\\u0E19\\u0E04\\u0E49\\u0E32\\u0E2D\\u0E35\\u0E01\\u0E04\\u0E23\\u0E31\\u0E49\\u0E07\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 377,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 376,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 368,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"vm-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vm-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"vm-title\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"vm-product-code\",\n          children: productCode || `P${productId}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 388,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"vm-product-name\",\n          children: productName || \"—\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 389,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 387,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/admin/products\",\n        className: \"vm-back\",\n        children: \"\\u2190 \\u0E01\\u0E25\\u0E31\\u0E1A\\u0E44\\u0E1B\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E2A\\u0E34\\u0E19\\u0E04\\u0E49\\u0E32\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 391,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 386,\n      columnNumber: 7\n    }, this), msg && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vm-msg\",\n      children: msg\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 394,\n      columnNumber: 15\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vm-options\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"vm-opt\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"\\u0E15\\u0E31\\u0E27\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\\u0E17\\u0E35\\u0E48 1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 400,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          value: opt1Name,\n          onChange: e => setOpt1Name(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 401,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"vm-chips\",\n          children: [opt1Values.map((v, i) => /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"vm-chip\",\n            children: [v, /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => removeTag(opt1Values, setOpt1Values, i),\n              children: \"\\xD7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 406,\n              columnNumber: 17\n            }, this)]\n          }, i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 15\n          }, this)), !rows.length && /*#__PURE__*/_jsxDEV(\"input\", {\n            placeholder: \"\\u0E1E\\u0E34\\u0E21\\u0E1E\\u0E4C\\u0E41\\u0E25\\u0E49\\u0E27 Enter\",\n            onKeyDown: e => {\n              if (e.key === \"Enter\") {\n                e.preventDefault();\n                addTag(opt1Values, setOpt1Values, e.currentTarget.value);\n                e.currentTarget.value = \"\";\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 410,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 402,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 399,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"vm-opt\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"\\u0E15\\u0E31\\u0E27\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\\u0E17\\u0E35\\u0E48 2 (\\u0E16\\u0E49\\u0E32\\u0E21\\u0E35)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 426,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          value: opt2Name,\n          onChange: e => setOpt2Name(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 427,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"vm-chips\",\n          children: [opt2Values.map((v, i) => /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"vm-chip\",\n            children: [v, /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => removeTag(opt2Values, setOpt2Values, i),\n              children: \"\\xD7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 432,\n              columnNumber: 17\n            }, this)]\n          }, i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 430,\n            columnNumber: 15\n          }, this)), !rows.length && /*#__PURE__*/_jsxDEV(\"input\", {\n            placeholder: \"\\u0E1E\\u0E34\\u0E21\\u0E1E\\u0E4C\\u0E41\\u0E25\\u0E49\\u0E27 Enter\",\n            onKeyDown: e => {\n              if (e.key === \"Enter\") {\n                e.preventDefault();\n                addTag(opt2Values, setOpt2Values, e.currentTarget.value);\n                e.currentTarget.value = \"\";\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 436,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 428,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 425,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"vm-opt\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"\\u0E15\\u0E31\\u0E27\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\\u0E17\\u0E35\\u0E48 3 (\\u0E16\\u0E49\\u0E32\\u0E21\\u0E35)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 452,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          value: opt3Name,\n          onChange: e => setOpt3Name(e.target.value),\n          placeholder: \"\\u0E40\\u0E0A\\u0E48\\u0E19 \\u0E27\\u0E31\\u0E2A\\u0E14\\u0E38 / \\u0E23\\u0E38\\u0E48\\u0E19\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 453,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"vm-chips\",\n          children: [opt3Values.map((v, i) => /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"vm-chip\",\n            children: [v, /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => removeTag(opt3Values, setOpt3Values, i),\n              children: \"\\xD7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 462,\n              columnNumber: 17\n            }, this)]\n          }, i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 460,\n            columnNumber: 15\n          }, this)), !rows.length && /*#__PURE__*/_jsxDEV(\"input\", {\n            placeholder: \"\\u0E1E\\u0E34\\u0E21\\u0E1E\\u0E4C\\u0E41\\u0E25\\u0E49\\u0E27 Enter\",\n            onKeyDown: e => {\n              if (e.key === \"Enter\") {\n                e.preventDefault();\n                addTag(opt3Values, setOpt3Values, e.currentTarget.value);\n                e.currentTarget.value = \"\";\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 466,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 458,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 451,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 397,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vm-table-wrap\",\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"vm-table\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u0E23\\u0E39\\u0E1B\\u0E20\\u0E32\\u0E1E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 486,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: opt1Name || \"ตัวเลือก 1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 487,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: opt2Name || \"ตัวเลือก 2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 488,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: opt3Name || \"ตัวเลือก 3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 489,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u0E23\\u0E32\\u0E04\\u0E32\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 490,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"SKU\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 491,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 485,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 484,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: [rows.map((r, i) => /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              children: r.image ? /*#__PURE__*/_jsxDEV(\"img\", {\n                src: mediaSrc(r.image),\n                alt: \"\",\n                className: \"vm-thumb\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 499,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"vm-upload\",\n                children: [\"+\", /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"file\",\n                  accept: \"image/*\",\n                  onChange: e => {\n                    var _e$target$files;\n                    return onUploadRowImage((_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0], i);\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 503,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 501,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 497,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: r.opt1 || \"-\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 511,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: r.opt2 || \"-\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 512,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: r.opt3 || \"-\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 513,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"number\",\n                min: \"0\",\n                placeholder: \"\\u0E44\\u0E21\\u0E48\\u0E23\\u0E30\\u0E1A\\u0E38\",\n                value: r.price,\n                onChange: e => {\n                  const v = e.target.value;\n                  setRows(prev => {\n                    const a = [...prev];\n                    a[i] = {\n                      ...a[i],\n                      price: v\n                    };\n                    return a;\n                  });\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 515,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 514,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                placeholder: \"SKU\",\n                value: r.sku,\n                onChange: e => {\n                  const v = e.target.value;\n                  setRows(prev => {\n                    const a = [...prev];\n                    a[i] = {\n                      ...a[i],\n                      sku: v\n                    };\n                    return a;\n                  });\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 531,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 530,\n              columnNumber: 17\n            }, this)]\n          }, i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 496,\n            columnNumber: 15\n          }, this)), !rows.length && /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: /*#__PURE__*/_jsxDEV(\"td\", {\n              colSpan: 6,\n              style: {\n                textAlign: \"center\",\n                padding: \"16px\"\n              },\n              children: \"\\u0E22\\u0E31\\u0E07\\u0E44\\u0E21\\u0E48\\u0E21\\u0E35\\u0E15\\u0E31\\u0E27\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\\u0E02\\u0E2D\\u0E07\\u0E2A\\u0E34\\u0E19\\u0E04\\u0E49\\u0E32\\u0E19\\u0E35\\u0E49 \\u2014 \\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E04\\u0E48\\u0E32\\u0E43\\u0E19\\u0E0A\\u0E48\\u0E2D\\u0E07\\u0E14\\u0E49\\u0E32\\u0E19\\u0E1A\\u0E19\\u0E40\\u0E1E\\u0E37\\u0E48\\u0E2D\\u0E2A\\u0E23\\u0E49\\u0E32\\u0E07\\u0E04\\u0E2D\\u0E21\\u0E42\\u0E1A \\u0E41\\u0E25\\u0E49\\u0E27\\u0E01\\u0E14\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 548,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 547,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 494,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 483,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 482,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vm-actions\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn\",\n        onClick: autoSku,\n        disabled: saving,\n        children: \"\\u0E40\\u0E15\\u0E34\\u0E21 SKU \\u0E2D\\u0E31\\u0E15\\u0E42\\u0E19\\u0E21\\u0E31\\u0E15\\u0E34\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 559,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn-primary\",\n        onClick: saveAll,\n        disabled: saving,\n        children: saving ? \"กำลังบันทึก…\" : \"บันทึกทั้งหมด\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 562,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 558,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vm-hint\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u2022 \\u0E16\\u0E49\\u0E32\\u0E21\\u0E35 SKU \\u0E40\\u0E14\\u0E34\\u0E21 \\u0E23\\u0E30\\u0E1A\\u0E1A\\u0E08\\u0E30\\u0E42\\u0E2B\\u0E25\\u0E14\\u0E21\\u0E32\\u0E43\\u0E2B\\u0E49\\u0E41\\u0E01\\u0E49\\u0E44\\u0E02\\u0E44\\u0E14\\u0E49\\u0E17\\u0E31\\u0E19\\u0E17\\u0E35\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 569,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u2022 \\u0E16\\u0E49\\u0E32\\u0E44\\u0E21\\u0E48\\u0E21\\u0E35 SKU \\u0E40\\u0E14\\u0E34\\u0E21 \\u0E43\\u0E2B\\u0E49\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E04\\u0E48\\u0E32\\u0E15\\u0E31\\u0E27\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\\u0E14\\u0E49\\u0E32\\u0E19\\u0E1A\\u0E19 \\u0E41\\u0E25\\u0E49\\u0E27\\u0E04\\u0E48\\u0E2D\\u0E22\\u0E01\\u0E14\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 570,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u2022 \\u0E2A\\u0E15\\u0E47\\u0E2D\\u0E01\\u0E08\\u0E30\\u0E2D\\u0E34\\u0E07\\u0E08\\u0E32\\u0E01\\u0E04\\u0E25\\u0E31\\u0E07\\u0E08\\u0E23\\u0E34\\u0E07 (\\u0E44\\u0E21\\u0E48\\u0E15\\u0E49\\u0E2D\\u0E07\\u0E01\\u0E23\\u0E2D\\u0E01\\u0E17\\u0E35\\u0E48\\u0E19\\u0E35\\u0E48)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 571,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 568,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 384,\n    columnNumber: 5\n  }, this);\n}\n_s2(VariantsManager, \"Ac+jDd1XeutUFwERSX7OmgwgdmA=\", false, function () {\n  return [useSafeProductId];\n});\n_c = VariantsManager;\nvar _c;\n$RefreshReg$(_c, \"VariantsManager\");","map":{"version":3,"names":["React","useEffect","useMemo","useState","useCallback","useParams","Link","useLocation","api","path","mediaSrc","jsxDEV","_jsxDEV","authHeader","t","localStorage","getItem","Authorization","pickStr","xs","_xs$find","find","v","trim","rand2","String","Math","floor","random","padStart","useSafeProductId","_s","_ref","_params$id","_m$","params","location","idFromParams","id","productId","m","pathname","match","idFromPath","n","Number","isFinite","extractUrl","data","_data$file","_data$file2","_data$data","_data$data2","_data$data3","direct","url","imageUrl","Location","file","flat","JSON","stringify","tryUpload","fd","FormData","append","res","post","headers","Error","normalizeProduct","raw","d","item","product","result","normalizeVariant","_ref2","_ref3","_v$variant_id","_ref4","_ref5","_v$price","_ref6","_ref7","_v$image_url","out","variant_id","product_variant_id","sku","SKU","code","price","unit_price","sale_price","image","image_url","opt1","option1_value","color","value1","opt2","option2_value","size","value2","opt3","option3_value","material","value3","opt1_name","option1_name","name1","option1","opt2_name","option2_name","name2","option2","opt3_name","option3_name","name3","option3","images","Array","isArray","length","im","toRowFromVariant","_n$price","__existing","VariantsManager","_s2","setProduct","opt1Name","setOpt1Name","opt2Name","setOpt2Name","opt3Name","setOpt3Name","opt1Values","setOpt1Values","opt2Values","setOpt2Values","opt3Values","setOpt3Values","rows","setRows","saving","setSaving","msg","setMsg","loadProduct","p","r","get","_r$data","include_archived","arr","items","x","product_id","loadVariants","_arr","tryEndpoints","_r$data2","_r$data3","mapped","map","filter","Boolean","first","productName","product_name","name","title","productCode","product_code","v1","v2","v3","combos","a","b","c","push","addTag","list","setList","txt","some","removeTag","idx","_","i","onUploadRowImage","tempUrl","URL","createObjectURL","prev","__temp","serverUrl","e","alert","message","setTimeout","revokeObjectURL","autoSku","base","parts","join","saveAll","effective","payloadRows","details","value","done","put","_e$response","_e$response$data","console","error","response","className","children","fileName","_jsxFileName","lineNumber","columnNumber","to","onChange","target","onClick","placeholder","onKeyDown","key","preventDefault","currentTarget","src","alt","type","accept","_e$target$files","files","min","colSpan","style","textAlign","padding","disabled","_c","$RefreshReg$"],"sources":["D:/project19/frontend/src/admin/VariantsManager.js"],"sourcesContent":["// src/admin/VariantsManager.js\r\n// ======================================================================\r\n// VariantsManager — โหลด SKU เดิมขึ้นมาแก้ไขได้ + สร้างคอมโบใหม่ได้ (ให้เหมือน panel ใน ProductManagement)\r\n// - หัวกระดาน: รหัสสินค้า + ชื่อสินค้า (โชว์สั้น ๆ)\r\n// - โหลดรายการ variants เดิม (รูป/ราคา/SKU/ตัวเลือก 1-3) ของสินค้านั้น \"ทั้งหมด\"\r\n// - อนุญาตแก้ไขทีละแถว แล้ว \"บันทึกทั้งหมด\" (batch) — พยายามหลาย endpoint ให้เข้ากับหลังบ้าน\r\n// - ถ้ายังไม่มี variants → ผู้ใช้ใส่ค่า chips เพื่อ generate ชุดคอมโบใหม่\r\n// - ปุ่มกลับไปที่ /admin/products\r\n// - รองรับ backend หลายแบบ (PUT /variants, POST /variants/save, POST /variants/generate, /api/variants/upsert-batch)\r\n// ======================================================================\r\n\r\nimport React, { useEffect, useMemo, useState, useCallback } from \"react\";\r\nimport { useParams, Link, useLocation } from \"react-router-dom\";\r\nimport { api, path, mediaSrc } from \"../lib/api\";\r\nimport \"./VariantsManager.css\";\r\n\r\n/* ---------- Helpers ---------- */\r\nconst authHeader = () => {\r\n  const t = localStorage.getItem(\"token\");\r\n  return t ? { Authorization: `Bearer ${t}` } : {};\r\n};\r\n\r\nconst pickStr = (...xs) => xs.find((v) => typeof v === \"string\" && v.trim())?.trim() || \"\";\r\nconst rand2 = () => String(Math.floor(Math.random() * 99) + 1).padStart(2, \"0\");\r\n\r\n// ดึง productId จาก params หรือ path (กันเคส /admin/products/null/variants)\r\nconst useSafeProductId = () => {\r\n  const params = useParams();\r\n  const location = useLocation();\r\n\r\n  // 1) จาก params (เช่น { id } หรือ { productId })\r\n  const idFromParams = params?.id ?? params?.productId ?? null;\r\n\r\n  // 2) จาก path regex: เอาเลขหลังคำว่า products/\r\n  //    เช่น /admin/products/42/variants → 42\r\n  const m = String(location?.pathname || \"\").match(/products\\/(\\d+)/i);\r\n  const idFromPath = m?.[1] ?? null;\r\n\r\n  // 3) เลือกตัวที่เป็นตัวเลขจริง\r\n  const n = Number(idFromParams ?? idFromPath);\r\n  return Number.isFinite(n) && n > 0 ? n : null;\r\n};\r\n\r\n/* ---------- Upload ---------- */\r\nconst extractUrl = (data) => {\r\n  if (!data) return null;\r\n  if (typeof data === \"string\") return data;\r\n  const direct =\r\n    data.url || data.path || data.imageUrl || data.Location || data.location ||\r\n    data.file?.url || data.file?.path || data.data?.url || data.data?.path || data.data?.imageUrl;\r\n  if (direct) return direct;\r\n  try {\r\n    const flat = JSON.stringify(data);\r\n    const m = flat.match(/\"([^\"]+\\.(?:png|jpe?g|webp|gif))\"/i);\r\n    return m ? m[1] : null;\r\n  } catch { return null; }\r\n};\r\n\r\nconst tryUpload = async (file) => {\r\n  const fd = new FormData();\r\n  fd.append(\"file\", file);\r\n  const res = await api.post(path(\"/upload\"), fd, {\r\n    headers: { ...authHeader(), \"Content-Type\": \"multipart/form-data\" },\r\n  });\r\n  const url = extractUrl(res?.data);\r\n  if (!url) throw new Error(\"UPLOAD_OK_BUT_NO_URL\");\r\n  return url;\r\n};\r\n\r\n/* ---------- Normalize product ---------- */\r\nconst normalizeProduct = (raw) => {\r\n  if (!raw) return null;\r\n  const d = raw.data || raw.item || raw.product || raw.result || raw;\r\n  return d || null;\r\n};\r\n\r\n/* ---------- Variant helpers ---------- */\r\nfunction normalizeVariant(v) {\r\n  if (!v) return null;\r\n  // รองรับหลาย schema ของฟิลด์\r\n  const out = {\r\n    variant_id: v.variant_id ?? v.id ?? v.product_variant_id ?? null,\r\n    sku: pickStr(v.sku, v.SKU, v.code),\r\n    price: v.price ?? v.unit_price ?? v.sale_price ?? \"\",\r\n    image: v.image_url ?? v.image ?? v.imageUrl ?? null,\r\n    // value ของตัวเลือก\r\n    opt1: pickStr(v.option1_value, v.opt1, v.color, v.value1),\r\n    opt2: pickStr(v.option2_value, v.opt2, v.size,  v.value2),\r\n    opt3: pickStr(v.option3_value, v.opt3, v.material, v.value3),\r\n    // ชื่อของตัวเลือก\r\n    opt1_name: pickStr(v.opt1_name, v.option1_name, v.name1, v.option1, \"ตัวเลือก 1\"),\r\n    opt2_name: pickStr(v.opt2_name, v.option2_name, v.name2, v.option2, \"ตัวเลือก 2\"),\r\n    opt3_name: pickStr(v.opt3_name, v.option3_name, v.name3, v.option3, \"\"),\r\n    // กรณีมี images เป็น array\r\n    images: Array.isArray(v.images) ? v.images : [],\r\n  };\r\n  // number → string เพื่อรองรับ <input type=number>\r\n  if (typeof out.price === \"number\") out.price = String(out.price);\r\n  // ถ้ามี images ให้ใช้รูปแรกเป็น image\r\n  if (!out.image && out.images.length) {\r\n    const im = out.images[0];\r\n    out.image = im?.url || im?.image_url || im?.path || null;\r\n  }\r\n  return out;\r\n}\r\n\r\nfunction toRowFromVariant(v) {\r\n  const n = normalizeVariant(v);\r\n  if (!n) return null;\r\n  return {\r\n    __existing: true,\r\n    variant_id: n.variant_id,\r\n    opt1: n.opt1 || \"\",\r\n    opt2: n.opt2 || \"\",\r\n    opt3: n.opt3 || \"\",\r\n    price: n.price ?? \"\",\r\n    sku: n.sku || \"\",\r\n    image: n.image || null,\r\n    opt1_name: n.opt1_name,\r\n    opt2_name: n.opt2_name,\r\n    opt3_name: n.opt3_name,\r\n  };\r\n}\r\n\r\n/* ====================================================================== */\r\nexport default function VariantsManager() {\r\n  const productId = useSafeProductId();\r\n\r\n  // product for header + SKU\r\n  const [product, setProduct] = useState(null);\r\n\r\n  // option names\r\n  const [opt1Name, setOpt1Name] = useState(\"สี\");\r\n  const [opt2Name, setOpt2Name] = useState(\"ขนาด\");\r\n  const [opt3Name, setOpt3Name] = useState(\"\");\r\n\r\n  // option values (สำหรับโหมด generate ใหม่)\r\n  const [opt1Values, setOpt1Values] = useState([]);\r\n  const [opt2Values, setOpt2Values] = useState([]);\r\n  const [opt3Values, setOpt3Values] = useState([]);\r\n\r\n  // rows = รายการคอมโบที่กำลังแก้ไข (อาจเป็นของเดิม หรือที่ generate)\r\n  const [rows, setRows] = useState([]);\r\n\r\n  const [saving, setSaving] = useState(false);\r\n  const [msg, setMsg] = useState(\"\");\r\n\r\n  /* ---------- Load product (ชื่อ/โค้ด) ---------- */\r\n  const loadProduct = useCallback(async () => {\r\n    if (!productId) return;\r\n    let p = null;\r\n    try {\r\n      const r = await api.get(path(`/admin/products/${productId}`));\r\n      p = normalizeProduct(r?.data);\r\n    } catch {}\r\n    if (!p) {\r\n      try {\r\n        const r = await api.get(path(`/products/${productId}`));\r\n        p = normalizeProduct(r?.data);\r\n      } catch {}\r\n    }\r\n    if (!p) {\r\n      try {\r\n        const r = await api.get(path(`/admin/products`), { params: { include_archived: 1 } });\r\n        const arr = Array.isArray(r?.data?.items) ? r.data.items : (Array.isArray(r?.data) ? r.data : []);\r\n        p = (arr || []).find((x) => Number(x.product_id) === Number(productId)) || null;\r\n      } catch {}\r\n    }\r\n    setProduct(p || null);\r\n  }, [productId]);\r\n\r\n  /* ---------- Load variants เดิม (ทั้งหมดของสินค้านั้น) ---------- */\r\n  const loadVariants = useCallback(async () => {\r\n    if (!productId) return;\r\n    let arr = [];\r\n\r\n    // 🔎 ลองหลาย endpoint (ให้เหมือนใน ProductManagement)\r\n    const tryEndpoints = [\r\n      path(`/admin/products/${productId}/variants`),\r\n      path(`/products/${productId}/variants`),\r\n      path(`/api/variants/by-product/${productId}`),\r\n      path(`/api/variants?product_id=${productId}`)\r\n    ];\r\n\r\n    for (const url of tryEndpoints) {\r\n      try {\r\n        const r = await api.get(url, { headers: authHeader() });\r\n        const rows = r?.data?.items || r?.data?.rows || r?.data || [];\r\n        if (Array.isArray(rows) && rows.length) { arr = rows; break; }\r\n      } catch { /* ignore and try next */ }\r\n    }\r\n\r\n    if (arr?.length) {\r\n      const mapped = arr.map(toRowFromVariant).filter(Boolean);\r\n      setRows(mapped);\r\n\r\n      // เดาชื่อ option จากแถวแรก ถ้ามี\r\n      const first = mapped[0];\r\n      if (first) {\r\n        if (first.opt1_name) setOpt1Name(first.opt1_name);\r\n        if (first.opt2_name) setOpt2Name(first.opt2_name);\r\n        if (first.opt3_name) setOpt3Name(first.opt3_name);\r\n      }\r\n    } else {\r\n      // ถ้าไม่มี variant เดิม → เคลียร์ rows และรอให้ผู้ใช้สร้างคอมโบใหม่\r\n      setRows([]);\r\n    }\r\n  }, [productId]);\r\n\r\n  useEffect(() => { loadProduct(); loadVariants(); }, [loadProduct, loadVariants]);\r\n\r\n  const productName = useMemo(\r\n    () => pickStr(product?.product_name, product?.name, product?.title),\r\n    [product]\r\n  );\r\n  const productCode = useMemo(\r\n    () => pickStr(product?.product_code, product?.code, product ? `P${product?.product_id || \"\"}` : (productId ? `P${productId}` : \"\")),\r\n    [product, productId]\r\n  );\r\n\r\n  /* ---------- Rebuild combos when values change (เฉพาะโหมดสร้างใหม่) ---------- */\r\n  useEffect(() => {\r\n    // เฉพาะตอน \"ยังไม่มีแถวเดิม\" เท่านั้นถึงจะ build จาก chips\r\n    if (rows.length) return;\r\n    const v1 = opt1Values.length ? opt1Values : [null];\r\n    const v2 = opt2Values.length ? opt2Values : [null];\r\n    const v3 = opt3Values.length ? opt3Values : [null];\r\n    const combos = [];\r\n    for (const a of v1) for (const b of v2) for (const c of v3) {\r\n      combos.push({ opt1: a, opt2: b, opt3: c, price: \"\", sku: \"\", image: null });\r\n    }\r\n    setRows(combos);\r\n  }, [opt1Values, opt2Values, opt3Values]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  /* ---------- chip helpers ---------- */\r\n  const addTag = (list, setList, txt) => {\r\n    const v = String(txt || \"\").trim();\r\n    if (!v) return;\r\n    if (!list.some((x) => x === v)) setList([...list, v]);\r\n  };\r\n  const removeTag = (list, setList, idx) => setList(list.filter((_, i) => i !== idx));\r\n\r\n  /* ---------- per-row upload ---------- */\r\n  const onUploadRowImage = async (file, idx) => {\r\n    if (!file) return;\r\n\r\n    const tempUrl = URL.createObjectURL(file);\r\n    setRows((prev) => {\r\n      const a = [...prev];\r\n      a[idx] = { ...a[idx], image: tempUrl, __temp: true };\r\n      return a;\r\n    });\r\n\r\n    try {\r\n      const serverUrl = await tryUpload(file);\r\n      setRows((prev) => {\r\n        const a = [...prev];\r\n        a[idx] = { ...a[idx], image: serverUrl, __temp: false };\r\n        return a;\r\n      });\r\n    } catch (e) {\r\n      setRows((prev) => {\r\n        const a = [...prev];\r\n        a[idx] = { ...a[idx], image: null, __temp: false };\r\n        return a;\r\n      });\r\n      alert(e?.message || \"Upload failed\");\r\n    } finally {\r\n      setTimeout(() => URL.revokeObjectURL(tempUrl), 2500);\r\n    }\r\n  };\r\n\r\n  /* ---------- Auto SKU (ไม่แปลงภาษา) ---------- */\r\n  const autoSku = () => {\r\n    const base = productCode || (productId ? `P${productId}` : \"P\");\r\n    setRows((prev) =>\r\n      prev.map((r) => {\r\n        const parts = [base, r.opt1, r.opt2, r.opt3].filter(Boolean);\r\n        return { ...r, sku: parts.join(\"-\") + \"-\" + rand2() };\r\n      })\r\n    );\r\n  };\r\n\r\n  /* ---------- Save batch (พยายามหลาย endpoint เพื่อให้เข้ากับหลังบ้าน) ---------- */\r\n  const saveAll = async () => {\r\n    setSaving(true);\r\n    try {\r\n      // กรองเฉพาะแถวที่มีรายละเอียดอย่างน้อย 1 ช่อง หรือเป็นแถวเดิม\r\n      const effective = rows.filter((r) => r.opt1 || r.opt2 || r.opt3 || r.__existing);\r\n\r\n      const payloadRows = effective.map((r) => ({\r\n        variant_id: r.variant_id || null,\r\n        details: [\r\n          r.opt1 ? { name: opt1Name, value: r.opt1 } : null,\r\n          r.opt2 ? { name: opt2Name, value: r.opt2 } : null,\r\n          r.opt3 && (opt3Name || r.opt3) ? { name: opt3Name || \"ตัวเลือก 3\", value: r.opt3 } : null,\r\n        ].filter(Boolean),\r\n        sku: r.sku || null,\r\n        price: r.price !== \"\" ? Number(r.price) : null,\r\n        image_url: r.image || null,\r\n      }));\r\n\r\n      if (!payloadRows.length) {\r\n        alert(\"ยังไม่มีแถวที่มีรายละเอียดสำหรับบันทึก\");\r\n        setSaving(false);\r\n        return;\r\n      }\r\n\r\n      // 0) /api/variants/upsert-batch\r\n      let done = false;\r\n      try {\r\n        await api.post(\r\n          path(`/api/variants/upsert-batch`),\r\n          { product_id: productId, rows: payloadRows },\r\n          { headers: authHeader() }\r\n        );\r\n        done = true;\r\n      } catch {}\r\n\r\n      if (!done) {\r\n        // 1) PUT /variants (อัปเดตแบบ batch)\r\n        try {\r\n          await api.put(\r\n            path(`/admin/products/${productId}/variants`),\r\n            { rows: payloadRows },\r\n            { headers: authHeader() }\r\n          );\r\n          done = true;\r\n        } catch {}\r\n      }\r\n\r\n      if (!done) {\r\n        // 2) POST /variants/save (upsert)\r\n        try {\r\n          await api.post(\r\n            path(`/admin/products/${productId}/variants/save`),\r\n            { rows: payloadRows },\r\n            { headers: authHeader() }\r\n          );\r\n          done = true;\r\n        } catch {}\r\n      }\r\n\r\n      if (!done) {\r\n        // 3) POST /variants/generate (สร้างใหม่ทั้งหมด)\r\n        await api.post(\r\n          path(`/admin/products/${productId}/variants/generate`),\r\n          { rows: payloadRows },\r\n          { headers: authHeader() }\r\n        );\r\n      }\r\n\r\n      setMsg(\"✅ Saved\");\r\n      setTimeout(() => setMsg(\"\"), 1800);\r\n      // reload เพื่อให้แน่ใจว่า state ตรงกับ DB\r\n      await loadVariants();\r\n    } catch (e) {\r\n      console.error(e);\r\n      alert(e?.response?.data?.message || \"❌ Save failed\");\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  // ถ้ายังหา productId ไม่ได้ (เช่น path เป็น null) แจ้งให้ผู้ใช้กดกลับ\r\n  if (!productId) {\r\n    return (\r\n      <div className=\"vm-page\">\r\n        <div className=\"vm-header\">\r\n          <div className=\"vm-title\">\r\n            <div className=\"vm-product-name\">ไม่ทราบรหัสสินค้า</div>\r\n            <div className=\"vm-product-code\">—</div>\r\n          </div>\r\n          <Link to=\"/admin/products\" className=\"vm-back\">← กลับไปหน้าสินค้า</Link>\r\n        </div>\r\n        <div className=\"vm-hint\">\r\n          <p>URL นี้ไม่มีรหัสสินค้า (productId) กรุณากลับไปเลือกสินค้าอีกครั้ง</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"vm-page\">\r\n      {/* Header: โชว์ \"รหัสสินค้า + ชื่อสินค้า\" */}\r\n      <div className=\"vm-header\">\r\n        <div className=\"vm-title\">\r\n          <div className=\"vm-product-code\">{productCode || `P${productId}`}</div>\r\n          <div className=\"vm-product-name\">{productName || \"—\"}</div>\r\n        </div>\r\n        <Link to=\"/admin/products\" className=\"vm-back\">← กลับไปหน้าสินค้า</Link>\r\n      </div>\r\n\r\n      {msg && <div className=\"vm-msg\">{msg}</div>}\r\n\r\n      {/* Options (แสดงเสมอ — ใช้ตั้งชื่อหัวคอลัมน์ และใช้ generate เมื่อยังไม่มีแถวเดิม) */}\r\n      <div className=\"vm-options\">\r\n        {/* option 1 */}\r\n        <div className=\"vm-opt\">\r\n          <label>ตัวเลือกที่ 1</label>\r\n          <input value={opt1Name} onChange={(e) => setOpt1Name(e.target.value)} />\r\n          <div className=\"vm-chips\">\r\n            {opt1Values.map((v, i) => (\r\n              <span key={i} className=\"vm-chip\">\r\n                {v}\r\n                <button onClick={() => removeTag(opt1Values, setOpt1Values, i)}>×</button>\r\n              </span>\r\n            ))}\r\n            {!rows.length && (\r\n              <input\r\n                placeholder=\"พิมพ์แล้ว Enter\"\r\n                onKeyDown={(e) => {\r\n                  if (e.key === \"Enter\") {\r\n                    e.preventDefault();\r\n                    addTag(opt1Values, setOpt1Values, e.currentTarget.value);\r\n                    e.currentTarget.value = \"\";\r\n                  }\r\n                }}\r\n              />\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* option 2 */}\r\n        <div className=\"vm-opt\">\r\n          <label>ตัวเลือกที่ 2 (ถ้ามี)</label>\r\n          <input value={opt2Name} onChange={(e) => setOpt2Name(e.target.value)} />\r\n          <div className=\"vm-chips\">\r\n            {opt2Values.map((v, i) => (\r\n              <span key={i} className=\"vm-chip\">\r\n                {v}\r\n                <button onClick={() => removeTag(opt2Values, setOpt2Values, i)}>×</button>\r\n              </span>\r\n            ))}\r\n            {!rows.length && (\r\n              <input\r\n                placeholder=\"พิมพ์แล้ว Enter\"\r\n                onKeyDown={(e) => {\r\n                  if (e.key === \"Enter\") {\r\n                    e.preventDefault();\r\n                    addTag(opt2Values, setOpt2Values, e.currentTarget.value);\r\n                    e.currentTarget.value = \"\";\r\n                  }\r\n                }}\r\n              />\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* option 3 */}\r\n        <div className=\"vm-opt\">\r\n          <label>ตัวเลือกที่ 3 (ถ้ามี)</label>\r\n          <input\r\n            value={opt3Name}\r\n            onChange={(e) => setOpt3Name(e.target.value)}\r\n            placeholder=\"เช่น วัสดุ / รุ่น\"\r\n          />\r\n          <div className=\"vm-chips\">\r\n            {opt3Values.map((v, i) => (\r\n              <span key={i} className=\"vm-chip\">\r\n                {v}\r\n                <button onClick={() => removeTag(opt3Values, setOpt3Values, i)}>×</button>\r\n              </span>\r\n            ))}\r\n            {!rows.length && (\r\n              <input\r\n                placeholder=\"พิมพ์แล้ว Enter\"\r\n                onKeyDown={(e) => {\r\n                  if (e.key === \"Enter\") {\r\n                    e.preventDefault();\r\n                    addTag(opt3Values, setOpt3Values, e.currentTarget.value);\r\n                    e.currentTarget.value = \"\";\r\n                  }\r\n                }}\r\n              />\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Table */}\r\n      <div className=\"vm-table-wrap\">\r\n        <table className=\"vm-table\">\r\n          <thead>\r\n            <tr>\r\n              <th>รูปภาพ</th>\r\n              <th>{opt1Name || \"ตัวเลือก 1\"}</th>\r\n              <th>{opt2Name || \"ตัวเลือก 2\"}</th>\r\n              <th>{opt3Name || \"ตัวเลือก 3\"}</th>\r\n              <th>ราคา</th>\r\n              <th>SKU</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {rows.map((r, i) => (\r\n              <tr key={i}>\r\n                <td>\r\n                  {r.image ? (\r\n                    <img src={mediaSrc(r.image)} alt=\"\" className=\"vm-thumb\" />\r\n                  ) : (\r\n                    <label className=\"vm-upload\">\r\n                      +\r\n                      <input\r\n                        type=\"file\"\r\n                        accept=\"image/*\"\r\n                        onChange={(e) => onUploadRowImage(e.target.files?.[0], i)}\r\n                      />\r\n                    </label>\r\n                  )}\r\n                </td>\r\n                <td>{r.opt1 || \"-\"}</td>\r\n                <td>{r.opt2 || \"-\"}</td>\r\n                <td>{r.opt3 || \"-\"}</td>\r\n                <td>\r\n                  <input\r\n                    type=\"number\"\r\n                    min=\"0\"\r\n                    placeholder=\"ไม่ระบุ\"\r\n                    value={r.price}\r\n                    onChange={(e) => {\r\n                      const v = e.target.value;\r\n                      setRows((prev) => {\r\n                        const a = [...prev];\r\n                        a[i] = { ...a[i], price: v };\r\n                        return a;\r\n                      });\r\n                    }}\r\n                  />\r\n                </td>\r\n                <td>\r\n                  <input\r\n                    placeholder=\"SKU\"\r\n                    value={r.sku}\r\n                    onChange={(e) => {\r\n                      const v = e.target.value;\r\n                      setRows((prev) => {\r\n                        const a = [...prev];\r\n                        a[i] = { ...a[i], sku: v };\r\n                        return a;\r\n                      });\r\n                    }}\r\n                  />\r\n                </td>\r\n              </tr>\r\n            ))}\r\n            {!rows.length && (\r\n              <tr>\r\n                <td colSpan={6} style={{ textAlign: \"center\", padding: \"16px\" }}>\r\n                  ยังไม่มีตัวเลือกของสินค้านี้ — เพิ่มค่าในช่องด้านบนเพื่อสร้างคอมโบ แล้วกดบันทึก\r\n                </td>\r\n              </tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      {/* Actions */}\r\n      <div className=\"vm-actions\">\r\n        <button className=\"btn\" onClick={autoSku} disabled={saving}>\r\n          เติม SKU อัตโนมัติ\r\n        </button>\r\n        <button className=\"btn-primary\" onClick={saveAll} disabled={saving}>\r\n          {saving ? \"กำลังบันทึก…\" : \"บันทึกทั้งหมด\"}\r\n        </button>\r\n      </div>\r\n\r\n      {/* Notes */}\r\n      <div className=\"vm-hint\">\r\n        <p>• ถ้ามี SKU เดิม ระบบจะโหลดมาให้แก้ไขได้ทันที</p>\r\n        <p>• ถ้าไม่มี SKU เดิม ให้เพิ่มค่าตัวเลือกด้านบน แล้วค่อยกดบันทึก</p>\r\n        <p>• สต็อกจะอิงจากคลังจริง (ไม่ต้องกรอกที่นี่)</p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}