{"ast":null,"code":"var _jsxFileName = \"D:\\\\project19\\\\frontend\\\\src\\\\index.js\";\n// src/index.js\nimport React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport axios from 'axios';\n\n/* ============================================================\n   1) GLOBAL AXIOS CONFIG\n   - กำหนด baseURL, timeout, token เริ่มต้น และตัวดัก request/response\n   - หมายเหตุ: กำหนด baseURL เป็น \"โฮสต์\" อย่างเดียว (ไม่มี /api)\n     เพื่อเลี่ยงอาการซ้อนเป็น /api/api ตอนที่เราเรียก path ที่ขึ้นต้นด้วย /api เอง\n   ============================================================ */\n\n// ✅ CRA ต้องใช้ตัวแปร env ที่ขึ้นต้นด้วย REACT_APP_\n//    ถ้าไม่ได้ตั้งค่าไว้ จะ fallback เป็น 'http://localhost:3001'\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_BASE = process.env.REACT_APP_API_BASE || 'http://localhost:3001';\n\n// ใช้ flag dev เพื่อเปิด log สวยๆ เวลา request/response\nconst IS_DEV = process.env.NODE_ENV !== 'production';\n\n// ✅ ตั้ง baseURL ให้ axios (ตัด / ท้าย กัน // ซ้อน)\naxios.defaults.baseURL = API_BASE.replace(/\\/+$/, '');\n\n// ตั้ง timeout กันรีเควสต์ค้างเกิน 10 วิ\naxios.defaults.timeout = 10000;\n\n// แนบ token เริ่มต้นตั้งแต่โหลดหน้า (กันเคสรีเควสต์แรกวิ่งก่อน interceptor)\nconst bootToken = localStorage.getItem('token');\nif (bootToken) {\n  axios.defaults.headers.common['Authorization'] = `Bearer ${bootToken}`;\n}\n\n/* ---------- helper: ใช้แสดง URL ที่ยิงจริง เวลา log ---------- */\nfunction buildUrl(cfg) {\n  try {\n    const b = (cfg.baseURL || '').replace(/\\/+$/, '');\n    const u = cfg.url || '';\n    // ถ้าเป็น absolute URL (เช่น http://...) ให้แสดง u ตรงๆ\n    if (/^https?:\\/\\//i.test(u)) return u;\n    // ถ้าเป็น relative (เช่น /api/...) ให้เติม baseURL เข้าไป\n    return b + (u.startsWith('/') ? u : `/${u}`);\n  } catch {\n    return (cfg === null || cfg === void 0 ? void 0 : cfg.url) || '';\n  }\n}\n\n/* ---------- Request Interceptor ----------\n   - แนบ token ทุกครั้ง (อ่านจาก localStorage สดๆ)\n   - เก็บเวลาเริ่ม (ไว้คำนวณ duration)\n   - log method/URL/params/data เฉพาะตอน dev\n------------------------------------------ */\naxios.interceptors.request.use(cfg => {\n  const t = localStorage.getItem('token');\n  if (t) cfg.headers.Authorization = `Bearer ${t}`;\n\n  // เก็บเวลาเริ่มเพื่อคำนวณ ms ตอนตอบกลับ\n  cfg.metadata = {\n    start: Date.now()\n  };\n  if (IS_DEV) {\n    // eslint-disable-next-line no-console\n    console.log('➡️', (cfg.method || 'GET').toUpperCase(), buildUrl(cfg), cfg.params ? {\n      params: cfg.params\n    } : '', cfg.data && !(cfg.data instanceof FormData) ? {\n      data: cfg.data\n    } : '');\n  }\n  return cfg;\n});\n\n/* ---------- Response Interceptor ----------\n   - log สถานะ/URL/เวลา (ms) ตอนสำเร็จ\n   - log ข้อผิดพลาดชัดๆ ตอนล้มเหลว\n   - ถ้า 401 ให้เคลียร์ token (กัน token หมดอายุ)\n------------------------------------------- */\naxios.interceptors.response.use(res => {\n  if (IS_DEV) {\n    var _res$config$metadata;\n    const ms = Date.now() - (((_res$config$metadata = res.config.metadata) === null || _res$config$metadata === void 0 ? void 0 : _res$config$metadata.start) || Date.now());\n    // eslint-disable-next-line no-console\n    console.log('✅', res.status, (res.config.method || 'GET').toUpperCase(), buildUrl(res.config), `${ms}ms`);\n  }\n  return res;\n}, err => {\n  const {\n    response,\n    config\n  } = err;\n  if (IS_DEV && config) {\n    var _config$metadata;\n    const ms = Date.now() - (((_config$metadata = config.metadata) === null || _config$metadata === void 0 ? void 0 : _config$metadata.start) || Date.now());\n    // eslint-disable-next-line no-console\n    console.warn('❌', (response === null || response === void 0 ? void 0 : response.status) || 'NETWORK', (config.method || 'GET').toUpperCase(), buildUrl(config), `${ms}ms`, err.message);\n  }\n  // 401 = สิทธิ์ไม่ผ่าน → ล้าง token ทิ้ง\n  if ((response === null || response === void 0 ? void 0 : response.status) === 401) {\n    localStorage.removeItem('token');\n    // ถ้าอยากเด้งไปหน้า login อัตโนมัติ เปิดบรรทัดล่างนี้\n    // window.location.assign('/login');\n  }\n  return Promise.reject(err);\n});\n\n/* ============================================================\n   2) REACT MOUNT\n   - สร้าง root และ render <App />\n   ============================================================ */\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(/*#__PURE__*/_jsxDEV(React.StrictMode, {\n  children: /*#__PURE__*/_jsxDEV(App, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 125,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 124,\n  columnNumber: 3\n}, this));\nreportWebVitals();","map":{"version":3,"names":["React","ReactDOM","App","reportWebVitals","axios","jsxDEV","_jsxDEV","API_BASE","process","env","REACT_APP_API_BASE","IS_DEV","NODE_ENV","defaults","baseURL","replace","timeout","bootToken","localStorage","getItem","headers","common","buildUrl","cfg","b","u","url","test","startsWith","interceptors","request","use","t","Authorization","metadata","start","Date","now","console","log","method","toUpperCase","params","data","FormData","response","res","_res$config$metadata","ms","config","status","err","_config$metadata","warn","message","removeItem","Promise","reject","root","createRoot","document","getElementById","render","StrictMode","children","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["D:/project19/frontend/src/index.js"],"sourcesContent":["// src/index.js\nimport React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport axios from 'axios';\n\n/* ============================================================\n   1) GLOBAL AXIOS CONFIG\n   - กำหนด baseURL, timeout, token เริ่มต้น และตัวดัก request/response\n   - หมายเหตุ: กำหนด baseURL เป็น \"โฮสต์\" อย่างเดียว (ไม่มี /api)\n     เพื่อเลี่ยงอาการซ้อนเป็น /api/api ตอนที่เราเรียก path ที่ขึ้นต้นด้วย /api เอง\n   ============================================================ */\n\n// ✅ CRA ต้องใช้ตัวแปร env ที่ขึ้นต้นด้วย REACT_APP_\n//    ถ้าไม่ได้ตั้งค่าไว้ จะ fallback เป็น 'http://localhost:3001'\nconst API_BASE = process.env.REACT_APP_API_BASE || 'http://localhost:3001';\n\n// ใช้ flag dev เพื่อเปิด log สวยๆ เวลา request/response\nconst IS_DEV = process.env.NODE_ENV !== 'production';\n\n// ✅ ตั้ง baseURL ให้ axios (ตัด / ท้าย กัน // ซ้อน)\naxios.defaults.baseURL = API_BASE.replace(/\\/+$/, '');\n\n// ตั้ง timeout กันรีเควสต์ค้างเกิน 10 วิ\naxios.defaults.timeout = 10000;\n\n// แนบ token เริ่มต้นตั้งแต่โหลดหน้า (กันเคสรีเควสต์แรกวิ่งก่อน interceptor)\nconst bootToken = localStorage.getItem('token');\nif (bootToken) {\n  axios.defaults.headers.common['Authorization'] = `Bearer ${bootToken}`;\n}\n\n/* ---------- helper: ใช้แสดง URL ที่ยิงจริง เวลา log ---------- */\nfunction buildUrl(cfg) {\n  try {\n    const b = (cfg.baseURL || '').replace(/\\/+$/, '');\n    const u = (cfg.url || '');\n    // ถ้าเป็น absolute URL (เช่น http://...) ให้แสดง u ตรงๆ\n    if (/^https?:\\/\\//i.test(u)) return u;\n    // ถ้าเป็น relative (เช่น /api/...) ให้เติม baseURL เข้าไป\n    return b + (u.startsWith('/') ? u : `/${u}`);\n  } catch {\n    return cfg?.url || '';\n  }\n}\n\n/* ---------- Request Interceptor ----------\n   - แนบ token ทุกครั้ง (อ่านจาก localStorage สดๆ)\n   - เก็บเวลาเริ่ม (ไว้คำนวณ duration)\n   - log method/URL/params/data เฉพาะตอน dev\n------------------------------------------ */\naxios.interceptors.request.use((cfg) => {\n  const t = localStorage.getItem('token');\n  if (t) cfg.headers.Authorization = `Bearer ${t}`;\n\n  // เก็บเวลาเริ่มเพื่อคำนวณ ms ตอนตอบกลับ\n  cfg.metadata = { start: Date.now() };\n\n  if (IS_DEV) {\n    // eslint-disable-next-line no-console\n    console.log(\n      '➡️',\n      (cfg.method || 'GET').toUpperCase(),\n      buildUrl(cfg),\n      cfg.params ? { params: cfg.params } : '',\n      cfg.data && !(cfg.data instanceof FormData) ? { data: cfg.data } : ''\n    );\n  }\n  return cfg;\n});\n\n/* ---------- Response Interceptor ----------\n   - log สถานะ/URL/เวลา (ms) ตอนสำเร็จ\n   - log ข้อผิดพลาดชัดๆ ตอนล้มเหลว\n   - ถ้า 401 ให้เคลียร์ token (กัน token หมดอายุ)\n------------------------------------------- */\naxios.interceptors.response.use(\n  (res) => {\n    if (IS_DEV) {\n      const ms = Date.now() - (res.config.metadata?.start || Date.now());\n      // eslint-disable-next-line no-console\n      console.log(\n        '✅',\n        res.status,\n        (res.config.method || 'GET').toUpperCase(),\n        buildUrl(res.config),\n        `${ms}ms`\n      );\n    }\n    return res;\n  },\n  (err) => {\n    const { response, config } = err;\n    if (IS_DEV && config) {\n      const ms = Date.now() - (config.metadata?.start || Date.now());\n      // eslint-disable-next-line no-console\n      console.warn(\n        '❌',\n        response?.status || 'NETWORK',\n        (config.method || 'GET').toUpperCase(),\n        buildUrl(config),\n        `${ms}ms`,\n        err.message\n      );\n    }\n    // 401 = สิทธิ์ไม่ผ่าน → ล้าง token ทิ้ง\n    if (response?.status === 401) {\n      localStorage.removeItem('token');\n      // ถ้าอยากเด้งไปหน้า login อัตโนมัติ เปิดบรรทัดล่างนี้\n      // window.location.assign('/login');\n    }\n    return Promise.reject(err);\n  }\n);\n\n/* ============================================================\n   2) REACT MOUNT\n   - สร้าง root และ render <App />\n   ============================================================ */\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n);\n\nreportWebVitals();\n\n\n\n\n\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}