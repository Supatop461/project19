{"ast":null,"code":"// src/lib/cart.js\nconst KEY = 'cart';\nexport function getCart() {\n  try {\n    return JSON.parse(localStorage.getItem(KEY) || '[]');\n  } catch {\n    return [];\n  }\n}\nexport function setCart(arr) {\n  localStorage.setItem(KEY, JSON.stringify(arr || []));\n  // แจ้งทุกหน้าให้รู้ว่าตะกร้าเปลี่ยน (เช่น Header แสดง badge ใหม่)\n  window.dispatchEvent(new Event('cart:changed'));\n}\nexport function addItem(item, qty = 1) {\n  const cart = getCart();\n  const idx = cart.findIndex(x => String(x.id) === String(item.id));\n  if (idx > -1) {\n    cart[idx].quantity = (cart[idx].quantity || 1) + qty;\n  } else {\n    cart.push({\n      ...item,\n      quantity: qty\n    });\n  }\n  setCart(cart);\n}\nexport function updateQty(id, qty) {\n  const cart = getCart().map(x => String(x.id) === String(id) ? {\n    ...x,\n    quantity: Math.max(1, qty | 0)\n  } : x);\n  setCart(cart);\n}\nexport function removeItem(id) {\n  setCart(getCart().filter(x => String(x.id) !== String(id)));\n}\nexport function clearCart() {\n  setCart([]);\n}\nexport function getCount() {\n  return getCart().reduce((s, x) => s + (x.quantity || 1), 0);\n}\nexport function getTotal() {\n  return getCart().reduce((s, x) => s + (Number(x.price) || 0) * (x.quantity || 1), 0);\n}","map":{"version":3,"names":["KEY","getCart","JSON","parse","localStorage","getItem","setCart","arr","setItem","stringify","window","dispatchEvent","Event","addItem","item","qty","cart","idx","findIndex","x","String","id","quantity","push","updateQty","map","Math","max","removeItem","filter","clearCart","getCount","reduce","s","getTotal","Number","price"],"sources":["D:/project19/frontend/src/lib/cart.js"],"sourcesContent":["// src/lib/cart.js\r\nconst KEY = 'cart';\r\n\r\nexport function getCart() {\r\n  try { return JSON.parse(localStorage.getItem(KEY) || '[]'); }\r\n  catch { return []; }\r\n}\r\n\r\nexport function setCart(arr) {\r\n  localStorage.setItem(KEY, JSON.stringify(arr || []));\r\n  // แจ้งทุกหน้าให้รู้ว่าตะกร้าเปลี่ยน (เช่น Header แสดง badge ใหม่)\r\n  window.dispatchEvent(new Event('cart:changed'));\r\n}\r\n\r\nexport function addItem(item, qty = 1) {\r\n  const cart = getCart();\r\n  const idx = cart.findIndex(x => String(x.id) === String(item.id));\r\n  if (idx > -1) {\r\n    cart[idx].quantity = (cart[idx].quantity || 1) + qty;\r\n  } else {\r\n    cart.push({ ...item, quantity: qty });\r\n  }\r\n  setCart(cart);\r\n}\r\n\r\nexport function updateQty(id, qty) {\r\n  const cart = getCart().map(x =>\r\n    String(x.id) === String(id) ? { ...x, quantity: Math.max(1, qty|0) } : x\r\n  );\r\n  setCart(cart);\r\n}\r\n\r\nexport function removeItem(id) {\r\n  setCart(getCart().filter(x => String(x.id) !== String(id)));\r\n}\r\n\r\nexport function clearCart() { setCart([]); }\r\n\r\nexport function getCount() {\r\n  return getCart().reduce((s, x) => s + (x.quantity || 1), 0);\r\n}\r\n\r\nexport function getTotal() {\r\n  return getCart().reduce((s, x) => s + (Number(x.price)||0) * (x.quantity||1), 0);\r\n}\r\n"],"mappings":"AAAA;AACA,MAAMA,GAAG,GAAG,MAAM;AAElB,OAAO,SAASC,OAAOA,CAAA,EAAG;EACxB,IAAI;IAAE,OAAOC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAACL,GAAG,CAAC,IAAI,IAAI,CAAC;EAAE,CAAC,CAC7D,MAAM;IAAE,OAAO,EAAE;EAAE;AACrB;AAEA,OAAO,SAASM,OAAOA,CAACC,GAAG,EAAE;EAC3BH,YAAY,CAACI,OAAO,CAACR,GAAG,EAAEE,IAAI,CAACO,SAAS,CAACF,GAAG,IAAI,EAAE,CAAC,CAAC;EACpD;EACAG,MAAM,CAACC,aAAa,CAAC,IAAIC,KAAK,CAAC,cAAc,CAAC,CAAC;AACjD;AAEA,OAAO,SAASC,OAAOA,CAACC,IAAI,EAAEC,GAAG,GAAG,CAAC,EAAE;EACrC,MAAMC,IAAI,GAAGf,OAAO,CAAC,CAAC;EACtB,MAAMgB,GAAG,GAAGD,IAAI,CAACE,SAAS,CAACC,CAAC,IAAIC,MAAM,CAACD,CAAC,CAACE,EAAE,CAAC,KAAKD,MAAM,CAACN,IAAI,CAACO,EAAE,CAAC,CAAC;EACjE,IAAIJ,GAAG,GAAG,CAAC,CAAC,EAAE;IACZD,IAAI,CAACC,GAAG,CAAC,CAACK,QAAQ,GAAG,CAACN,IAAI,CAACC,GAAG,CAAC,CAACK,QAAQ,IAAI,CAAC,IAAIP,GAAG;EACtD,CAAC,MAAM;IACLC,IAAI,CAACO,IAAI,CAAC;MAAE,GAAGT,IAAI;MAAEQ,QAAQ,EAAEP;IAAI,CAAC,CAAC;EACvC;EACAT,OAAO,CAACU,IAAI,CAAC;AACf;AAEA,OAAO,SAASQ,SAASA,CAACH,EAAE,EAAEN,GAAG,EAAE;EACjC,MAAMC,IAAI,GAAGf,OAAO,CAAC,CAAC,CAACwB,GAAG,CAACN,CAAC,IAC1BC,MAAM,CAACD,CAAC,CAACE,EAAE,CAAC,KAAKD,MAAM,CAACC,EAAE,CAAC,GAAG;IAAE,GAAGF,CAAC;IAAEG,QAAQ,EAAEI,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEZ,GAAG,GAAC,CAAC;EAAE,CAAC,GAAGI,CACzE,CAAC;EACDb,OAAO,CAACU,IAAI,CAAC;AACf;AAEA,OAAO,SAASY,UAAUA,CAACP,EAAE,EAAE;EAC7Bf,OAAO,CAACL,OAAO,CAAC,CAAC,CAAC4B,MAAM,CAACV,CAAC,IAAIC,MAAM,CAACD,CAAC,CAACE,EAAE,CAAC,KAAKD,MAAM,CAACC,EAAE,CAAC,CAAC,CAAC;AAC7D;AAEA,OAAO,SAASS,SAASA,CAAA,EAAG;EAAExB,OAAO,CAAC,EAAE,CAAC;AAAE;AAE3C,OAAO,SAASyB,QAAQA,CAAA,EAAG;EACzB,OAAO9B,OAAO,CAAC,CAAC,CAAC+B,MAAM,CAAC,CAACC,CAAC,EAAEd,CAAC,KAAKc,CAAC,IAAId,CAAC,CAACG,QAAQ,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;AAC7D;AAEA,OAAO,SAASY,QAAQA,CAAA,EAAG;EACzB,OAAOjC,OAAO,CAAC,CAAC,CAAC+B,MAAM,CAAC,CAACC,CAAC,EAAEd,CAAC,KAAKc,CAAC,GAAG,CAACE,MAAM,CAAChB,CAAC,CAACiB,KAAK,CAAC,IAAE,CAAC,KAAKjB,CAAC,CAACG,QAAQ,IAAE,CAAC,CAAC,EAAE,CAAC,CAAC;AAClF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}