{"ast":null,"code":"var _jsxFileName = \"D:\\\\project19\\\\frontend\\\\src\\\\admin\\\\VariantsManager.js\",\n  _s = $RefreshSig$();\n// src/admin/VariantsManager.js\n// ======================================================================\n// VariantsManager (DB-aware, resilient) — โหลดข้อมูลครบแม้ไม่มี compat endpoints\n// - ใช้ /api/variants/product/:id เป็นแหล่งหลัก (อ่าน combo เพื่อถอด mapping option/value ได้)\n// - ใช้ /api/variants/products/:id/options เป็นแหล่งหลักของ options + values (flatten เป็น value list ให้เอง)\n// - ถ้า endpoint เก่า ๆ 404 ก็ยังแสดงครบและบันทึกได้\n// ======================================================================\n\nimport React, { useEffect, useMemo, useState, useCallback } from \"react\";\nimport { useParams, Link } from \"react-router-dom\";\nimport { api, path, mediaSrc } from \"../lib/api\";\nimport \"./VariantsManager.css\";\n\n/* ---------- Helpers ---------- */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst authHeader = () => {\n  const t = localStorage.getItem(\"token\");\n  return t ? {\n    Authorization: `Bearer ${t}`\n  } : {};\n};\nconst byKey = (a, b) => a < b ? -1 : a > b ? 1 : 0;\nconst uniq = arr => Array.from(new Set(arr.filter(x => x !== null && x !== undefined && String(x).trim() !== \"\"))).sort(byKey);\nconst pickStr = (...xs) => {\n  var _xs$find;\n  return ((_xs$find = xs.find(v => typeof v === \"string\" && v.trim())) === null || _xs$find === void 0 ? void 0 : _xs$find.trim()) || \"\";\n};\nconst rand2 = () => String(Math.floor(Math.random() * 99) + 1).padStart(2, \"0\");\nconst keyOf = r => [r.opt1 || \"\", r.opt2 || \"\", r.opt3 || \"\"].join(\"␟\");\n\n/* ---------- Upload ---------- */\nconst extractUrl = data => {\n  var _data$file, _data$file2, _data$data, _data$data2, _data$data3;\n  if (!data) return null;\n  if (typeof data === \"string\") return data;\n  const direct = data.url || data.path || data.imageUrl || data.Location || data.location || ((_data$file = data.file) === null || _data$file === void 0 ? void 0 : _data$file.url) || ((_data$file2 = data.file) === null || _data$file2 === void 0 ? void 0 : _data$file2.path) || ((_data$data = data.data) === null || _data$data === void 0 ? void 0 : _data$data.url) || ((_data$data2 = data.data) === null || _data$data2 === void 0 ? void 0 : _data$data2.path) || ((_data$data3 = data.data) === null || _data$data3 === void 0 ? void 0 : _data$data3.imageUrl);\n  if (direct) return direct;\n  try {\n    const flat = JSON.stringify(data);\n    const m = flat.match(/\"([^\"]+\\.(?:png|jpe?g|webp|gif))\"/i);\n    return m ? m[1] : null;\n  } catch {\n    return null;\n  }\n};\nconst tryUpload = async file => {\n  const fd = new FormData();\n  fd.append(\"file\", file);\n  const res = await api.post(path(\"/upload\"), fd, {\n    headers: {\n      ...authHeader(),\n      \"Content-Type\": \"multipart/form-data\"\n    }\n  });\n  const url = extractUrl(res === null || res === void 0 ? void 0 : res.data);\n  if (!url) throw new Error(\"UPLOAD_OK_BUT_NO_URL\");\n  return url;\n};\n\n/* ---------- Normalize product ---------- */\nconst normalizeProduct = raw => {\n  if (!raw) return null;\n  const d = raw.data || raw.item || raw.product || raw.result || raw;\n  return d || null;\n};\n\n/* ---------- Option + value helpers ---------- */\nconst normOptionRows = rows => {\n  const out = [];\n  for (const r of rows || []) {\n    var _ref, _r$option_id;\n    const id = (_ref = (_r$option_id = r.option_id) !== null && _r$option_id !== void 0 ? _r$option_id : r.id) !== null && _ref !== void 0 ? _ref : r.opt_id;\n    const name = pickStr(r.option_name, r.name, r.label);\n    if (id != null) out.push({\n      option_id: Number(id),\n      option_name: name || \"\",\n      values: Array.isArray(r.values) ? r.values : []\n    });\n  }\n  return out;\n};\nconst normValueRows = rows => {\n  const out = [];\n  for (const r of rows || []) {\n    var _r$value_id, _r$option_id2;\n    const id = (_r$value_id = r.value_id) !== null && _r$value_id !== void 0 ? _r$value_id : r.id;\n    const optionId = (_r$option_id2 = r.option_id) !== null && _r$option_id2 !== void 0 ? _r$option_id2 : r.opt_id;\n    const name = pickStr(r.value_name, r.name, r.label, r.value);\n    if (id != null) out.push({\n      value_id: Number(id),\n      option_id: Number(optionId !== null && optionId !== void 0 ? optionId : 0),\n      value_name: name || \"\"\n    });\n  }\n  return out;\n};\nconst normVariantValues = rows => {\n  const out = [];\n  for (const r of rows || []) {\n    var _ref2, _r$variant_id, _r$option_id3, _ref3, _r$value_id2;\n    const vid = (_ref2 = (_r$variant_id = r.variant_id) !== null && _r$variant_id !== void 0 ? _r$variant_id : r.product_variant_id) !== null && _ref2 !== void 0 ? _ref2 : r.id;\n    const oid = (_r$option_id3 = r.option_id) !== null && _r$option_id3 !== void 0 ? _r$option_id3 : r.opt_id;\n    const val = (_ref3 = (_r$value_id2 = r.value_id) !== null && _r$value_id2 !== void 0 ? _r$value_id2 : r.val_id) !== null && _ref3 !== void 0 ? _ref3 : r.value;\n    if (vid != null && oid != null) out.push({\n      variant_id: Number(vid),\n      option_id: Number(oid),\n      value_id: val != null ? Number(val) : null\n    });\n  }\n  return out;\n};\n\n/* ---------- Parse helpers ---------- */\nfunction parseFromOptionText(optionText) {\n  const res = {\n    names: [\"\", \"\", \"\"],\n    values: [\"\", \"\", \"\"]\n  };\n  const s = String(optionText || \"\").trim();\n  if (!s) return res;\n  const parts = s.split(\"|\").map(x => x.trim()).filter(Boolean);\n  for (let i = 0; i < Math.min(3, parts.length); i++) {\n    const p = parts[i];\n    const j = p.indexOf(\":\");\n    if (j >= 0) {\n      res.names[i] = p.slice(0, j).trim();\n      res.values[i] = p.slice(j + 1).trim();\n    } else {\n      res.values[i] = p;\n    }\n  }\n  return res;\n}\nconst firstNonEmpty = (...xs) => {\n  var _xs$find2;\n  return ((_xs$find2 = xs.find(x => x !== undefined && x !== null && String(x).trim())) === null || _xs$find2 === void 0 ? void 0 : _xs$find2.toString().trim()) || \"\";\n};\n\n/* ---------- Variant normalize (base) ---------- */\nconst normVariantBase = v => {\n  var _ref4, _ref5, _ref6, _ref7, _v$final_price, _ref8, _ref9, _v$stock, _ref0, _ref1, _v$variant_id;\n  if (!v) return null;\n  const priceRaw = (_ref4 = (_ref5 = (_ref6 = (_ref7 = (_v$final_price = v.final_price) !== null && _v$final_price !== void 0 ? _v$final_price : v.price) !== null && _ref7 !== void 0 ? _ref7 : v.unit_price) !== null && _ref6 !== void 0 ? _ref6 : v.sale_price) !== null && _ref5 !== void 0 ? _ref5 : v.price_override) !== null && _ref4 !== void 0 ? _ref4 : \"\";\n  const stockRaw = (_ref8 = (_ref9 = (_v$stock = v.stock) !== null && _v$stock !== void 0 ? _v$stock : v.stock_qty) !== null && _ref9 !== void 0 ? _ref9 : v.quantity) !== null && _ref8 !== void 0 ? _ref8 : 0;\n  const sku = firstNonEmpty(v.sku, v.SKU, v.code);\n  const image = firstNonEmpty(v.image_url, v.image, v.imageUrl, v.variant_image);\n  return {\n    variant_id: (_ref0 = (_ref1 = (_v$variant_id = v.variant_id) !== null && _v$variant_id !== void 0 ? _v$variant_id : v.id) !== null && _ref1 !== void 0 ? _ref1 : v.product_variant_id) !== null && _ref0 !== void 0 ? _ref0 : null,\n    sku,\n    price: typeof priceRaw === \"number\" ? String(priceRaw) : String(priceRaw || \"\"),\n    stock: Number(stockRaw) || 0,\n    image: image || null,\n    option_text: firstNonEmpty(v.option_text, v.options_text, \"\"),\n    combo: Array.isArray(v.combo) ? v.combo : [],\n    // keep for fallback\n    opt1_name: firstNonEmpty(v.opt1_name, v.option1_name, v.name1, v.option1, \"\"),\n    opt2_name: firstNonEmpty(v.opt2_name, v.option2_name, v.name2, v.option2, \"\"),\n    opt3_name: firstNonEmpty(v.opt3_name, v.option3_name, v.name3, v.option3, \"\"),\n    opt1: firstNonEmpty(v.option1_value, v.opt1, v.value1, v.color, \"\"),\n    opt2: firstNonEmpty(v.option2_value, v.opt2, v.value2, v.size, \"\"),\n    opt3: firstNonEmpty(v.option3_value, v.opt3, v.value3, v.material, \"\")\n  };\n};\n\n/* ====================================================================== */\nexport default function VariantsManager() {\n  _s();\n  const {\n    id,\n    productId: pid\n  } = useParams();\n  const productId = Number(id || pid);\n  const [product, setProduct] = useState(null);\n\n  // ชื่อหัวคอลัมน์\n  const [opt1Name, setOpt1Name] = useState(\"ตัวเลือก 1\");\n  const [opt2Name, setOpt2Name] = useState(\"ตัวเลือก 2\");\n  const [opt3Name, setOpt3Name] = useState(\"ตัวเลือก 3\");\n\n  // chips\n  const [opt1Values, setOpt1Values] = useState([]);\n  const [opt2Values, setOpt2Values] = useState([]);\n  const [opt3Values, setOpt3Values] = useState([]);\n\n  // แถว\n  const [rows, setRows] = useState([]);\n  const [deletedIds, setDeletedIds] = useState([]);\n  const [saving, setSaving] = useState(false);\n  const [msg, setMsg] = useState(\"\");\n\n  /* ---------- Load product ---------- */\n  const loadProduct = useCallback(async () => {\n    if (!productId) return;\n    let p = null;\n    try {\n      const r = await api.get(path(`/admin/products/${productId}`));\n      p = normalizeProduct(r === null || r === void 0 ? void 0 : r.data);\n    } catch {}\n    if (!p) {\n      try {\n        const r = await api.get(path(`/products/${productId}`));\n        p = normalizeProduct(r === null || r === void 0 ? void 0 : r.data);\n      } catch {}\n    }\n    setProduct(p || null);\n  }, [productId]);\n\n  /* ---------- Load variants + options/values ---------- */\n  const loadAll = useCallback(async () => {\n    if (!productId) return;\n\n    // 1) โหลด variants พื้นฐาน\n    let variants = [];\n    let variantsRaw = [];\n    const endpoints = [path(`/api/variants/product/${productId}?active=0`), path(`/api/variants/by-product/${productId}`), path(`/api/variants?product_id=${productId}`), path(`/admin/products/${productId}/variants`), path(`/products/${productId}/variants`)];\n    for (const url of endpoints) {\n      try {\n        var _r$data, _r$data2;\n        const r = await api.get(url, {\n          headers: authHeader()\n        });\n        const arr = (r === null || r === void 0 ? void 0 : (_r$data = r.data) === null || _r$data === void 0 ? void 0 : _r$data.items) || (r === null || r === void 0 ? void 0 : (_r$data2 = r.data) === null || _r$data2 === void 0 ? void 0 : _r$data2.rows) || (r === null || r === void 0 ? void 0 : r.data) || [];\n        if (Array.isArray(arr) && arr.length) {\n          variantsRaw = arr;\n          variants = arr.map(normVariantBase);\n          break;\n        }\n      } catch {}\n    }\n\n    // 2) โหลด product_options (+ values)\n    let optionsList = [];\n    let optionsRaw = [];\n    const optionEndpoints = [path(`/api/variants/products/${productId}/options`), path(`/admin/products/${productId}/options`), path(`/products/${productId}/options`), path(`/api/products/${productId}/options`), path(`/api/product_options?product_id=${productId}`)];\n    for (const url of optionEndpoints) {\n      try {\n        var _r$data3, _r$data4;\n        const r = await api.get(url, {\n          headers: authHeader()\n        });\n        const arr = (r === null || r === void 0 ? void 0 : (_r$data3 = r.data) === null || _r$data3 === void 0 ? void 0 : _r$data3.items) || (r === null || r === void 0 ? void 0 : (_r$data4 = r.data) === null || _r$data4 === void 0 ? void 0 : _r$data4.rows) || (r === null || r === void 0 ? void 0 : r.data) || [];\n        if (Array.isArray(arr) && arr.length) {\n          optionsRaw = arr;\n          optionsList = normOptionRows(arr);\n          break;\n        }\n      } catch {}\n    }\n    const optionNameById = new Map(optionsList.map(o => [o.option_id, o.option_name]));\n\n    // 3) โหลด option_values (flatten from options หาก endpoint ตรงไม่มี)\n    let optionValues = [];\n    const valueEndpoints = [path(`/api/variants/products/${productId}/option-values`), path(`/api/product_option_values?product_id=${productId}`), path(`/admin/products/${productId}/option-values`), path(`/products/${productId}/option-values`)];\n    for (const url of valueEndpoints) {\n      try {\n        var _r$data5, _r$data6;\n        const r = await api.get(url, {\n          headers: authHeader()\n        });\n        const arr = (r === null || r === void 0 ? void 0 : (_r$data5 = r.data) === null || _r$data5 === void 0 ? void 0 : _r$data5.items) || (r === null || r === void 0 ? void 0 : (_r$data6 = r.data) === null || _r$data6 === void 0 ? void 0 : _r$data6.rows) || (r === null || r === void 0 ? void 0 : r.data) || [];\n        if (Array.isArray(arr) && arr.length) {\n          optionValues = normValueRows(arr);\n          break;\n        }\n      } catch {}\n    }\n    if (!optionValues.length && Array.isArray(optionsRaw) && optionsRaw.length) {\n      // flatten from optionsRaw.values\n      const flat = [];\n      for (const o of optionsRaw) {\n        var _ref10, _o$option_id;\n        const option_id = (_ref10 = (_o$option_id = o.option_id) !== null && _o$option_id !== void 0 ? _o$option_id : o.id) !== null && _ref10 !== void 0 ? _ref10 : o.opt_id;\n        if (Array.isArray(o.values)) {\n          for (const v of o.values) {\n            var _v$value_id;\n            flat.push({\n              value_id: (_v$value_id = v.value_id) !== null && _v$value_id !== void 0 ? _v$value_id : v.id,\n              option_id,\n              value_name: pickStr(v.value_name, v.name, v.label, v.value)\n            });\n          }\n        }\n      }\n      optionValues = normValueRows(flat);\n    }\n    const valueNameById = new Map(optionValues.map(v => [v.value_id, v.value_name]));\n\n    // 4) โหลด product_variant_values หรือถอดจาก combo ใน variants\n    let variantValues = [];\n    const pvEndpoints = [path(`/api/product_variant_values?product_id=${productId}`), path(`/admin/products/${productId}/variant-values`), path(`/products/${productId}/variant-values`)];\n    for (const url of pvEndpoints) {\n      try {\n        var _r$data7, _r$data8;\n        const r = await api.get(url, {\n          headers: authHeader()\n        });\n        const arr = (r === null || r === void 0 ? void 0 : (_r$data7 = r.data) === null || _r$data7 === void 0 ? void 0 : _r$data7.items) || (r === null || r === void 0 ? void 0 : (_r$data8 = r.data) === null || _r$data8 === void 0 ? void 0 : _r$data8.rows) || (r === null || r === void 0 ? void 0 : r.data) || [];\n        if (Array.isArray(arr) && arr.length) {\n          variantValues = normVariantValues(arr);\n          break;\n        }\n      } catch {}\n    }\n    if (!variantValues.length && Array.isArray(variantsRaw) && variantsRaw.length) {\n      // derive from combo in variantsRaw\n      const flat = [];\n      for (const v of variantsRaw) {\n        var _ref11, _v$variant_id2;\n        const vid = (_ref11 = (_v$variant_id2 = v.variant_id) !== null && _v$variant_id2 !== void 0 ? _v$variant_id2 : v.id) !== null && _ref11 !== void 0 ? _ref11 : v.product_variant_id;\n        if (!vid) continue;\n        const combo = Array.isArray(v.combo) ? v.combo : [];\n        for (const c of combo) {\n          var _c$option_id, _ref12, _c$value_id;\n          const option_id = (_c$option_id = c.option_id) !== null && _c$option_id !== void 0 ? _c$option_id : c.opt_id;\n          const value_id = (_ref12 = (_c$value_id = c.value_id) !== null && _c$value_id !== void 0 ? _c$value_id : c.val_id) !== null && _ref12 !== void 0 ? _ref12 : c.value;\n          if (option_id != null && value_id != null) {\n            flat.push({\n              variant_id: vid,\n              option_id,\n              value_id\n            });\n          }\n        }\n      }\n      variantValues = normVariantValues(flat);\n    }\n\n    // 5) รวมข้อมูล\n    const sortedOptionIds = Array.from(optionNameById.keys()).sort((a, b) => a - b).slice(0, 3);\n    if (sortedOptionIds[0]) setOpt1Name(optionNameById.get(sortedOptionIds[0]) || \"ตัวเลือก 1\");\n    if (sortedOptionIds[1]) setOpt2Name(optionNameById.get(sortedOptionIds[1]) || \"ตัวเลือก 2\");\n    if (sortedOptionIds[2]) setOpt3Name(optionNameById.get(sortedOptionIds[2]) || \"\");\n    const groupByVariant = new Map();\n    for (const r of variantValues) {\n      if (!groupByVariant.has(r.variant_id)) groupByVariant.set(r.variant_id, []);\n      groupByVariant.get(r.variant_id).push(r);\n    }\n    const mapIdx = new Map(sortedOptionIds.map((id, i) => [id, i + 1]));\n    const rowsBuilt = (variants || []).map(b => {\n      var _obj$price, _obj$stock;\n      const vs = groupByVariant.get(Number(b.variant_id)) || [];\n      const obj = {\n        ...b\n      };\n      for (const v of vs) {\n        const idx = mapIdx.get(Number(v.option_id));\n        const valName = v.value_id != null ? valueNameById.get(Number(v.value_id)) : \"\";\n        if (idx === 1) obj.opt1 = valName || obj.opt1;\n        if (idx === 2) obj.opt2 = valName || obj.opt2;\n        if (idx === 3) obj.opt3 = valName || obj.opt3;\n      }\n      if (!obj.opt1 && !obj.opt2 && !obj.opt3 && b.option_text) {\n        const p = parseFromOptionText(b.option_text);\n        obj.opt1 = p.values[0] || obj.opt1;\n        obj.opt2 = p.values[1] || obj.opt2;\n        obj.opt3 = p.values[2] || obj.opt3;\n      }\n      return {\n        __existing: true,\n        variant_id: obj.variant_id,\n        opt1: obj.opt1 || \"\",\n        opt2: obj.opt2 || \"\",\n        opt3: obj.opt3 || \"\",\n        price: (_obj$price = obj.price) !== null && _obj$price !== void 0 ? _obj$price : \"\",\n        stock: Number((_obj$stock = obj.stock) !== null && _obj$stock !== void 0 ? _obj$stock : 0),\n        sku: obj.sku || \"\",\n        image: obj.image || null,\n        opt1_name: opt1Name,\n        opt2_name: opt2Name,\n        opt3_name: opt3Name\n      };\n    });\n\n    // เติม chips เริ่มต้น\n    setRows(rowsBuilt);\n    setOpt1Values(uniq(rowsBuilt.map(r => r.opt1)));\n    setOpt2Values(uniq(rowsBuilt.map(r => r.opt2)));\n    setOpt3Values(uniq(rowsBuilt.map(r => r.opt3)));\n    setDeletedIds([]);\n  }, [productId]);\n  useEffect(() => {\n    loadProduct();\n    loadAll();\n  }, [loadProduct, loadAll]);\n  const productName = useMemo(() => pickStr(product === null || product === void 0 ? void 0 : product.product_name, product === null || product === void 0 ? void 0 : product.name, product === null || product === void 0 ? void 0 : product.title), [product]);\n  const productCode = useMemo(() => pickStr(product === null || product === void 0 ? void 0 : product.product_code, product === null || product === void 0 ? void 0 : product.code, `P${productId}`), [product, productId]);\n\n  /* ---------- chips merge generate ---------- */\n  const mergeGenerate = useCallback(() => {\n    const v1 = opt1Values.length ? opt1Values : [\"\"];\n    const v2 = opt2Values.length ? opt2Values : [\"\"];\n    const v3 = opt3Values.length ? opt3Values : [\"\"];\n    const should = new Map();\n    for (const a of v1) for (const b of v2) for (const c of v3) {\n      should.set(keyOf({\n        opt1: a || \"\",\n        opt2: b || \"\",\n        opt3: c || \"\"\n      }), {\n        opt1: a || \"\",\n        opt2: b || \"\",\n        opt3: c || \"\"\n      });\n    }\n    const cur = new Map(rows.map(r => [keyOf(r), r]));\n    const next = [];\n    for (const [k, want] of should.entries()) {\n      if (cur.has(k)) next.push({\n        ...cur.get(k)\n      });else next.push({\n        __existing: false,\n        variant_id: null,\n        opt1: want.opt1,\n        opt2: want.opt2,\n        opt3: want.opt3,\n        price: \"\",\n        stock: 0,\n        sku: \"\",\n        image: null,\n        opt1_name: opt1Name,\n        opt2_name: opt2Name,\n        opt3_name: opt3Name\n      });\n    }\n    setRows(next);\n  }, [rows, opt1Values, opt2Values, opt3Values, opt1Name, opt2Name, opt3Name]);\n  useEffect(() => {\n    mergeGenerate();\n  }, [opt1Values, opt2Values, opt3Values]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  /* ---------- chips add/remove ---------- */\n  const addTag = (list, setList, txt) => {\n    const v = String(txt || \"\").trim();\n    if (!v) return;\n    if (!list.includes(v)) setList(uniq([...list, v]));\n  };\n  const removeTag = (list, setList, idx) => {\n    const v = list[idx];\n    setList(list.filter((_, i) => i !== idx));\n    setRows(prev => prev.filter(r => r[`opt${setList === setOpt1Values ? 1 : setList === setOpt2Values ? 2 : 3}`] !== v));\n  };\n\n  /* ---------- per-row upload ---------- */\n  const onUploadRowImage = async (file, idx) => {\n    if (!file) return;\n    const tempUrl = URL.createObjectURL(file);\n    setRows(prev => {\n      const a = [...prev];\n      a[idx] = {\n        ...a[idx],\n        image: tempUrl,\n        __temp: true\n      };\n      return a;\n    });\n    try {\n      const serverUrl = await tryUpload(file);\n      setRows(prev => {\n        const a = [...prev];\n        a[idx] = {\n          ...a[idx],\n          image: serverUrl,\n          __temp: false\n        };\n        return a;\n      });\n    } catch (e) {\n      setRows(prev => {\n        const a = [...prev];\n        a[idx] = {\n          ...a[idx],\n          image: null,\n          __temp: false\n        };\n        return a;\n      });\n      alert((e === null || e === void 0 ? void 0 : e.message) || \"Upload failed\");\n    } finally {\n      setTimeout(() => URL.revokeObjectURL(tempUrl), 2500);\n    }\n  };\n  const onDeleteRow = i => {\n    setRows(prev => {\n      const r = prev[i];\n      if (r !== null && r !== void 0 && r.variant_id) setDeletedIds(ids => uniq([...ids, r.variant_id]));\n      const a = [...prev];\n      a.splice(i, 1);\n      return a;\n    });\n  };\n\n  /* ---------- Auto SKU ---------- */\n  const autoSku = () => {\n    const base = productCode || `P${productId}`;\n    setRows(prev => prev.map(r => {\n      const parts = [base, r.opt1, r.opt2, r.opt3].filter(x => String(x || \"\").trim() !== \"\");\n      return {\n        ...r,\n        sku: parts.join(\"-\") + \"-\" + rand2()\n      };\n    }));\n  };\n\n  /* ---------- Save ---------- */\n  const saveAll = async () => {\n    setSaving(true);\n    try {\n      const payloadRows = rows.map(r => ({\n        variant_id: r.variant_id || null,\n        details: [r.opt1 ? {\n          name: opt1Name,\n          value: r.opt1\n        } : null, r.opt2 ? {\n          name: opt2Name,\n          value: r.opt2\n        } : null, r.opt3 && (opt3Name || r.opt3) ? {\n          name: opt3Name || \"ตัวเลือก 3\",\n          value: r.opt3\n        } : null].filter(Boolean),\n        sku: r.sku || null,\n        price: r.price !== \"\" ? Number(r.price) : null,\n        image_url: r.image || null,\n        stock: r.stock != null ? Number(r.stock) : null\n      }));\n      if (deletedIds.length) {\n        try {\n          await api.post(path(`/api/variants/delete-batch`), {\n            variant_ids: deletedIds\n          }, {\n            headers: authHeader()\n          });\n        } catch {}\n        try {\n          await api.delete(path(`/admin/products/${productId}/variants`), {\n            data: {\n              variant_ids: deletedIds\n            },\n            headers: authHeader()\n          });\n        } catch {}\n      }\n      let done = false;\n      try {\n        await api.post(path(`/api/variants/upsert-batch`), {\n          product_id: productId,\n          rows: payloadRows\n        }, {\n          headers: authHeader()\n        });\n        done = true;\n      } catch {}\n      if (!done) {\n        try {\n          await api.put(path(`/admin/products/${productId}/variants`), {\n            rows: payloadRows\n          }, {\n            headers: authHeader()\n          });\n          done = true;\n        } catch {}\n      }\n      if (!done) {\n        try {\n          await api.post(path(`/admin/products/${productId}/variants/save`), {\n            rows: payloadRows\n          }, {\n            headers: authHeader()\n          });\n          done = true;\n        } catch {}\n      }\n      if (!done) {\n        try {\n          await api.post(path(`/api/variants/${productId}/variants/generate`), {\n            rows: payloadRows\n          }, {\n            headers: authHeader()\n          });\n          done = true;\n        } catch {}\n      }\n      if (!done) {\n        await api.post(path(`/admin/products/${productId}/variants/generate`), {\n          rows: payloadRows\n        }, {\n          headers: authHeader()\n        });\n      }\n      setMsg(\"✅ บันทึกแล้ว\");\n      setTimeout(() => setMsg(\"\"), 1800);\n      // try to update stocks in a single shot (best-effort)\n      try {\n        const stockItems = rows.filter(r => r.variant_id && r.stock != null).map(r => ({\n          variant_id: r.variant_id,\n          stock: Number(r.stock) || 0\n        }));\n        if (stockItems.length) {\n          await api.post(path(`/api/variants/update-stocks`), {\n            items: stockItems\n          }, {\n            headers: authHeader()\n          });\n        }\n      } catch {}\n      await loadAll();\n    } catch (e) {\n      var _e$response, _e$response$data;\n      console.error(e);\n      alert((e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.message) || \"❌ Save failed\");\n    } finally {\n      setSaving(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"vm-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vm-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"vm-title\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"vm-product-name\",\n          children: pickStr(product === null || product === void 0 ? void 0 : product.product_name, product === null || product === void 0 ? void 0 : product.name, product === null || product === void 0 ? void 0 : product.title) || `#${productId}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 448,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"vm-product-code\",\n          children: pickStr(product === null || product === void 0 ? void 0 : product.product_code, product === null || product === void 0 ? void 0 : product.code, `P${productId}`)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 449,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 447,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/admin/products\",\n        className: \"vm-back\",\n        children: \"\\u2190 \\u0E01\\u0E25\\u0E31\\u0E1A\\u0E44\\u0E1B\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E2A\\u0E34\\u0E19\\u0E04\\u0E49\\u0E32\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 451,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 446,\n      columnNumber: 7\n    }, this), msg && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vm-msg\",\n      children: msg\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 454,\n      columnNumber: 15\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vm-options\",\n      style: {\n        display: \"grid\",\n        gridTemplateColumns: \"1fr 1fr 1fr\",\n        gap: \"16px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"vm-opt\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E15\\u0E31\\u0E27\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01 1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 459,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          value: opt1Name,\n          onChange: e => setOpt1Name(e.target.value),\n          placeholder: \"\\u0E40\\u0E0A\\u0E48\\u0E19 \\u0E2A\\u0E39\\u0E15\\u0E23\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 460,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"vm-chips\",\n          style: {\n            marginTop: 8\n          },\n          children: [opt1Values.map((v, i) => /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"vm-chip\",\n            children: [v, /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => removeTag(opt1Values, setOpt1Values, i),\n              children: \"\\xD7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 463,\n              columnNumber: 52\n            }, this)]\n          }, i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 463,\n            columnNumber: 15\n          }, this)), /*#__PURE__*/_jsxDEV(\"input\", {\n            placeholder: \"\\u0E40\\u0E0A\\u0E48\\u0E19 \\u0E17\\u0E31\\u0E48\\u0E27\\u0E44\\u0E1B \\u0E41\\u0E25\\u0E49\\u0E27 Enter\",\n            onKeyDown: e => {\n              if (e.key === \"Enter\") {\n                e.preventDefault();\n                addTag(opt1Values, setOpt1Values, e.currentTarget.value);\n                e.currentTarget.value = \"\";\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 465,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 461,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 458,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"vm-opt\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E15\\u0E31\\u0E27\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01 2 (\\u0E16\\u0E49\\u0E32\\u0E21\\u0E35)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 469,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          value: opt2Name,\n          onChange: e => setOpt2Name(e.target.value),\n          placeholder: \"\\u0E40\\u0E0A\\u0E48\\u0E19 \\u0E02\\u0E19\\u0E32\\u0E14\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 470,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"vm-chips\",\n          style: {\n            marginTop: 8\n          },\n          children: [opt2Values.map((v, i) => /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"vm-chip\",\n            children: [v, /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => removeTag(opt2Values, setOpt2Values, i),\n              children: \"\\xD7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 473,\n              columnNumber: 52\n            }, this)]\n          }, i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 473,\n            columnNumber: 15\n          }, this)), /*#__PURE__*/_jsxDEV(\"input\", {\n            placeholder: \"\\u0E40\\u0E0A\\u0E48\\u0E19 M / 6 \\u0E19\\u0E34\\u0E49\\u0E27 \\u0E41\\u0E25\\u0E49\\u0E27 Enter\",\n            onKeyDown: e => {\n              if (e.key === \"Enter\") {\n                e.preventDefault();\n                addTag(opt2Values, setOpt2Values, e.currentTarget.value);\n                e.currentTarget.value = \"\";\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 475,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 471,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 468,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"vm-opt\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E15\\u0E31\\u0E27\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01 3 (\\u0E16\\u0E49\\u0E32\\u0E21\\u0E35)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 479,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          value: opt3Name,\n          onChange: e => setOpt3Name(e.target.value),\n          placeholder: \"\\u0E40\\u0E0A\\u0E48\\u0E19 \\u0E27\\u0E31\\u0E2A\\u0E14\\u0E38\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 480,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"vm-chips\",\n          style: {\n            marginTop: 8\n          },\n          children: [opt3Values.map((v, i) => /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"vm-chip\",\n            children: [v, /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => removeTag(opt3Values, setOpt3Values, i),\n              children: \"\\xD7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 483,\n              columnNumber: 52\n            }, this)]\n          }, i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 483,\n            columnNumber: 15\n          }, this)), /*#__PURE__*/_jsxDEV(\"input\", {\n            placeholder: \"\\u0E40\\u0E0A\\u0E48\\u0E19 \\u0E40\\u0E0B\\u0E23\\u0E32\\u0E21\\u0E34\\u0E01 \\u0E41\\u0E25\\u0E49\\u0E27 Enter\",\n            onKeyDown: e => {\n              if (e.key === \"Enter\") {\n                e.preventDefault();\n                addTag(opt3Values, setOpt3Values, e.currentTarget.value);\n                e.currentTarget.value = \"\";\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 485,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 481,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 478,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 457,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vm-table-wrap\",\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"vm-table\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u0E23\\u0E39\\u0E1B\\u0E20\\u0E32\\u0E1E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 495,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: opt1Name || \"ตัวเลือก 1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 496,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: opt2Name || \"ตัวเลือก 2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 497,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: opt3Name || \"ตัวเลือก 3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 498,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u0E23\\u0E32\\u0E04\\u0E32\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 499,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u0E04\\u0E07\\u0E40\\u0E2B\\u0E25\\u0E37\\u0E2D\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 500,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"SKU\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 501,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u0E25\\u0E1A\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 502,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 494,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 493,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: [rows.map((r, i) => {\n            var _r$stock;\n            return /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: r.image ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: mediaSrc(r.image),\n                  alt: \"\",\n                  className: \"vm-thumb\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 510,\n                  columnNumber: 21\n                }, this) : /*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"vm-upload\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"+\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 513,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"file\",\n                    accept: \"image/*\",\n                    onChange: e => {\n                      var _e$target$files;\n                      return onUploadRowImage((_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0], i);\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 514,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 512,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 508,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: r.opt1 || \"-\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 518,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: r.opt2 || \"-\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 519,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: r.opt3 || \"-\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 520,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"number\",\n                  min: \"0\",\n                  placeholder: \"\\u0E44\\u0E21\\u0E48\\u0E23\\u0E30\\u0E1A\\u0E38\",\n                  value: r.price,\n                  onChange: e => {\n                    const v = e.target.value;\n                    setRows(prev => {\n                      const a = [...prev];\n                      a[i] = {\n                        ...a[i],\n                        price: v\n                      };\n                      return a;\n                    });\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 522,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 521,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"number\",\n                  min: \"0\",\n                  step: \"1\",\n                  value: (_r$stock = r.stock) !== null && _r$stock !== void 0 ? _r$stock : 0,\n                  onChange: e => {\n                    const v = e.target.value;\n                    setRows(prev => {\n                      const a = [...prev];\n                      a[i] = {\n                        ...a[i],\n                        stock: v === \"\" ? 0 : Math.max(0, Number(v))\n                      };\n                      return a;\n                    });\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 528,\n                  columnNumber: 3\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 527,\n                columnNumber: 1\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  placeholder: \"SKU\",\n                  value: r.sku,\n                  onChange: e => {\n                    const v = e.target.value;\n                    setRows(prev => {\n                      const a = [...prev];\n                      a[i] = {\n                        ...a[i],\n                        sku: v\n                      };\n                      return a;\n                    });\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 540,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 539,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn\",\n                  onClick: () => onDeleteRow(i),\n                  title: \"\\u0E25\\u0E1A\\u0E41\\u0E16\\u0E27\",\n                  children: \"\\uD83D\\uDDD1\\uFE0F\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 545,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 545,\n                columnNumber: 17\n              }, this)]\n            }, i, true, {\n              fileName: _jsxFileName,\n              lineNumber: 507,\n              columnNumber: 15\n            }, this);\n          }), rows.length === 0 && /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: /*#__PURE__*/_jsxDEV(\"td\", {\n              colSpan: 7,\n              style: {\n                textAlign: \"center\",\n                padding: 16\n              },\n              children: \"\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E04\\u0E48\\u0E32\\u0E43\\u0E19\\u0E01\\u0E25\\u0E48\\u0E2D\\u0E07\\u0E14\\u0E49\\u0E32\\u0E19\\u0E1A\\u0E19 (\\u0E1E\\u0E34\\u0E21\\u0E1E\\u0E4C\\u0E41\\u0E25\\u0E49\\u0E27\\u0E01\\u0E14 Enter) \\u0E40\\u0E1E\\u0E37\\u0E48\\u0E2D\\u0E2A\\u0E23\\u0E49\\u0E32\\u0E07\\u0E0A\\u0E38\\u0E14\\u0E15\\u0E31\\u0E27\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01 \\u0E41\\u0E25\\u0E49\\u0E27\\u0E01\\u0E14 \\u201C\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\\u0E17\\u0E31\\u0E49\\u0E07\\u0E2B\\u0E21\\u0E14\\u201D\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 550,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 549,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 505,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 492,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 491,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vm-actions\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn\",\n        onClick: autoSku,\n        disabled: saving,\n        children: \"\\u2728 \\u0E40\\u0E15\\u0E34\\u0E21 SKU \\u0E2D\\u0E31\\u0E15\\u0E42\\u0E19\\u0E21\\u0E31\\u0E15\\u0E34\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 561,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn-primary\",\n        onClick: saveAll,\n        disabled: saving,\n        children: saving ? \"กำลังบันทึก…\" : \"บันทึกทั้งหมด\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 562,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 560,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vm-hint\",\n      children: \"\\u0E40\\u0E21\\u0E37\\u0E48\\u0E2D\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E40\\u0E2A\\u0E23\\u0E47\\u0E08 \\u0E43\\u0E2B\\u0E49\\u0E01\\u0E14 \\u201C\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\\u201D \\u0E14\\u0E49\\u0E32\\u0E19\\u0E1A\\u0E19 \\u0E40\\u0E1E\\u0E37\\u0E48\\u0E2D\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\\u0E15\\u0E31\\u0E27\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\\u0E17\\u0E31\\u0E49\\u0E07\\u0E2B\\u0E21\\u0E14\\u0E1E\\u0E23\\u0E49\\u0E2D\\u0E21\\u0E2A\\u0E34\\u0E19\\u0E04\\u0E49\\u0E32\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 565,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 444,\n    columnNumber: 5\n  }, this);\n}\n_s(VariantsManager, \"iO7L1cUQPHLB9nAmbOuyeOG9pCQ=\", false, function () {\n  return [useParams];\n});\n_c = VariantsManager;\nvar _c;\n$RefreshReg$(_c, \"VariantsManager\");","map":{"version":3,"names":["React","useEffect","useMemo","useState","useCallback","useParams","Link","api","path","mediaSrc","jsxDEV","_jsxDEV","authHeader","t","localStorage","getItem","Authorization","byKey","a","b","uniq","arr","Array","from","Set","filter","x","undefined","String","trim","sort","pickStr","xs","_xs$find","find","v","rand2","Math","floor","random","padStart","keyOf","r","opt1","opt2","opt3","join","extractUrl","data","_data$file","_data$file2","_data$data","_data$data2","_data$data3","direct","url","imageUrl","Location","location","file","flat","JSON","stringify","m","match","tryUpload","fd","FormData","append","res","post","headers","Error","normalizeProduct","raw","d","item","product","result","normOptionRows","rows","out","_ref","_r$option_id","id","option_id","opt_id","name","option_name","label","push","Number","values","isArray","normValueRows","_r$value_id","_r$option_id2","value_id","optionId","value_name","value","normVariantValues","_ref2","_r$variant_id","_r$option_id3","_ref3","_r$value_id2","vid","variant_id","product_variant_id","oid","val","val_id","parseFromOptionText","optionText","names","s","parts","split","map","Boolean","i","min","length","p","j","indexOf","slice","firstNonEmpty","_xs$find2","toString","normVariantBase","_ref4","_ref5","_ref6","_ref7","_v$final_price","_ref8","_ref9","_v$stock","_ref0","_ref1","_v$variant_id","priceRaw","final_price","price","unit_price","sale_price","price_override","stockRaw","stock","stock_qty","quantity","sku","SKU","code","image","image_url","variant_image","option_text","options_text","combo","opt1_name","option1_name","name1","option1","opt2_name","option2_name","name2","option2","opt3_name","option3_name","name3","option3","option1_value","value1","color","option2_value","value2","size","option3_value","value3","material","VariantsManager","_s","productId","pid","setProduct","opt1Name","setOpt1Name","opt2Name","setOpt2Name","opt3Name","setOpt3Name","opt1Values","setOpt1Values","opt2Values","setOpt2Values","opt3Values","setOpt3Values","setRows","deletedIds","setDeletedIds","saving","setSaving","msg","setMsg","loadProduct","get","loadAll","variants","variantsRaw","endpoints","_r$data","_r$data2","items","optionsList","optionsRaw","optionEndpoints","_r$data3","_r$data4","optionNameById","Map","o","optionValues","valueEndpoints","_r$data5","_r$data6","_ref10","_o$option_id","_v$value_id","valueNameById","variantValues","pvEndpoints","_r$data7","_r$data8","_ref11","_v$variant_id2","c","_c$option_id","_ref12","_c$value_id","sortedOptionIds","keys","groupByVariant","has","set","mapIdx","rowsBuilt","_obj$price","_obj$stock","vs","obj","idx","valName","__existing","productName","product_name","title","productCode","product_code","mergeGenerate","v1","v2","v3","should","cur","next","k","want","entries","addTag","list","setList","txt","includes","removeTag","_","prev","onUploadRowImage","tempUrl","URL","createObjectURL","__temp","serverUrl","e","alert","message","setTimeout","revokeObjectURL","onDeleteRow","ids","splice","autoSku","base","saveAll","payloadRows","details","variant_ids","delete","done","product_id","put","stockItems","_e$response","_e$response$data","console","error","response","className","children","fileName","_jsxFileName","lineNumber","columnNumber","to","style","display","gridTemplateColumns","gap","onChange","target","placeholder","marginTop","onClick","onKeyDown","key","preventDefault","currentTarget","_r$stock","src","alt","type","accept","_e$target$files","files","step","max","colSpan","textAlign","padding","disabled","_c","$RefreshReg$"],"sources":["D:/project19/frontend/src/admin/VariantsManager.js"],"sourcesContent":["// src/admin/VariantsManager.js\r\n// ======================================================================\r\n// VariantsManager (DB-aware, resilient) — โหลดข้อมูลครบแม้ไม่มี compat endpoints\r\n// - ใช้ /api/variants/product/:id เป็นแหล่งหลัก (อ่าน combo เพื่อถอด mapping option/value ได้)\r\n// - ใช้ /api/variants/products/:id/options เป็นแหล่งหลักของ options + values (flatten เป็น value list ให้เอง)\r\n// - ถ้า endpoint เก่า ๆ 404 ก็ยังแสดงครบและบันทึกได้\r\n// ======================================================================\r\n\r\nimport React, { useEffect, useMemo, useState, useCallback } from \"react\";\r\nimport { useParams, Link } from \"react-router-dom\";\r\nimport { api, path, mediaSrc } from \"../lib/api\";\r\nimport \"./VariantsManager.css\";\r\n\r\n/* ---------- Helpers ---------- */\r\nconst authHeader = () => {\r\n  const t = localStorage.getItem(\"token\");\r\n  return t ? { Authorization: `Bearer ${t}` } : {};\r\n};\r\n\r\nconst byKey = (a, b) => (a < b ? -1 : a > b ? 1 : 0);\r\nconst uniq = (arr) => Array.from(new Set(arr.filter((x) => x !== null && x !== undefined && String(x).trim() !== \"\"))).sort(byKey);\r\nconst pickStr = (...xs) => xs.find((v) => typeof v === \"string\" && v.trim())?.trim() || \"\";\r\nconst rand2 = () => String(Math.floor(Math.random() * 99) + 1).padStart(2, \"0\");\r\nconst keyOf = (r) => [r.opt1 || \"\", r.opt2 || \"\", r.opt3 || \"\"].join(\"␟\");\r\n\r\n/* ---------- Upload ---------- */\r\nconst extractUrl = (data) => {\r\n  if (!data) return null;\r\n  if (typeof data === \"string\") return data;\r\n  const direct =\r\n    data.url || data.path || data.imageUrl || data.Location || data.location ||\r\n    data.file?.url || data.file?.path || data.data?.url || data.data?.path || data.data?.imageUrl;\r\n  if (direct) return direct;\r\n  try {\r\n    const flat = JSON.stringify(data);\r\n    const m = flat.match(/\"([^\"]+\\.(?:png|jpe?g|webp|gif))\"/i);\r\n    return m ? m[1] : null;\r\n  } catch { return null; }\r\n};\r\n\r\nconst tryUpload = async (file) => {\r\n  const fd = new FormData();\r\n  fd.append(\"file\", file);\r\n  const res = await api.post(path(\"/upload\"), fd, {\r\n    headers: { ...authHeader(), \"Content-Type\": \"multipart/form-data\" },\r\n  });\r\n  const url = extractUrl(res?.data);\r\n  if (!url) throw new Error(\"UPLOAD_OK_BUT_NO_URL\");\r\n  return url;\r\n};\r\n\r\n/* ---------- Normalize product ---------- */\r\nconst normalizeProduct = (raw) => {\r\n  if (!raw) return null;\r\n  const d = raw.data || raw.item || raw.product || raw.result || raw;\r\n  return d || null;\r\n};\r\n\r\n/* ---------- Option + value helpers ---------- */\r\nconst normOptionRows = (rows) => {\r\n  const out = [];\r\n  for (const r of rows || []) {\r\n    const id = r.option_id ?? r.id ?? r.opt_id;\r\n    const name = pickStr(r.option_name, r.name, r.label);\r\n    if (id != null) out.push({ option_id: Number(id), option_name: name || \"\", values: Array.isArray(r.values) ? r.values : [] });\r\n  }\r\n  return out;\r\n};\r\n\r\nconst normValueRows = (rows) => {\r\n  const out = [];\r\n  for (const r of rows || []) {\r\n    const id = r.value_id ?? r.id;\r\n    const optionId = r.option_id ?? r.opt_id;\r\n    const name = pickStr(r.value_name, r.name, r.label, r.value);\r\n    if (id != null) out.push({ value_id: Number(id), option_id: Number(optionId ?? 0), value_name: name || \"\" });\r\n  }\r\n  return out;\r\n};\r\n\r\nconst normVariantValues = (rows) => {\r\n  const out = [];\r\n  for (const r of rows || []) {\r\n    const vid = r.variant_id ?? r.product_variant_id ?? r.id;\r\n    const oid = r.option_id ?? r.opt_id;\r\n    const val = r.value_id ?? r.val_id ?? r.value;\r\n    if (vid != null && oid != null) out.push({ variant_id: Number(vid), option_id: Number(oid), value_id: val != null ? Number(val) : null });\r\n  }\r\n  return out;\r\n};\r\n\r\n/* ---------- Parse helpers ---------- */\r\nfunction parseFromOptionText(optionText) {\r\n  const res = { names: [\"\", \"\", \"\"], values: [\"\", \"\", \"\"] };\r\n  const s = String(optionText || \"\").trim();\r\n  if (!s) return res;\r\n  const parts = s.split(\"|\").map((x) => x.trim()).filter(Boolean);\r\n  for (let i = 0; i < Math.min(3, parts.length); i++) {\r\n    const p = parts[i]; const j = p.indexOf(\":\");\r\n    if (j >= 0) { res.names[i] = p.slice(0, j).trim(); res.values[i] = p.slice(j + 1).trim(); }\r\n    else { res.values[i] = p; }\r\n  }\r\n  return res;\r\n}\r\nconst firstNonEmpty = (...xs) => xs.find((x) => x !== undefined && x !== null && String(x).trim())?.toString().trim() || \"\";\r\n\r\n/* ---------- Variant normalize (base) ---------- */\r\nconst normVariantBase = (v) => {\r\n  if (!v) return null;\r\n  const priceRaw = v.final_price ?? v.price ?? v.unit_price ?? v.sale_price ?? v.price_override ?? \"\";\r\n  const stockRaw = v.stock ?? v.stock_qty ?? v.quantity ?? 0;\r\n  const sku = firstNonEmpty(v.sku, v.SKU, v.code);\r\n  const image = firstNonEmpty(v.image_url, v.image, v.imageUrl, v.variant_image);\r\n  return {\r\n    variant_id: v.variant_id ?? v.id ?? v.product_variant_id ?? null,\r\n    sku,\r\n    price: typeof priceRaw === \"number\" ? String(priceRaw) : String(priceRaw || \"\"),\r\n    stock: Number(stockRaw) || 0,\r\n    image: image || null,\r\n    option_text: firstNonEmpty(v.option_text, v.options_text, \"\"),\r\n    combo: Array.isArray(v.combo) ? v.combo : [], // keep for fallback\r\n    opt1_name: firstNonEmpty(v.opt1_name, v.option1_name, v.name1, v.option1, \"\"),\r\n    opt2_name: firstNonEmpty(v.opt2_name, v.option2_name, v.name2, v.option2, \"\"),\r\n    opt3_name: firstNonEmpty(v.opt3_name, v.option3_name, v.name3, v.option3, \"\"),\r\n    opt1: firstNonEmpty(v.option1_value, v.opt1, v.value1, v.color, \"\"),\r\n    opt2: firstNonEmpty(v.option2_value, v.opt2, v.value2, v.size, \"\"),\r\n    opt3: firstNonEmpty(v.option3_value, v.opt3, v.value3, v.material, \"\"),\r\n  };\r\n};\r\n\r\n/* ====================================================================== */\r\nexport default function VariantsManager() {\r\n  const { id, productId: pid } = useParams();\r\n  const productId = Number(id || pid);\r\n\r\n  const [product, setProduct] = useState(null);\r\n\r\n  // ชื่อหัวคอลัมน์\r\n  const [opt1Name, setOpt1Name] = useState(\"ตัวเลือก 1\");\r\n  const [opt2Name, setOpt2Name] = useState(\"ตัวเลือก 2\");\r\n  const [opt3Name, setOpt3Name] = useState(\"ตัวเลือก 3\");\r\n\r\n  // chips\r\n  const [opt1Values, setOpt1Values] = useState([]);\r\n  const [opt2Values, setOpt2Values] = useState([]);\r\n  const [opt3Values, setOpt3Values] = useState([]);\r\n\r\n  // แถว\r\n  const [rows, setRows] = useState([]);\r\n  const [deletedIds, setDeletedIds] = useState([]);\r\n\r\n  const [saving, setSaving] = useState(false);\r\n  const [msg, setMsg] = useState(\"\");\r\n\r\n  /* ---------- Load product ---------- */\r\n  const loadProduct = useCallback(async () => {\r\n    if (!productId) return;\r\n    let p = null;\r\n    try {\r\n      const r = await api.get(path(`/admin/products/${productId}`));\r\n      p = normalizeProduct(r?.data);\r\n    } catch {}\r\n    if (!p) { try { const r = await api.get(path(`/products/${productId}`)); p = normalizeProduct(r?.data); } catch {} }\r\n    setProduct(p || null);\r\n  }, [productId]);\r\n\r\n  /* ---------- Load variants + options/values ---------- */\r\n  const loadAll = useCallback(async () => {\r\n    if (!productId) return;\r\n\r\n    // 1) โหลด variants พื้นฐาน\r\n    let variants = [];\r\n    let variantsRaw = [];\r\n    const endpoints = [\r\n      path(`/api/variants/product/${productId}?active=0`),\r\n      path(`/api/variants/by-product/${productId}`),\r\n      path(`/api/variants?product_id=${productId}`),\r\n      path(`/admin/products/${productId}/variants`),\r\n      path(`/products/${productId}/variants`),\r\n    ];\r\n    for (const url of endpoints) {\r\n      try {\r\n        const r = await api.get(url, { headers: authHeader() });\r\n        const arr = r?.data?.items || r?.data?.rows || r?.data || [];\r\n        if (Array.isArray(arr) && arr.length) {\r\n          variantsRaw = arr;\r\n          variants = arr.map(normVariantBase);\r\n          break;\r\n        }\r\n      } catch {}\r\n    }\r\n\r\n    // 2) โหลด product_options (+ values)\r\n    let optionsList = [];\r\n    let optionsRaw = [];\r\n    const optionEndpoints = [\r\n      path(`/api/variants/products/${productId}/options`),\r\n      path(`/admin/products/${productId}/options`),\r\n      path(`/products/${productId}/options`),\r\n      path(`/api/products/${productId}/options`),\r\n      path(`/api/product_options?product_id=${productId}`),\r\n    ];\r\n    for (const url of optionEndpoints) {\r\n      try {\r\n        const r = await api.get(url, { headers: authHeader() });\r\n        const arr = r?.data?.items || r?.data?.rows || r?.data || [];\r\n        if (Array.isArray(arr) && arr.length) { optionsRaw = arr; optionsList = normOptionRows(arr); break; }\r\n      } catch {}\r\n    }\r\n    const optionNameById = new Map(optionsList.map((o) => [o.option_id, o.option_name]));\r\n\r\n    // 3) โหลด option_values (flatten from options หาก endpoint ตรงไม่มี)\r\n    let optionValues = [];\r\n    const valueEndpoints = [\r\n      path(`/api/variants/products/${productId}/option-values`),\r\n      path(`/api/product_option_values?product_id=${productId}`),\r\n      path(`/admin/products/${productId}/option-values`),\r\n      path(`/products/${productId}/option-values`),\r\n    ];\r\n    for (const url of valueEndpoints) {\r\n      try {\r\n        const r = await api.get(url, { headers: authHeader() });\r\n        const arr = r?.data?.items || r?.data?.rows || r?.data || [];\r\n        if (Array.isArray(arr) && arr.length) { optionValues = normValueRows(arr); break; }\r\n      } catch {}\r\n    }\r\n    if (!optionValues.length && Array.isArray(optionsRaw) && optionsRaw.length) {\r\n      // flatten from optionsRaw.values\r\n      const flat = [];\r\n      for (const o of optionsRaw) {\r\n        const option_id = o.option_id ?? o.id ?? o.opt_id;\r\n        if (Array.isArray(o.values)) {\r\n          for (const v of o.values) {\r\n            flat.push({ value_id: v.value_id ?? v.id, option_id, value_name: pickStr(v.value_name, v.name, v.label, v.value) });\r\n          }\r\n        }\r\n      }\r\n      optionValues = normValueRows(flat);\r\n    }\r\n    const valueNameById = new Map(optionValues.map((v) => [v.value_id, v.value_name]));\r\n\r\n    // 4) โหลด product_variant_values หรือถอดจาก combo ใน variants\r\n    let variantValues = [];\r\n    const pvEndpoints = [\r\n      path(`/api/product_variant_values?product_id=${productId}`),\r\n      path(`/admin/products/${productId}/variant-values`),\r\n      path(`/products/${productId}/variant-values`),\r\n    ];\r\n    for (const url of pvEndpoints) {\r\n      try {\r\n        const r = await api.get(url, { headers: authHeader() });\r\n        const arr = r?.data?.items || r?.data?.rows || r?.data || [];\r\n        if (Array.isArray(arr) && arr.length) { variantValues = normVariantValues(arr); break; }\r\n      } catch {}\r\n    }\r\n    if (!variantValues.length && Array.isArray(variantsRaw) && variantsRaw.length) {\r\n      // derive from combo in variantsRaw\r\n      const flat = [];\r\n      for (const v of variantsRaw) {\r\n        const vid = v.variant_id ?? v.id ?? v.product_variant_id;\r\n        if (!vid) continue;\r\n        const combo = Array.isArray(v.combo) ? v.combo : [];\r\n        for (const c of combo) {\r\n          const option_id = c.option_id ?? c.opt_id;\r\n          const value_id = c.value_id ?? c.val_id ?? c.value;\r\n          if (option_id != null && value_id != null) {\r\n            flat.push({ variant_id: vid, option_id, value_id });\r\n          }\r\n        }\r\n      }\r\n      variantValues = normVariantValues(flat);\r\n    }\r\n\r\n    // 5) รวมข้อมูล\r\n    const sortedOptionIds = Array.from(optionNameById.keys()).sort((a,b)=>a-b).slice(0,3);\r\n    if (sortedOptionIds[0]) setOpt1Name(optionNameById.get(sortedOptionIds[0]) || \"ตัวเลือก 1\");\r\n    if (sortedOptionIds[1]) setOpt2Name(optionNameById.get(sortedOptionIds[1]) || \"ตัวเลือก 2\");\r\n    if (sortedOptionIds[2]) setOpt3Name(optionNameById.get(sortedOptionIds[2]) || \"\");\r\n\r\n    const groupByVariant = new Map();\r\n    for (const r of variantValues) {\r\n      if (!groupByVariant.has(r.variant_id)) groupByVariant.set(r.variant_id, []);\r\n      groupByVariant.get(r.variant_id).push(r);\r\n    }\r\n\r\n    const mapIdx = new Map(sortedOptionIds.map((id, i) => [id, i+1]));\r\n\r\n    const rowsBuilt = (variants || []).map((b) => {\r\n      const vs = groupByVariant.get(Number(b.variant_id)) || [];\r\n      const obj = { ...b };\r\n      for (const v of vs) {\r\n        const idx = mapIdx.get(Number(v.option_id));\r\n        const valName = v.value_id != null ? valueNameById.get(Number(v.value_id)) : \"\";\r\n        if (idx === 1) obj.opt1 = valName || obj.opt1;\r\n        if (idx === 2) obj.opt2 = valName || obj.opt2;\r\n        if (idx === 3) obj.opt3 = valName || obj.opt3;\r\n      }\r\n      if (!obj.opt1 && !obj.opt2 && !obj.opt3 && b.option_text) {\r\n        const p = parseFromOptionText(b.option_text);\r\n        obj.opt1 = p.values[0] || obj.opt1;\r\n        obj.opt2 = p.values[1] || obj.opt2;\r\n        obj.opt3 = p.values[2] || obj.opt3;\r\n      }\r\n      return {\r\n        __existing: true,\r\n        variant_id: obj.variant_id,\r\n        opt1: obj.opt1 || \"\",\r\n        opt2: obj.opt2 || \"\",\r\n        opt3: obj.opt3 || \"\",\r\n        price: obj.price ?? \"\",\r\n        \r\n        stock: Number(obj.stock ?? 0),sku: obj.sku || \"\",\r\n        image: obj.image || null,\r\n        opt1_name: opt1Name, opt2_name: opt2Name, opt3_name: opt3Name,\r\n      };\r\n    });\r\n\r\n    // เติม chips เริ่มต้น\r\n    setRows(rowsBuilt);\r\n    setOpt1Values(uniq(rowsBuilt.map(r=>r.opt1)));\r\n    setOpt2Values(uniq(rowsBuilt.map(r=>r.opt2)));\r\n    setOpt3Values(uniq(rowsBuilt.map(r=>r.opt3)));\r\n    setDeletedIds([]);\r\n  }, [productId]);\r\n\r\n  useEffect(() => { loadProduct(); loadAll(); }, [loadProduct, loadAll]);\r\n\r\n  const productName = useMemo(() => pickStr(product?.product_name, product?.name, product?.title), [product]);\r\n  const productCode = useMemo(() => pickStr(product?.product_code, product?.code, `P${productId}`), [product, productId]);\r\n\r\n  /* ---------- chips merge generate ---------- */\r\n  const mergeGenerate = useCallback(() => {\r\n    const v1 = opt1Values.length ? opt1Values : [\"\"];\r\n    const v2 = opt2Values.length ? opt2Values : [\"\"];\r\n    const v3 = opt3Values.length ? opt3Values : [\"\"];\r\n    const should = new Map();\r\n    for (const a of v1) for (const b of v2) for (const c of v3) {\r\n      should.set(keyOf({ opt1:a||\"\", opt2:b||\"\", opt3:c||\"\" }), { opt1:a||\"\", opt2:b||\"\", opt3:c||\"\" });\r\n    }\r\n    const cur = new Map(rows.map((r) => [keyOf(r), r]));\r\n    const next = [];\r\n    for (const [k, want] of should.entries()) {\r\n      if (cur.has(k)) next.push({ ...cur.get(k) });\r\n      else next.push({ __existing:false, variant_id:null, opt1:want.opt1, opt2:want.opt2, opt3:want.opt3, price:\"\", stock: 0,\r\n          sku:\"\", image:null, opt1_name:opt1Name, opt2_name:opt2Name, opt3_name:opt3Name });\r\n    }\r\n    setRows(next);\r\n  }, [rows, opt1Values, opt2Values, opt3Values, opt1Name, opt2Name, opt3Name]);\r\n  useEffect(() => { mergeGenerate(); }, [opt1Values, opt2Values, opt3Values]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  /* ---------- chips add/remove ---------- */\r\n  const addTag = (list, setList, txt) => {\r\n    const v = String(txt || \"\").trim();\r\n    if (!v) return;\r\n    if (!list.includes(v)) setList(uniq([...list, v]));\r\n  };\r\n  const removeTag = (list, setList, idx) => {\r\n    const v = list[idx];\r\n    setList(list.filter((_, i) => i !== idx));\r\n    setRows((prev) => prev.filter((r) => r[`opt${setList === setOpt1Values ? 1 : setList === setOpt2Values ? 2 : 3}`] !== v));\r\n  };\r\n\r\n  /* ---------- per-row upload ---------- */\r\n  const onUploadRowImage = async (file, idx) => {\r\n    if (!file) return;\r\n    const tempUrl = URL.createObjectURL(file);\r\n    setRows((prev) => { const a = [...prev]; a[idx] = { ...a[idx], image: tempUrl, __temp: true }; return a; });\r\n    try {\r\n      const serverUrl = await tryUpload(file);\r\n      setRows((prev) => { const a = [...prev]; a[idx] = { ...a[idx], image: serverUrl, __temp: false }; return a; });\r\n    } catch (e) {\r\n      setRows((prev) => { const a = [...prev]; a[idx] = { ...a[idx], image: null, __temp: false }; return a; });\r\n      alert(e?.message || \"Upload failed\");\r\n    } finally { setTimeout(() => URL.revokeObjectURL(tempUrl), 2500); }\r\n  };\r\n\r\n  const onDeleteRow = (i) => {\r\n    setRows((prev) => {\r\n      const r = prev[i];\r\n      if (r?.variant_id) setDeletedIds((ids) => uniq([...ids, r.variant_id]));\r\n      const a = [...prev]; a.splice(i, 1); return a;\r\n    });\r\n  };\r\n\r\n  /* ---------- Auto SKU ---------- */\r\n  const autoSku = () => {\r\n    const base = productCode || `P${productId}`;\r\n    setRows((prev) =>\r\n      prev.map((r) => {\r\n        const parts = [base, r.opt1, r.opt2, r.opt3].filter((x) => String(x || \"\").trim() !== \"\");\r\n        return { ...r, sku: parts.join(\"-\") + \"-\" + rand2() };\r\n      })\r\n    );\r\n  };\r\n\r\n  /* ---------- Save ---------- */\r\n  const saveAll = async () => {\r\n    setSaving(true);\r\n    try {\r\n      const payloadRows = rows.map((r) => ({\r\n        variant_id: r.variant_id || null,\r\n        details: [\r\n          r.opt1 ? { name: opt1Name, value: r.opt1 } : null,\r\n          r.opt2 ? { name: opt2Name, value: r.opt2 } : null,\r\n          r.opt3 && (opt3Name || r.opt3) ? { name: opt3Name || \"ตัวเลือก 3\", value: r.opt3 } : null,\r\n        ].filter(Boolean),\r\n        sku: r.sku || null,\r\n        price: r.price !== \"\" ? Number(r.price) : null,\r\n        image_url: r.image || null,\r\n        stock: (r.stock != null ? Number(r.stock) : null),\r\n      }));\r\n\r\n      if (deletedIds.length) {\r\n        try { await api.post(path(`/api/variants/delete-batch`), { variant_ids: deletedIds }, { headers: authHeader() }); } catch {}\r\n        try { await api.delete(path(`/admin/products/${productId}/variants`), { data: { variant_ids: deletedIds }, headers: authHeader() }); } catch {}\r\n      }\r\n\r\n      let done = false;\r\n      try { await api.post(path(`/api/variants/upsert-batch`), { product_id: productId, rows: payloadRows }, { headers: authHeader() }); done = true; } catch {}\r\n      if (!done) { try { await api.put(path(`/admin/products/${productId}/variants`), { rows: payloadRows }, { headers: authHeader() }); done = true; } catch {} }\r\n      if (!done) { try { await api.post(path(`/admin/products/${productId}/variants/save`), { rows: payloadRows }, { headers: authHeader() }); done = true; } catch {} }\r\n      if (!done) { try { await api.post(path(`/api/variants/${productId}/variants/generate`), { rows: payloadRows }, { headers: authHeader() }); done = true; } catch {} }\r\n      if (!done) { await api.post(path(`/admin/products/${productId}/variants/generate`), { rows: payloadRows }, { headers: authHeader() }); }\r\n\r\n      setMsg(\"✅ บันทึกแล้ว\");\r\n      setTimeout(() => setMsg(\"\"), 1800);\r\n        // try to update stocks in a single shot (best-effort)\r\n  try {\r\n    const stockItems = rows\r\n      .filter(r => r.variant_id && r.stock != null)\r\n      .map(r => ({ variant_id: r.variant_id, stock: Number(r.stock) || 0 }));\r\n    if (stockItems.length) {\r\n      await api.post(path(`/api/variants/update-stocks`), { items: stockItems }, { headers: authHeader() });\r\n    }\r\n  } catch {}\r\n  await loadAll();\r\n} catch (e) {\r\n      console.error(e);\r\n      alert(e?.response?.data?.message || \"❌ Save failed\");\r\n    } finally { setSaving(false); }\r\n  };\r\n\r\n  return (\r\n    <div className=\"vm-page\">\r\n      {/* Header */}\r\n      <div className=\"vm-header\">\r\n        <div className=\"vm-title\">\r\n          <div className=\"vm-product-name\">{pickStr(product?.product_name, product?.name, product?.title) || `#${productId}`}</div>\r\n          <div className=\"vm-product-code\">{pickStr(product?.product_code, product?.code, `P${productId}`)}</div>\r\n        </div>\r\n        <Link to=\"/admin/products\" className=\"vm-back\">← กลับไปหน้าสินค้า</Link>\r\n      </div>\r\n\r\n      {msg && <div className=\"vm-msg\">{msg}</div>}\r\n\r\n      {/* Options (ชื่อ + chips) */}\r\n      <div className=\"vm-options\" style={{display:\"grid\", gridTemplateColumns:\"1fr 1fr 1fr\", gap:\"16px\"}}>\r\n        <div className=\"vm-opt\">\r\n          <label>ชื่อตัวเลือก 1</label>\r\n          <input value={opt1Name} onChange={(e) => setOpt1Name(e.target.value)} placeholder=\"เช่น สูตร\" />\r\n          <div className=\"vm-chips\" style={{marginTop:8}}>\r\n            {opt1Values.map((v, i) => (\r\n              <span key={i} className=\"vm-chip\">{v}<button onClick={() => removeTag(opt1Values, setOpt1Values, i)}>×</button></span>\r\n            ))}\r\n            <input placeholder=\"เช่น ทั่วไป แล้ว Enter\" onKeyDown={(e) => { if (e.key === \"Enter\") { e.preventDefault(); addTag(opt1Values, setOpt1Values, e.currentTarget.value); e.currentTarget.value = \"\"; } }} />\r\n          </div>\r\n        </div>\r\n        <div className=\"vm-opt\">\r\n          <label>ชื่อตัวเลือก 2 (ถ้ามี)</label>\r\n          <input value={opt2Name} onChange={(e) => setOpt2Name(e.target.value)} placeholder=\"เช่น ขนาด\" />\r\n          <div className=\"vm-chips\" style={{marginTop:8}}>\r\n            {opt2Values.map((v, i) => (\r\n              <span key={i} className=\"vm-chip\">{v}<button onClick={() => removeTag(opt2Values, setOpt2Values, i)}>×</button></span>\r\n            ))}\r\n            <input placeholder=\"เช่น M / 6 นิ้ว แล้ว Enter\" onKeyDown={(e) => { if (e.key === \"Enter\") { e.preventDefault(); addTag(opt2Values, setOpt2Values, e.currentTarget.value); e.currentTarget.value = \"\"; } }} />\r\n          </div>\r\n        </div>\r\n        <div className=\"vm-opt\">\r\n          <label>ชื่อตัวเลือก 3 (ถ้ามี)</label>\r\n          <input value={opt3Name} onChange={(e) => setOpt3Name(e.target.value)} placeholder=\"เช่น วัสดุ\" />\r\n          <div className=\"vm-chips\" style={{marginTop:8}}>\r\n            {opt3Values.map((v, i) => (\r\n              <span key={i} className=\"vm-chip\">{v}<button onClick={() => removeTag(opt3Values, setOpt3Values, i)}>×</button></span>\r\n            ))}\r\n            <input placeholder=\"เช่น เซรามิก แล้ว Enter\" onKeyDown={(e) => { if (e.key === \"Enter\") { e.preventDefault(); addTag(opt3Values, setOpt3Values, e.currentTarget.value); e.currentTarget.value = \"\"; } }} />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Table */}\r\n      <div className=\"vm-table-wrap\">\r\n        <table className=\"vm-table\">\r\n          <thead>\r\n            <tr>\r\n              <th>รูปภาพ</th>\r\n              <th>{opt1Name || \"ตัวเลือก 1\"}</th>\r\n              <th>{opt2Name || \"ตัวเลือก 2\"}</th>\r\n              <th>{opt3Name || \"ตัวเลือก 3\"}</th>\r\n              <th>ราคา</th>\r\n              <th>คงเหลือ</th>\r\n              <th>SKU</th>\r\n              <th>ลบ</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {rows.map((r, i) => (\r\n              <tr key={i}>\r\n                <td>\r\n                  {r.image ? (\r\n                    <img src={mediaSrc(r.image)} alt=\"\" className=\"vm-thumb\" />\r\n                  ) : (\r\n                    <label className=\"vm-upload\">\r\n                      <span>+</span>\r\n                      <input type=\"file\" accept=\"image/*\" onChange={(e) => onUploadRowImage(e.target.files?.[0], i)} />\r\n                    </label>\r\n                  )}\r\n                </td>\r\n                <td>{r.opt1 || \"-\"}</td>\r\n                <td>{r.opt2 || \"-\"}</td>\r\n                <td>{r.opt3 || \"-\"}</td>\r\n                <td>\r\n                  <input type=\"number\" min=\"0\" placeholder=\"ไม่ระบุ\" value={r.price} onChange={(e) => {\r\n                    const v = e.target.value;\r\n                    setRows((prev) => { const a = [...prev]; a[i] = { ...a[i], price: v }; return a; });\r\n                  }} />\r\n                </td>\r\n<td>\r\n  <input\r\n    type=\"number\"\r\n    min=\"0\"\r\n    step=\"1\"\r\n    value={r.stock ?? 0}\r\n    onChange={(e) => {\r\n      const v = e.target.value;\r\n      setRows((prev) => { const a = [...prev]; a[i] = { ...a[i], stock: v === \"\" ? 0 : Math.max(0, Number(v)) }; return a; });\r\n    }}\r\n  />\r\n</td>\r\n                <td>\r\n                  <input placeholder=\"SKU\" value={r.sku} onChange={(e) => {\r\n                    const v = e.target.value;\r\n                    setRows((prev) => { const a = [...prev]; a[i] = { ...a[i], sku: v }; return a; });\r\n                  }} />\r\n                </td>\r\n                <td><button className=\"btn\" onClick={() => onDeleteRow(i)} title=\"ลบแถว\">🗑️</button></td>\r\n              </tr>\r\n            ))}\r\n            {rows.length === 0 && (\r\n              <tr>\r\n                <td colSpan={7} style={{ textAlign: \"center\", padding: 16 }}>\r\n                  เพิ่มค่าในกล่องด้านบน (พิมพ์แล้วกด Enter) เพื่อสร้างชุดตัวเลือก แล้วกด “บันทึกทั้งหมด”\r\n                </td>\r\n              </tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      {/* Actions */}\r\n      <div className=\"vm-actions\">\r\n        <button className=\"btn\" onClick={autoSku} disabled={saving}>✨ เติม SKU อัตโนมัติ</button>\r\n        <button className=\"btn-primary\" onClick={saveAll} disabled={saving}>{saving ? \"กำลังบันทึก…\" : \"บันทึกทั้งหมด\"}</button>\r\n      </div>\r\n\r\n      <div className=\"vm-hint\">เมื่อเพิ่มเสร็จ ให้กด “บันทึก” ด้านบน เพื่อบันทึกตัวเลือกทั้งหมดพร้อมสินค้า</div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}